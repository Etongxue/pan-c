(this["webpackJsonpcloudreve-frontend"]=this["webpackJsonpcloudreve-frontend"]||[]).push([[11],{8083:function(e,a,t){"use strict";t.r(a);var n=t(9),r=t(0),l=t.n(r),c=t(97),i=t(7150),o=t(359),m=t(10),s=t(6),u=t(8),d=t(7033),p=t(181),E=t(87),b=t(7019),h=t(7022),v=t(7021),f=t(54),g=t(244),y=t(74),O=t(66),N=t(64),S=t(29),C=t(44),j=t(7034),k=t(57),x=t(7102),_=t(7041),z=t(8038),w=t(8039),D=t(8040),F=t(8041),P=t(8042),R=t(8043),I=t(8044),L=t(8045),T=t(8046),W=t(8047),A=t(8048),q=t(8049),B=t(8050),M=t(7040),K=t(8051),U=t(7142),H=t(7598),G=t.n(H),V=t(7597),J=t.n(V),X=t(264),Q=t.n(X),$=t(4),Y=t(7),Z=t(19),ee=t(52),ae=t(18),te=t(370),ne=t(119),re=Object(u.a)({root:{maxWidth:"100%",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:0}},expanded:{}})(b.a),le=Object(u.a)({root:{minHeight:0,padding:0,"&$expanded":{minHeight:0}},content:{maxWidth:"100%",margin:0,display:"block","&$expanded":{margin:"0"}},expanded:{}})(v.a),ce=Object(u.a)((function(e){return{root:{display:"block",padding:e.spacing(0)}}}))(h.a),ie=Object(c.a)((function(e){return{root:{display:"flex",width:"100%"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:240,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(s.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),title:{flexGrow:1},toolbar:Object(m.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,padding:e.spacing(3)},sub:{paddingLeft:36,color:e.palette.text.secondary},subMenu:{backgroundColor:e.palette.background.default,paddingTop:0,paddingBottom:0},active:{backgroundColor:Object(S.i)(e.palette.primary.main,.8),color:e.palette.primary.main,"&:hover":{backgroundColor:Object(S.i)(e.palette.primary.main,.7)}},activeText:{fontWeight:500},activeIcon:{color:e.palette.primary.main}}})),oe=[{title:"nav.summary",icon:l.a.createElement(x.a,null),path:"home"},{title:"nav.settings",icon:l.a.createElement(_.a,null),sub:[{title:"nav.basicSetting",path:"basic",icon:l.a.createElement(z.a,null)},{title:"nav.publicAccess",path:"access",icon:l.a.createElement(w.a,null)},{title:"nav.email",path:"mail",icon:l.a.createElement(D.a,null)},{title:"nav.transportation",path:"upload",icon:l.a.createElement(F.a,null)},{title:"nav.appearance",path:"theme",icon:l.a.createElement(P.a,null)},{title:"nav.image",path:"image",icon:l.a.createElement(R.a,null)},{title:"nav.captcha",path:"captcha",icon:l.a.createElement(I.a,null)}]},{title:"nav.storagePolicy",icon:l.a.createElement(L.a,null),path:"policy"},{title:"nav.nodes",icon:l.a.createElement(T.a,null),path:"node"},{title:"nav.groups",icon:l.a.createElement(W.a,null),path:"group"},{title:"nav.users",icon:l.a.createElement(A.a,null),path:"user"},{title:"nav.files",icon:l.a.createElement(q.a,null),path:"file"},{title:"nav.shares",icon:l.a.createElement(B.a,null),path:"share"},{title:"nav.tasks",icon:l.a.createElement(M.a,null),sub:[{title:"nav.remoteDownload",path:"download",icon:l.a.createElement(K.a,null)},{title:"nav.generalTasks",path:"task",icon:l.a.createElement(U.a,null)}]}];function me(e){var a,t,c=e.content,i=Object(ne.a)("dashboard").t,o=ie(),m=Object(C.a)(),u=Object(r.useState)(!ae.a.isMobile()),b=Object(n.a)(u,2),h=b[0],v=b[1],S=Object(r.useState)(null),x=Object(n.a)(S,2),_=x[0],z=x[1],w=Object(Z.g)(),D=Object(Z.h)(),F=Object(Y.d)(),P=Object(r.useCallback)((function(e){return F(Object(ee.b)(e))}),[F]);Object(r.useEffect)((function(){P(i("nav.title"))}),[]),Object(r.useEffect)((function(){return function(){P()}}),[]);var R=Object(Z.j)().path;return l.a.createElement("div",{className:o.root},l.a.createElement(d.a,{position:"fixed",className:Object($.a)(o.appBar,Object(s.a)({},o.appBarShift,h))},l.a.createElement(j.a,null,l.a.createElement(f.a,{color:"inherit","aria-label":"open drawer",onClick:function(){v(!0)},edge:"start",className:Object($.a)(o.menuButton,Object(s.a)({},o.hide,h))},l.a.createElement(Q.a,null)),l.a.createElement(k.a,{variant:"h6",className:o.title,noWrap:!0},i("nav.dashboard")),l.a.createElement(te.a,null))),l.a.createElement(E.a,{variant:"permanent",className:Object($.a)(o.drawer,(a={},Object(s.a)(a,o.drawerOpen,h),Object(s.a)(a,o.drawerClose,!h),a)),classes:{paper:Object($.a)((t={},Object(s.a)(t,o.drawerOpen,h),Object(s.a)(t,o.drawerClose,!h),t))}},l.a.createElement("div",{className:o.toolbar},l.a.createElement(f.a,{onClick:function(){v(!1)}},"rtl"===m.direction?l.a.createElement(J.a,null):l.a.createElement(G.a,null))),l.a.createElement(p.a,null),l.a.createElement(g.a,{className:o.noPadding},oe.map((function(e){return void 0!==e.path?l.a.createElement(y.a,{onClick:function(){return w.push("/admin/"+e.path)},button:!0,className:Object($.a)(Object(s.a)({},o.active,D.pathname.startsWith("/admin/"+e.path))),key:e.title},l.a.createElement(O.a,{className:Object($.a)(Object(s.a)({},o.activeIcon,D.pathname.startsWith("/admin/"+e.path)))},e.icon),l.a.createElement(N.a,{className:Object($.a)(Object(s.a)({},o.activeText,D.pathname.startsWith("/admin/"+e.path))),primary:i(e.title)})):l.a.createElement(re,{key:e.title,square:!0,expanded:_===e.title,onChange:function(a,t){z(t?e.title:null)}},l.a.createElement(le,{"aria-controls":"panel1d-content",id:"panel1d-header"},l.a.createElement(y.a,{button:!0,key:e.title},l.a.createElement(O.a,null,e.icon),l.a.createElement(N.a,{primary:i(e.title)}))),l.a.createElement(ce,null,l.a.createElement(g.a,{className:o.subMenu},e.sub.map((function(e){var a;return l.a.createElement(y.a,{onClick:function(){return w.push("/admin/"+e.path)},className:Object($.a)((a={},Object(s.a)(a,o.sub,h),Object(s.a)(a,o.active,D.pathname.startsWith("/admin/"+e.path)),a)),button:!0,key:e.title},l.a.createElement(O.a,{className:Object($.a)(Object(s.a)({},o.activeIcon,D.pathname.startsWith("/admin/"+e.path)))},e.icon),l.a.createElement(N.a,{primary:i(e.title)}))})))))})))),l.a.createElement("main",{className:o.content},l.a.createElement("div",{className:o.toolbar}),c(R)))}var se=t(20),ue=t(7095),de=t(480),pe=t.n(de),Ee=t(7774),be=t(246),he=t(7030),ve=t(7158),fe=t(241),ge=t(7138),ye=t(145),Oe=t(240),Ne=t(7023),Se=t(7029),Ce=t(7025),je=t(7115),ke=t(7024),xe=t(7097),_e=t(7139),ze=t(109),we=t(8058),De=t(8059),Fe=t(8060),Pe=t(8061),Re=t(7124),Ie=t(7144),Le=t(8062),Te=t(8063),We=t(8064),Ae=t(8065),qe=t(90),Be=t.n(qe),Me=t(8052),Ke=t(8057),Ue=t(7733),He=t(7734),Ge=t(8016),Ve=t(7586),Je=t(8012),Xe=t(7599),Qe=t(101),$e=t(2),Ye=t(12),Ze=t(277),ea=Object(c.a)((function(e){return{paper:{padding:e.spacing(3),height:"100%"},logo:{width:70},logoContainer:{padding:e.spacing(3),display:"flex"},title:{marginLeft:16},cloudreve:{fontSize:25,color:e.palette.text.secondary},version:{color:e.palette.text.hint},links:{padding:e.spacing(3)},iconRight:{minWidth:0},userIcon:{backgroundColor:fe.a[100],color:fe.a[600]},fileIcon:{backgroundColor:ge.a[100],color:ge.a[800]},publicIcon:{backgroundColor:ye.a[100],color:ye.a[800]},secretIcon:{backgroundColor:Oe.a[100],color:Oe.a[800]}}}));function aa(){var e=Object(ne.a)("dashboard").t,a=ea(),t=Object(r.useState)([]),c=Object(n.a)(t,2),i=c[0],o=c[1],m=Object(r.useState)([]),s=Object(n.a)(m,2),u=s[0],d=s[1],E=Object(r.useState)({}),b=Object(n.a)(E,2),h=b[0],v=b[1],f=l.a.useState(!1),S=Object(n.a)(f,2),C=S[0],j=S[1],_=l.a.useState(""),z=Object(n.a)(_,2),w=z[0],D=z[1],F=Object(r.useState)({fileTotal:0,userTotal:0,publicShareTotal:0,secretShareTotal:0}),P=Object(n.a)(F,2),R=P[0],I=P[1],L=Object(r.useState)({backend:"-"}),T=Object(n.a)(L,2),W=T[0],A=T[1],q=Object(Y.d)(),B=Object(r.useCallback)((function(e,a,t,n){return q(Object($e.S)(e,a,t,n))}),[q]);return Object(r.useEffect)((function(){Ye.c.get("/admin/summary").then((function(e){var a=[];e.data.date.forEach((function(t,n){a.push({name:t,file:e.data.files[n],user:e.data.users[n],share:e.data.shares[n]})})),o(a),I({fileTotal:e.data.fileTotal,userTotal:e.data.userTotal,publicShareTotal:e.data.publicShareTotal,secretShareTotal:e.data.secretShareTotal}),A(e.data.version),D(e.data.siteURL),""!==e.data.siteURL&&e.data.siteURL===window.location.origin||j(!0)})).catch((function(e){B("top","right",e.message,"error")})),Be.a.get("/api/v3/admin/news?tag="+e("summary.newsTag")).then((function(e){d(e.data.data);var a={};e.data.included.forEach((function(e){"users"===e.type&&(a[e.id]=e.attributes)})),v(a)})).catch((function(a){B("top","right",e("summary.newsletterError"),"warning")}))}),[]),l.a.createElement(xe.a,{container:!0,spacing:3},l.a.createElement(Ne.a,{open:C,onClose:function(){return j(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},l.a.createElement(ke.a,{id:"alert-dialog-title"},e("summary.confirmSiteURLTitle")),l.a.createElement(Ce.a,null,l.a.createElement(je.a,{id:"alert-dialog-description"},l.a.createElement(k.a,null,""===w&&e("summary.siteURLNotSet",{current:window.location.origin}),""!==w&&e("summary.siteURLNotMatch",{current:window.location.origin})),l.a.createElement(k.a,null,e("summary.siteURLDescription")))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:function(){return j(!1)},color:"default"},e("summary.ignore")),l.a.createElement(he.a,{onClick:function(){return j(!1),void Ye.c.patch("/admin/setting",{options:[{key:"siteURL",value:window.location.origin}]}).then((function(){D(window.location.origin),B("top","right",e("settings.saved"),"success")})).catch((function(e){B("top","right",e.message,"error")}))},color:"primary"},e("summary.changeIt")))),l.a.createElement(xe.a,{alignContent:"stretch",item:!0,xs:12,md:8,lg:9},l.a.createElement(ze.a,{className:a.paper},l.a.createElement(k.a,{variant:"button",display:"block",gutterBottom:!0},e("summary.trend")),l.a.createElement(Xe.ResponsiveContainer,{width:"100%",aspect:ae.a.isMobile()?4/3:3},l.a.createElement(Me.a,{width:1200,height:300,data:i},l.a.createElement(Ke.a,{strokeDasharray:"3 3"}),l.a.createElement(Ue.a,{dataKey:"name"}),l.a.createElement(He.a,null),l.a.createElement(Ge.a,null),l.a.createElement(Ve.a,null),l.a.createElement(Je.a,{name:e("nav.files"),type:"monotone",dataKey:"file",stroke:"#3f51b5"}),l.a.createElement(Je.a,{name:e("nav.users"),type:"monotone",dataKey:"user",stroke:"#82ca9d"}),l.a.createElement(Je.a,{name:e("nav.shares"),type:"monotone",dataKey:"share",stroke:"#e91e63"}))))),l.a.createElement(xe.a,{item:!0,xs:12,md:4,lg:3},l.a.createElement(ze.a,{className:a.paper},l.a.createElement(k.a,{variant:"button",display:"block",gutterBottom:!0},e("summary.summary")),l.a.createElement(p.a,null),l.a.createElement(g.a,{className:a.root},l.a.createElement(y.a,null,l.a.createElement(_e.a,null,l.a.createElement(be.a,{className:a.userIcon},l.a.createElement(we.a,null))),l.a.createElement(N.a,{primary:R.userTotal,secondary:e("summary.totalUsers")})),l.a.createElement(y.a,null,l.a.createElement(_e.a,null,l.a.createElement(be.a,{className:a.fileIcon},l.a.createElement(De.a,null))),l.a.createElement(N.a,{primary:R.fileTotal,secondary:e("summary.totalFiles")})),l.a.createElement(y.a,null,l.a.createElement(_e.a,null,l.a.createElement(be.a,{className:a.publicIcon},l.a.createElement(Fe.a,null))),l.a.createElement(N.a,{primary:R.publicShareTotal,secondary:e("summary.publicShares")})),l.a.createElement(y.a,null,l.a.createElement(_e.a,null,l.a.createElement(be.a,{className:a.secretIcon},l.a.createElement(Pe.a,null))),l.a.createElement(N.a,{primary:R.secretShareTotal,secondary:e("summary.privateShares")}))))),l.a.createElement(xe.a,{item:!0,xs:12,md:4,lg:3},l.a.createElement(ze.a,null,l.a.createElement("div",{className:a.logoContainer},l.a.createElement("img",{alt:"Tsuki",className:a.logo,src:"/static/img/cloudreve.svg"}),l.a.createElement("div",{className:a.title},l.a.createElement(k.a,{className:a.cloudreve},"Tsuki"),l.a.createElement(k.a,{className:a.version},W.backend," ","true"===W.is_pro&&l.a.createElement(ve.a,{size:"small",label:"Pro"})))),l.a.createElement(p.a,null),l.a.createElement("div",null,l.a.createElement(g.a,{component:"nav","aria-label":"main mailbox folders"},l.a.createElement(y.a,{button:!0,onClick:function(){return window.open("https://tsuki.icu")}},l.a.createElement(O.a,null,l.a.createElement(x.a,null)),l.a.createElement(N.a,{primary:e("summary.homepage")}),l.a.createElement(O.a,{className:a.iconRight},l.a.createElement(Re.a,null))),l.a.createElement(y.a,{button:!0,onClick:function(){return window.open("https://tsuki.icu")}},l.a.createElement(O.a,null,l.a.createElement(Ie.a,null)),l.a.createElement(N.a,{primary:"GitHub"}),l.a.createElement(O.a,{className:a.iconRight},l.a.createElement(Re.a,null))),l.a.createElement(y.a,{button:!0,onClick:function(){return window.open("https://tsuki.icu")}},l.a.createElement(O.a,null,l.a.createElement(Le.a,null)),l.a.createElement(N.a,{primary:e("summary.documents")}),l.a.createElement(O.a,{className:a.iconRight},l.a.createElement(Re.a,null))),l.a.createElement(y.a,{button:!0,onClick:function(){return window.open(e("summary.forumLink"))}},l.a.createElement(O.a,null,l.a.createElement(Te.a,null)),l.a.createElement(N.a,{primary:e("summary.forum")}),l.a.createElement(O.a,{className:a.iconRight},l.a.createElement(Re.a,null))),l.a.createElement(y.a,{button:!0,onClick:function(){return window.open(e("summary.telegramGroupLink"))}},l.a.createElement(O.a,null,l.a.createElement(We.a,null)),l.a.createElement(N.a,{primary:e("summary.telegramGroup")}),l.a.createElement(O.a,{className:a.iconRight},l.a.createElement(Re.a,null))),l.a.createElement(y.a,{button:!0,onClick:function(){return window.open("https://tsuki.icu")}},l.a.createElement(O.a,{style:{color:"#ff789d"}},l.a.createElement(Ae.a,null)),l.a.createElement(N.a,{primary:e("summary.buyPro")}),l.a.createElement(O.a,{className:a.iconRight},l.a.createElement(Re.a,null))))))),l.a.createElement(xe.a,{item:!0,xs:12,md:8,lg:9},l.a.createElement(ze.a,{className:a.paper},l.a.createElement(g.a,null,u&&u.map((function(t){return l.a.createElement(l.a.Fragment,null,l.a.createElement(y.a,{button:!0,alignItems:"flex-start",onClick:function(){return window.open("https://tsuki.icu"+t.id)}},l.a.createElement(_e.a,null,l.a.createElement(be.a,{alt:"Travis Howard",src:h[t.relationships.startUser.data.id]&&h[t.relationships.startUser.data.id].avatarUrl})),l.a.createElement(N.a,{primary:t.attributes.title,secondary:l.a.createElement(l.a.Fragment,null,l.a.createElement(k.a,{component:"span",variant:"body2",className:a.inline,color:"textPrimary"},h[t.relationships.startUser.data.id]&&h[t.relationships.startUser.data.id].username," "),l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"summary.publishedAt",components:[l.a.createElement(Qe.a,{key:0,datetime:t.attributes.startTime,locale:e("timeAgoLocaleCode",{ns:"common"})})]}))})),l.a.createElement(p.a,null))}))))))}var ta=t(274),na=t(7045),ra=t(7028),la=t(7026),ca=t(120),ia=t(465),oa=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function ma(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=oa(),t=Object(r.useState)(!1),c=Object(n.a)(t,2),i=c[0],o=c[1],u=Object(r.useState)({siteURL:"",siteName:"",siteTitle:"",siteDes:"",siteScript:"",pwa_small_icon:"",pwa_medium_icon:"",pwa_large_icon:"",pwa_display:"",pwa_theme_color:"",pwa_background_color:""}),d=Object(n.a)(u,2),p=d[0],E=d[1],b=function(e){return function(a){E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},e,a.target.value)))}},h=Object(Y.d)(),v=Object(r.useCallback)((function(e,a,t,n){return h(Object($e.S)(e,a,t,n))}),[h]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:Object.keys(p)}).then((function(e){E(e.data)})).catch((function(e){v("top","right",e.message,"error")}))}),[]);return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),o(!0);var t=[];Object.keys(p).forEach((function(e){t.push({key:e,value:p[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){v("top","right",e("saved"),"success")})).catch((function(e){v("top","right",e.message,"error")})).then((function(){o(!1)}))}},l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("basicInformation")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("mainTitle")),l.a.createElement(ra.a,{value:p.siteName,onChange:b("siteName"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("mainTitleDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("subTitle")),l.a.createElement(ra.a,{value:p.siteTitle,onChange:b("siteTitle")}),l.a.createElement(na.a,{id:"component-helper-text"},e("subTitleDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("siteDescription")),l.a.createElement(ra.a,{value:p.siteDes,onChange:b("siteDes")}),l.a.createElement(na.a,{id:"component-helper-text"},e("siteDescriptionDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("siteURL")),l.a.createElement(ra.a,{type:"url",value:p.siteURL,onChange:b("siteURL"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("siteURLDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("customFooterHTML")),l.a.createElement(ra.a,{multiline:!0,value:p.siteScript,onChange:b("siteScript")}),l.a.createElement(na.a,{id:"component-helper-text"},e("customFooterHTMLDes")))))),l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("pwa")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("smallIcon")),l.a.createElement(ra.a,{value:p.pwa_small_icon,onChange:b("pwa_small_icon")}),l.a.createElement(na.a,{id:"component-helper-text"},e("smallIconDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("mediumIcon")),l.a.createElement(ra.a,{value:p.pwa_medium_icon,onChange:b("pwa_medium_icon")}),l.a.createElement(na.a,{id:"component-helper-text"},e("mediumIconDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("largeIcon")),l.a.createElement(ra.a,{value:p.pwa_large_icon,onChange:b("pwa_large_icon")}),l.a.createElement(na.a,{id:"component-helper-text"},e("largeIconDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("displayMode")),l.a.createElement(ia.a,{value:p.pwa_display,onChange:b("pwa_display")},l.a.createElement(ca.a,{value:"fullscreen"},"fullscreen"),l.a.createElement(ca.a,{value:"standalone"},"standalone"),l.a.createElement(ca.a,{value:"minimal-ui"},"minimal-ui"),l.a.createElement(ca.a,{value:"browser"},"browser")),l.a.createElement(na.a,{id:"component-helper-text"},e("displayModeDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("themeColor")),l.a.createElement(ra.a,{value:p.pwa_theme_color,onChange:b("pwa_theme_color")}),l.a.createElement(na.a,{id:"component-helper-text"},e("themeColorDes"))))),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("backgroundColor")),l.a.createElement(ra.a,{value:p.pwa_background_color,onChange:b("pwa_background_color")}),l.a.createElement(na.a,{id:"component-helper-text"},e("backgroundColorDes")))))),l.a.createElement("div",{className:a.root},l.a.createElement(he.a,{disabled:i,type:"submit",variant:"contained",color:"primary"},e("save")))))}var sa=t(41),ua=t(7046),da=t(7047);function pa(e){var a=e.title,t=e.msg,n=e.open,r=e.onClose;return l.a.createElement(Ne.a,{open:n,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},l.a.createElement(ke.a,{id:"alert-dialog-title"},a),l.a.createElement(Ce.a,null,l.a.createElement(je.a,{id:"alert-dialog-description"},l.a.createElement(k.a,null,t))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:r,color:"primary"},"\u77e5\u9053\u4e86")))}var Ea=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function ba(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=(Object(ne.a)("dashboard",{keyPrefix:"vas"}).t,Ea()),t=Object(r.useState)(!1),c=Object(n.a)(t,2),i=c[0],o=c[1],u=Object(r.useState)({register_enabled:"1",default_group:"1",email_active:"0",login_captcha:"0",reg_captcha:"0",forget_captcha:"0",authn_enabled:"0"}),d=Object(n.a)(u,2),p=d[0],E=d[1],b=Object(r.useState)(""),h=Object(n.a)(b,2),v=h[0],f=h[1],g=Object(r.useState)([]),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)(!1),C=Object(n.a)(S,2),j=C[0],x=C[1],_=function(e){return function(a){var t=a.target.value;void 0!==a.target.checked&&(t=a.target.checked?"1":"0"),E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},e,t)))}},z=Object(Y.d)(),w=Object(r.useCallback)((function(e,a,t,n){return z(Object($e.S)(e,a,t,n))}),[z]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:[].concat(Object(sa.a)(Object.keys(p)),["siteURL"])}).then((function(e){f(e.data.siteURL),delete e.data.siteURL,E(e.data)})).catch((function(e){w("top","right",e.message,"error")})),Ye.c.get("/admin/groups").then((function(e){N(e.data)})).catch((function(e){w("top","right",e.message,"error")}))}),[]);var D;return l.a.createElement("div",null,l.a.createElement(pa,{title:e("hint"),msg:e("webauthnNoHttps"),onClose:function(){return x(!1)},open:j}),l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),o(!0);var t=[];Object.keys(p).forEach((function(e){t.push({key:e,value:p[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){w("top","right",e("saved"),"success")})).catch((function(e){w("top","right",e.message,"error")})).then((function(){o(!1)}))}},l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("accountManagement")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.register_enabled,onChange:_("register_enabled")}),label:e("allowNewRegistrations")}),l.a.createElement(na.a,{id:"component-helper-text"},e("allowNewRegistrationsDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.email_active,onChange:_("email_active")}),label:e("emailActivation")}),l.a.createElement(na.a,{id:"component-helper-text"},e("emailActivationDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.reg_captcha,onChange:_("reg_captcha")}),label:e("captchaForSignup")}),l.a.createElement(na.a,{id:"component-helper-text"},e("captchaForSignupDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.login_captcha,onChange:_("login_captcha")}),label:e("captchaForLogin")}),l.a.createElement(na.a,{id:"component-helper-text"},e("captchaForLoginDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.forget_captcha,onChange:_("forget_captcha")}),label:e("captchaForReset")}),l.a.createElement(na.a,{id:"component-helper-text"},e("captchaForResetDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.authn_enabled,onChange:function(e){v.startsWith("https://")?_("authn_enabled")(e):x(!0)}}),label:e("webauthn")}),l.a.createElement(na.a,{id:"component-helper-text"},e("webauthnDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("defaultGroup")),l.a.createElement(ia.a,{value:p.default_group,onChange:(D="default_group",function(e){var a=e.target.value;E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},D,a)))}),required:!0},O.map((function(e){return 3===e.ID?null:l.a.createElement(ca.a,{key:e.ID,value:e.ID.toString()},e.Name)}))),l.a.createElement(na.a,{id:"component-helper-text"},e("defaultGroupDes")))))),l.a.createElement("div",{className:a.root},l.a.createElement(he.a,{disabled:i,type:"submit",variant:"contained",color:"primary"},e("save")))))}var ha=t(7117),va=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),buttonMargin:{marginLeft:8}}}));function fa(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=(Object(ne.a)("dashboard",{keyPrefix:"vas"}).t,Object(ne.a)("common").t),t=va(),c=Object(r.useState)(!1),i=Object(n.a)(c,2),o=i[0],u=i[1],d=Object(r.useState)(!1),p=Object(n.a)(d,2),E=p[0],b=p[1],h=Object(r.useState)(""),v=Object(n.a)(h,2),f=v[0],g=v[1],y=Object(r.useState)({fromName:"",fromAdress:"",smtpHost:"",smtpPort:"",replyTo:"",smtpUser:"",smtpPass:"",smtpEncryption:"",mail_keepalive:"30",mail_activation_template:"",mail_reset_pwd_template:""}),O=Object(n.a)(y,2),N=O[0],S=O[1],C=function(e){return function(a){S(Object(m.a)(Object(m.a)({},N),{},Object(s.a)({},e,a.target.value)))}},j=Object(Y.d)(),x=Object(r.useCallback)((function(e,a,t,n){return j(Object($e.S)(e,a,t,n))}),[j]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:Object.keys(N)}).then((function(e){S(e.data)})).catch((function(e){x("top","right",e.message,"error")}))}),[]);var _;return l.a.createElement("div",null,l.a.createElement(Ne.a,{open:E,onClose:function(){return b(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(ke.a,{id:"form-dialog-title"},e("testSMTPSettings")),l.a.createElement(Ce.a,null,l.a.createElement(je.a,null,l.a.createElement(k.a,null,e("testSMTPTooltip"))),l.a.createElement(ha.a,{autoFocus:!0,margin:"dense",id:"name",label:e("recipient"),value:f,onChange:function(e){return g(e.target.value)},type:"email",fullWidth:!0})),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:function(){return b(!1)},color:"default"},a("cancel")),l.a.createElement(he.a,{onClick:function(){return u(!0),void Ye.c.post("/admin/mailTest",{to:f}).then((function(){x("top","right",e("testMailSent"),"success")})).catch((function(e){x("top","right",e.message,"error")})).then((function(){u(!1)}))},disabled:o,color:"primary"},e("send")))),l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),u(!0);var t=[];Object.keys(N).forEach((function(e){t.push({key:e,value:N[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){x("top","right",e("saved"),"success"),Ye.c.get("/admin/reload/email").then((function(){})).catch((function(e){x("top","right",e.message,"error")})).then((function(){}))})).catch((function(e){x("top","right",e.message,"error")})).then((function(){u(!1)}))}},l.a.createElement("div",{className:t.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("smtp")),l.a.createElement("div",{className:t.formContainer},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("senderName")),l.a.createElement(ra.a,{value:N.fromName,onChange:C("fromName"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("senderNameDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("senderAddress")),l.a.createElement(ra.a,{type:"email",required:!0,value:N.fromAdress,onChange:C("fromAdress")}),l.a.createElement(na.a,{id:"component-helper-text"},e("senderAddressDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("smtpServer")),l.a.createElement(ra.a,{value:N.smtpHost,onChange:C("smtpHost"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("smtpServerDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("smtpPort")),l.a.createElement(ra.a,{inputProps:{min:1,step:1},type:"number",value:N.smtpPort,onChange:C("smtpPort"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("smtpPortDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("smtpUsername")),l.a.createElement(ra.a,{value:N.smtpUser,onChange:C("smtpUser"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("smtpUsernameDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("smtpPassword")),l.a.createElement(ra.a,{type:"password",value:N.smtpPass,onChange:C("smtpPass"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("smtpPasswordDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("replyToAddress")),l.a.createElement(ra.a,{value:N.replyTo,onChange:C("replyTo"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("replyToAddressDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===N.smtpEncryption,onChange:(_="smtpEncryption",function(e){var a=e.target.value;void 0!==e.target.checked&&(a=e.target.checked?"1":"0"),S(Object(m.a)(Object(m.a)({},N),{},Object(s.a)({},_,a)))})}),label:e("enforceSSL")}),l.a.createElement(na.a,{id:"component-helper-text"},e("enforceSSLDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("smtpTTL")),l.a.createElement(ra.a,{inputProps:{min:1,step:1},type:"number",value:N.mail_keepalive,onChange:C("mail_keepalive"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("smtpTTLDes")))))),l.a.createElement("div",{className:t.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("emailTemplates")),l.a.createElement("div",{className:t.formContainer},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("activateNewUser")),l.a.createElement(ra.a,{value:N.mail_activation_template,onChange:C("mail_activation_template"),multiline:!0,rowsMax:"10",required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("activateNewUserDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("resetPassword")),l.a.createElement(ra.a,{value:N.mail_reset_pwd_template,onChange:C("mail_reset_pwd_template"),multiline:!0,rowsMax:"10",required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("resetPasswordDes")))))),l.a.createElement("div",{className:t.root},l.a.createElement(he.a,{disabled:o,type:"submit",variant:"contained",color:"primary"},e("save")),"   ",l.a.createElement(he.a,{className:t.buttonMargin,variant:"outlined",color:"primary",onClick:function(){return b(!0)}},e("sendTestEmail")))))}var ga=t(7118);function ya(e){var a=e.onChange,t=e.min,c=e.value,i=e.required,o=e.label,m=e.max,s=e.suffix,u=Object(Y.d)(),d=(Object(r.useCallback)((function(e,a,t,n){return u(Object($e.S)(e,a,t,n))}),[u]),Object(r.useState)(1)),p=Object(n.a)(d,2),E=p[0],b=p[1],h=Object(r.useState)(c),v=Object(n.a)(h,2),f=v[0],g=v[1],y=Object(r.useState)(""),O=Object(n.a)(y,2),N=O[0],S=O[1];return Object(r.useEffect)((function(){a({target:{value:(f*E).toString()}}),S(f*E>m||f*E<t?"\u4e0d\u7b26\u5408\u5c3a\u5bf8\u9650\u5236":"")}),[f,E,m,t]),Object(r.useEffect)((function(){var e=function(e){if(!e||"0"===e.toString())return[0,1048576];for(var a=4;a>=0;a--){var t=Math.pow(1024,a);if(e%t===0)return[e/t,t]}}(c);b(e[1]),g(e[0])}),[]),l.a.createElement(ta.a,{error:""!==N},l.a.createElement(la.a,{htmlFor:"component-helper"},o),l.a.createElement(ra.a,{style:{width:200},value:f,type:"number",inputProps:{step:1},onChange:function(e){return g(e.target.value)},required:i,endAdornment:l.a.createElement(ga.a,{position:"end"},l.a.createElement(ia.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:E,onChange:function(e){return b(e.target.value)}},l.a.createElement(ca.a,{value:1},"B",s&&s),l.a.createElement(ca.a,{value:1024},"KB",s&&s),l.a.createElement(ca.a,{value:1048576},"MB",s&&s),l.a.createElement(ca.a,{value:1073741824},"GB",s&&s),l.a.createElement(ca.a,{value:1099511627776},"TB",s&&s)))}),""!==N&&l.a.createElement(na.a,null,N))}var Oa=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function Na(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=Oa(),t=Object(r.useState)(!1),c=Object(n.a)(t,2),i=c[0],o=c[1],u=Object(r.useState)({max_worker_num:"1",max_parallel_transfer:"1",temp_path:"",maxEditSize:"",chunk_retries:"0",archive_timeout:"0",download_timeout:"0",preview_timeout:"0",doc_preview_timeout:"0",upload_credential_timeout:"0",upload_session_timeout:"0",slave_api_timeout:"0",onedrive_monitor_timeout:"0",share_download_session_timeout:"0",onedrive_callback_check:"0",reset_after_upload_failed:"0",onedrive_source_timeout:"0",slave_node_retry:"0",slave_ping_interval:"0",slave_recover_interval:"0",slave_transfer_timeout:"0",use_temp_chunk_buffer:"1"}),d=Object(n.a)(u,2),p=d[0],E=d[1],b=function(e){return function(a){var t=a.target.checked?"1":"0";E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},e,t)))}},h=function(e){return function(a){E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},e,a.target.value)))}},v=Object(Y.d)(),f=Object(r.useCallback)((function(e,a,t,n){return v(Object($e.S)(e,a,t,n))}),[v]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:Object.keys(p)}).then((function(e){E(e.data)})).catch((function(e){f("top","right",e.message,"error")}))}),[]);return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),o(!0);var t=[];Object.keys(p).forEach((function(e){t.push({key:e,value:p[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){f("top","right",e("saved"),"success")})).catch((function(e){f("top","right",e.message,"error")})).then((function(){o(!1)}))}},l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("transportation")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("workerNum")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.max_worker_num,onChange:h("max_worker_num"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("workerNumDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("transitParallelNum")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.max_parallel_transfer,onChange:h("max_parallel_transfer"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("transitParallelNumDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("tempFolder")),l.a.createElement(ra.a,{value:p.temp_path,onChange:h("temp_path"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("tempFolderDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,""!==p.maxEditSize&&l.a.createElement(ya,{value:p.maxEditSize,onChange:h("maxEditSize"),required:!0,min:0,max:2147483647,label:e("textEditMaxSize")}),l.a.createElement(na.a,{id:"component-helper-text"},e("textEditMaxSizeDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("failedChunkRetry")),l.a.createElement(ra.a,{type:"number",inputProps:{min:0,step:1},value:p.chunk_retries,onChange:h("chunk_retries"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("failedChunkRetryDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.use_temp_chunk_buffer,onChange:b("use_temp_chunk_buffer")}),label:e("cacheChunks")}),l.a.createElement(na.a,{id:"component-helper-text"},e("cacheChunksDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.reset_after_upload_failed,onChange:b("reset_after_upload_failed")}),label:e("resetConnection")}),l.a.createElement(na.a,{id:"component-helper-text"},e("resetConnectionDes")))))),l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("expirationDuration")),l.a.createElement("div",{className:a.formContainer},[{name:"batchDownload",field:"archive_timeout"},{name:"downloadSession",field:"download_timeout"},{name:"previewURL",field:"preview_timeout"},{name:"docPreviewURL",field:"doc_preview_timeout"},{name:"uploadSession",field:"upload_session_timeout",des:"uploadSessionDes"},{name:"downloadSessionForShared",field:"share_download_session_timeout",des:"downloadSessionForSharedDes"},{name:"onedriveMonitorInterval",field:"onedrive_monitor_timeout",des:"onedriveMonitorIntervalDes"},{name:"onedriveCallbackTolerance",field:"onedrive_callback_check",des:"onedriveCallbackToleranceDes"},{name:"onedriveDownloadURLCache",field:"onedrive_source_timeout",des:"onedriveDownloadURLCacheDes"}].map((function(t){return l.a.createElement("div",{key:t.name,className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e(t.name)),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p[t.field],onChange:h(t.field),required:!0}),t.des&&l.a.createElement(na.a,{id:"component-helper-text"},e(t.des))))})))),l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("nodesCommunication")),l.a.createElement("div",{className:a.formContainer},[{name:"slaveAPIExpiration",field:"slave_api_timeout",des:"slaveAPIExpirationDes"},{name:"heartbeatInterval",field:"slave_ping_interval",des:"heartbeatIntervalDes"},{name:"heartbeatFailThreshold",field:"slave_node_retry",des:"heartbeatFailThresholdDes"},{name:"heartbeatRecoverModeInterval",field:"slave_recover_interval",des:"heartbeatRecoverModeIntervalDes"},{name:"slaveTransitExpiration",field:"slave_transfer_timeout",des:"slaveTransitExpirationDes"}].map((function(t){return l.a.createElement("div",{key:t.name,className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e(t.name)),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p[t.field],onChange:h(t.field),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e(t.des))))})))),l.a.createElement("div",{className:a.root},l.a.createElement(he.a,{disabled:i,type:"submit",variant:"contained",color:"primary"},e("save")))))}var Sa=t(7096),Ca=t(7112),ja=t(7114),ka=t(7111),xa=t(7113),_a=t(7110),za=t(7137),wa=t(7152),Da=t(273),Fa=t(153),Pa=t(8066),Ra=t(7132),Ia=t(7999),La=Object(c.a)((function(e){return{picker:{"& div":{boxShadow:"none !important"},marginTop:e.spacing(1)},"@global":{".compact-picker:parent ":{boxShadow:"none !important"}},statusBar:{height:24,width:"100%"},fab:{textAlign:"right"}}}));function Ta(e){var a=e.open,t=e.onClose,c=e.onSubmit,i=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,o=Object(ne.a)("common").t,s=La(),u=Object(r.useState)({palette:{primary:{main:"#3f51b5",contrastText:"#fff"},secondary:{main:"#d81b60",contrastText:"#fff"}}}),p=Object(n.a)(u,2),E=p[0],b=p[1],h=Object(r.useCallback)((function(){try{return Object(Fa.a)(E)}catch(e){return Object(Fa.a)({})}}),[E]);return l.a.createElement(Ne.a,{open:a,onClose:t,fullWidth:!0,maxWidth:"md"},l.a.createElement(Ce.a,null,l.a.createElement(xe.a,{container:!0},l.a.createElement(xe.a,{spacing:2,md:8,xs:12,container:!0},l.a.createElement(xe.a,{md:6,xs:12,item:!0},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},i("primaryColor")),l.a.createElement(ha.a,{value:E.palette.primary.main,onChange:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{primary:Object(m.a)(Object(m.a)({},E.palette.primary),{},{main:e.target.value})})}))},fullWidth:!0}),l.a.createElement("div",{className:s.picker},l.a.createElement(Ia.a,{colors:["#4D4D4D","#999999","#FFFFFF","#f44336","#ff9800","#ffeb3b","#cddc39","#A4DD00","#00bcd4","#03a9f4","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#ff5722","#ffc107","#FCC400","#8bc34a","#4caf50","#009688","#2196f3","#3f51b5","#e91e63","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#673ab7","#9c27b0"],color:E.palette.primary.main,onChangeComplete:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{primary:Object(m.a)(Object(m.a)({},E.palette.primary),{},{main:e.hex})})}))}}))),l.a.createElement(xe.a,{md:6,xs:12,item:!0},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},i("secondaryColor")),l.a.createElement(ha.a,{value:E.palette.secondary.main,onChange:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{secondary:Object(m.a)(Object(m.a)({},E.palette.secondary),{},{main:e.target.value})})}))},fullWidth:!0}),l.a.createElement("div",{className:s.picker},l.a.createElement(Ia.a,{colors:["#4D4D4D","#999999","#FFFFFF","#ff1744","#ff3d00","#ffeb3b","#cddc39","#A4DD00","#00bcd4","#00e5ff","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#ff5722","#ffea00","#ffc400","#c6ff00","#00e676","#76ff03","#00b0ff","#2979ff","#f50057","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#1de9b6","#0C797D","#3d5afe","#651fff","#d500f9"],color:E.palette.secondary.main,onChangeComplete:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{secondary:Object(m.a)(Object(m.a)({},E.palette.secondary),{},{main:e.hex})})}))}}))),l.a.createElement(xe.a,{md:6,xs:12,item:!0},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},i("primaryColorText")),l.a.createElement(ha.a,{value:E.palette.primary.contrastText,onChange:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{primary:Object(m.a)(Object(m.a)({},E.palette.primary),{},{contrastText:e.target.value})})}))},fullWidth:!0}),l.a.createElement("div",{className:s.picker},l.a.createElement(Ia.a,{color:E.palette.primary.contrastText,onChangeComplete:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{primary:Object(m.a)(Object(m.a)({},E.palette.primary),{},{contrastText:e.hex})})}))}}))),l.a.createElement(xe.a,{md:6,xs:12,item:!0},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},i("secondaryColorText")),l.a.createElement(ha.a,{value:E.palette.secondary.contrastText,onChange:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{secondary:Object(m.a)(Object(m.a)({},E.palette.secondary),{},{contrastText:e.target.value})})}))},fullWidth:!0}),l.a.createElement("div",{className:s.picker},l.a.createElement(Ia.a,{color:E.palette.secondary.contrastText,onChangeComplete:function(e){b(Object(m.a)(Object(m.a)({},E),{},{palette:Object(m.a)(Object(m.a)({},E.palette),{},{secondary:Object(m.a)(Object(m.a)({},E.palette.secondary),{},{contrastText:e.hex})})}))}})))),l.a.createElement(xe.a,{spacing:2,md:4,xs:12},l.a.createElement(ue.a,{theme:h()},l.a.createElement("div",{className:s.statusBar,style:{backgroundColor:h().palette.primary.dark}}),l.a.createElement(d.a,{position:"static"},l.a.createElement(j.a,null,l.a.createElement(f.a,{edge:"start",className:s.menuButton,color:"inherit","aria-label":"menu"},l.a.createElement(Pa.a,null)),l.a.createElement(k.a,{variant:"h6",className:s.title},"Color"))),l.a.createElement("div",{style:{padding:16}},l.a.createElement(ha.a,{fullWidth:!0,color:"secondary",label:"Text input"}),l.a.createElement("div",{className:s.fab,style:{paddingTop:64}},l.a.createElement(Da.a,{color:"secondary","aria-label":"add"},l.a.createElement(Ra.a,null)))))))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:t,color:"default"},o("cancel")),l.a.createElement(he.a,{onClick:function(){return c(E)},color:"primary"},o("ok"))))}var Wa=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:500,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),colorContainer:{display:"flex"},colorDot:{width:20,height:20,borderRadius:"50%",marginLeft:6}}}));function Aa(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=Object(ne.a)().t,t=Wa(),c=Object(r.useState)(!1),i=Object(n.a)(c,2),o=i[0],u=i[1],d=Object(r.useState)({}),p=Object(n.a)(d,2),E=p[0],b=p[1],h=Object(r.useState)({themes:"{}",defaultTheme:"",home_view_method:"icon",share_view_method:"list"}),v=Object(n.a)(h,2),g=v[0],y=v[1],O=Object(r.useState)({}),N=Object(n.a)(O,2),S=N[0],C=N[1],j=Object(r.useState)({}),x=Object(n.a)(j,2),_=x[0],z=x[1],w=Object(r.useState)(!1),D=Object(n.a)(w,2),F=D[0],P=D[1],R=Object(Y.d)(),I=Object(r.useCallback)((function(e,a,t,n){return R(Object($e.S)(e,a,t,n))}),[R]);Object(r.useEffect)((function(){var e=JSON.parse(g.themes),a={};Object.keys(e).forEach((function(t){a[t]=JSON.stringify(e[t])})),b(e),C(a)}),[g.themes]);var L=function(e){return function(a){y(Object(m.a)(Object(m.a)({},g),{},Object(s.a)({},e,a.target.value)))}};Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:Object.keys(g)}).then((function(e){y(e.data)})).catch((function(e){I("top","right",e.message,"error")}))}),[]);return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),u(!0);var t=[];Object.keys(g).forEach((function(e){t.push({key:e,value:g[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){I("top","right",e("saved"),"success")})).catch((function(e){I("top","right",e.message,"error")})).then((function(){u(!1)}))}},l.a.createElement("div",{className:t.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("themes")),l.a.createElement("div",{className:t.formContainer},l.a.createElement("div",{className:t.form},l.a.createElement(Ca.a,{"aria-label":"simple table"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,null,l.a.createElement(ka.a,null,e("colors")),l.a.createElement(ka.a,null,e("themeConfig")),l.a.createElement(ka.a,null,e("actions")))),l.a.createElement(ja.a,null,Object.keys(E).map((function(a){return l.a.createElement(_a.a,{key:a},l.a.createElement(ka.a,{component:"th",scope:"row"},l.a.createElement("div",{className:t.colorContainer},l.a.createElement("div",{style:{backgroundColor:E[a].palette.primary.main},className:t.colorDot}),l.a.createElement("div",{style:{backgroundColor:E[a].palette.secondary.main},className:t.colorDot}))),l.a.createElement(ka.a,null,l.a.createElement(ha.a,{error:_[a],helperText:_[a]&&e("wrongFormat"),fullWidth:!0,multiline:!0,onChange:function(e){C(Object(m.a)(Object(m.a)({},S),{},Object(s.a)({},a,e.target.value)))},onBlur:function(e){try{var t=JSON.parse(e.target.value);if(!("palette"in t)||!("primary"in t.palette)||!("main"in t.palette.primary)||!("secondary"in t.palette)||!("main"in t.palette.secondary))throw e;b(Object(m.a)(Object(m.a)({},E),{},Object(s.a)({},a,t)))}catch(e){return void z(Object(m.a)(Object(m.a)({},_),{},Object(s.a)({},a,!0)))}z(Object(m.a)(Object(m.a)({},_),{},Object(s.a)({},a,!1)))},value:S[a]})),l.a.createElement(ka.a,null,l.a.createElement(f.a,{onClick:function(){return function(a){if(a!==g.defaultTheme)if(Object.keys(E).length<=1)I("top","right",e("keepAtLeastOneTheme"),"warning");else{var t=Object(m.a)({},E);delete t[a];var n=JSON.stringify(t);y(Object(m.a)(Object(m.a)({},g),{},{themes:n}))}else I("top","right",e("cannotDeleteDefaultTheme"),"warning")}(a)}},l.a.createElement(za.a,null))))})))),l.a.createElement("div",null,l.a.createElement(he.a,{variant:"outlined",color:"primary",style:{marginTop:8},onClick:function(){return P(!0)}},e("createNewTheme"))),l.a.createElement(wa.a,{severity:"info",style:{marginTop:8}},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{i18nKey:"settings.themeConfigDes",ns:"dashboard",components:[l.a.createElement(Sa.a,{key:0,href:e("themeConfigDoc"),target:"_blank"})]})))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("defaultTheme")),l.a.createElement(ia.a,{value:g.defaultTheme,onChange:L("defaultTheme")},Object.keys(E).map((function(e){return l.a.createElement(ca.a,{key:e,value:e},l.a.createElement("div",{className:t.colorContainer},l.a.createElement("div",{style:{backgroundColor:E[e].palette.primary.main},className:t.colorDot}),l.a.createElement("div",{style:{backgroundColor:E[e].palette.secondary.main},className:t.colorDot})))}))),l.a.createElement(na.a,{id:"component-helper-text"},e("defaultThemeDes")))))),l.a.createElement("div",{className:t.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("appearance")),l.a.createElement("div",{className:t.formContainer},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("personalFileListView")),l.a.createElement(ia.a,{value:g.home_view_method,onChange:L("home_view_method"),required:!0},l.a.createElement(ca.a,{value:"icon"},a("fileManager.gridViewLarge")),l.a.createElement(ca.a,{value:"smallIcon"},a("fileManager.gridViewSmall")),l.a.createElement(ca.a,{value:"list"},a("fileManager.listView"))),l.a.createElement(na.a,{id:"component-helper-text"},e("personalFileListViewDes"))))),l.a.createElement("div",{className:t.formContainer},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("sharedFileListView")),l.a.createElement(ia.a,{value:g.share_view_method,onChange:L("share_view_method"),required:!0},l.a.createElement(ca.a,{value:"icon"},a("fileManager.gridViewLarge")),l.a.createElement(ca.a,{value:"smallIcon"},a("fileManager.gridViewSmall")),l.a.createElement(ca.a,{value:"list"},a("fileManager.listView"))),l.a.createElement(na.a,{id:"component-helper-text"},e("sharedFileListViewDes")))))),l.a.createElement("div",{className:t.root},l.a.createElement(he.a,{disabled:o,type:"submit",variant:"contained",color:"primary"},e("save")))),l.a.createElement(Ta,{onSubmit:function(a){if(P(!1),void 0===E[a.palette.primary.main]){var t=Object(m.a)(Object(m.a)({},E),{},Object(s.a)({},a.palette.primary.main,a)),n=JSON.stringify(t);y(Object(m.a)(Object(m.a)({},g),{},{themes:n}))}else I("top","right",e("duplicatedThemePrimaryColor"),"warning")},open:F,onClose:function(){return P(!1)}}))}var qa=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function Ba(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=qa(),t=Object(r.useState)(!1),c=Object(n.a)(t,2),i=c[0],o=c[1],u=Object(r.useState)({gravatar_server:"",avatar_path:"",avatar_size:"",avatar_size_l:"",avatar_size_m:"",avatar_size_s:"",thumb_width:"",thumb_height:"",office_preview_service:"",thumb_file_suffix:"",thumb_max_task_count:"",thumb_encode_method:"",thumb_gc_after_gen:"0",thumb_encode_quality:""}),d=Object(n.a)(u,2),p=d[0],E=d[1],b=function(e){return function(a){E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},e,a.target.value)))}},h=Object(Y.d)(),v=Object(r.useCallback)((function(e,a,t,n){return h(Object($e.S)(e,a,t,n))}),[h]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:Object.keys(p)}).then((function(e){E(e.data)})).catch((function(e){v("top","right",e.message,"error")}))}),[]);var f;return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),o(!0);var t=[];Object.keys(p).forEach((function(e){t.push({key:e,value:p[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){v("top","right",e("saved"),"success")})).catch((function(e){v("top","right",e.message,"error")})).then((function(){o(!1)}))}},l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("avatar")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("gravatarServer")),l.a.createElement(ra.a,{type:"url",value:p.gravatar_server,onChange:b("gravatar_server"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("gravatarServerDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("avatarFilePath")),l.a.createElement(ra.a,{value:p.avatar_path,onChange:b("avatar_path"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("avatarFilePathDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},""!==p.avatar_size&&l.a.createElement(ya,{value:p.avatar_size,onChange:b("avatar_size"),required:!0,min:0,max:2147483647,label:e("avatarSize")}),l.a.createElement(na.a,{id:"component-helper-text"},e("avatarSizeDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("smallAvatarSize")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.avatar_size_s,onChange:b("avatar_size_s"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("mediumAvatarSize")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.avatar_size_m,onChange:b("avatar_size_m"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("largeAvatarSize")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.avatar_size_l,onChange:b("avatar_size_l"),required:!0}))))),l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("filePreview")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("officePreviewService")),l.a.createElement(ra.a,{value:p.office_preview_service,onChange:b("office_preview_service"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("officePreviewServiceDes"),l.a.createElement("br",null),l.a.createElement("code",null,"{$src}")," -"," ",e("officePreviewServiceSrcDes"),l.a.createElement("br",null),l.a.createElement("code",null,"{$srcB64}")," -"," ",e("officePreviewServiceSrcB64Des ")))))),l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("thumbnails")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(wa.a,{severity:"info"},e("localOnlyInfo"))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("thumbWidth")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.thumb_width,onChange:b("thumb_width"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("thumbHeight")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.thumb_height,onChange:b("thumb_height"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("thumbSuffix")),l.a.createElement(ra.a,{type:"text",value:p.thumb_file_suffix,onChange:b("thumb_file_suffix"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("thumbConcurrent")),l.a.createElement(ra.a,{type:"number",inputProps:{min:-1,step:1},value:p.thumb_max_task_count,onChange:b("thumb_max_task_count"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("thumbConcurrentDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("thumbFormat")),l.a.createElement(ra.a,{type:"test",value:p.thumb_encode_method,onChange:b("thumb_encode_method"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("thumbFormatDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("thumbQuality")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1,max:100},value:p.thumb_encode_quality,onChange:b("thumb_encode_quality"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},e("thumbQualityDes")))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p.thumb_gc_after_gen,onChange:(f="thumb_gc_after_gen",function(e){var a=e.target.checked?"1":"0";E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},f,a)))})}),label:e("thumbGC")}))))),l.a.createElement("div",{className:a.root},l.a.createElement(he.a,{disabled:i,type:"submit",variant:"contained",color:"primary"},e("save")))))}var Ma=t(242),Ka=t(7136),Ua=t(8088),Ha=t(88),Ga=t(8069),Va=t(28),Ja=t(7125),Xa=t(8067),Qa=t(7130),$a=t(8068),Ya=Object(c.a)((function(e){return{cardContainer:{display:"flex"},cover:{width:100,height:60},card:{},content:{flex:"1 0 auto"},bg:{backgroundColor:e.palette.background.default,padding:"24px 24px"},dialogFooter:{justifyContent:"space-between"}}})),Za=[{name:"local",img:"local.png",path:"/admin/policy/add/local"},{name:"remote",img:"remote.png",path:"/admin/policy/add/remote"},{name:"qiniu",img:"qiniu.png",path:"/admin/policy/add/qiniu"},{name:"oss",img:"oss.png",path:"/admin/policy/add/oss"},{name:"upyun",img:"upyun.png",path:"/admin/policy/add/upyun"},{name:"cos",img:"cos.png",path:"/admin/policy/add/cos"},{name:"onedrive",img:"onedrive.png",path:"/admin/policy/add/onedrive"},{name:"s3",img:"s3.png",path:"/admin/policy/add/s3"}];function et(e){var a=e.open,t=e.onClose,n=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,r=Object(ne.a)("common").t,c=Ya(),i=Object(Z.g)();return l.a.createElement(Ne.a,{open:a,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"sm",fullWidth:!0},l.a.createElement(ke.a,{id:"alert-dialog-title"},n("selectAStorageProvider")),l.a.createElement(Ce.a,{dividers:!0,className:c.bg},l.a.createElement(xe.a,{container:!0,spacing:2},Za.map((function(e){return l.a.createElement(xe.a,{item:!0,sm:12,md:6,key:e.path},l.a.createElement(Ja.a,{className:c.card},l.a.createElement(Xa.a,{onClick:function(){i.push(e.path),t()},className:c.cardContainer},l.a.createElement($a.a,{className:c.cover,image:"/static/img/"+e.img}),l.a.createElement(Qa.a,{className:c.content},l.a.createElement(k.a,{variant:"subtitle1",color:"textSecondary"},n(e.name))))))})))),l.a.createElement(Se.a,{className:c.dialogFooter},l.a.createElement(he.a,{onClick:function(){return window.open(n("comparesStoragePoliciesLink"))},color:"primary"},n("comparesStoragePolicies")),l.a.createElement(he.a,{onClick:t,color:"primary"},r("cancel"))))}var at=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},headerRight:{}}})),tt=[{id:"#",label:"sharp",minWidth:50},{id:"name",label:"name",minWidth:170},{id:"type",label:"type",minWidth:170},{id:"count",label:"childFiles",minWidth:50,align:"right"},{id:"size",label:"totalSize",minWidth:100,align:"right"},{id:"action",label:"actions",minWidth:170,align:"right"}];function nt(){var e=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,a=at(),t=Object(r.useState)([]),c=Object(n.a)(t,2),i=c[0],o=c[1],m=Object(r.useState)([]),s=Object(n.a)(m,2),u=s[0],d=s[1],p=Object(r.useState)(1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=Object(r.useState)(10),g=Object(n.a)(v,2),y=g[0],O=g[1],N=Object(r.useState)(0),S=Object(n.a)(N,2),C=S[0],j=S[1],k=Object(r.useState)(!1),x=Object(n.a)(k,2),_=x[0],z=x[1],w=Object(r.useState)("all"),D=Object(n.a)(w,2),F=D[0],P=D[1],R=l.a.useState(null),I=Object(n.a)(R,2),L=I[0],T=I[1],W=l.a.useState(0),A=Object(n.a)(W,2),q=A[0],B=A[1],M=Object(Z.h)(),K=Object(Z.g)(),U=new URLSearchParams(Object(Z.h)().search),H=function(){T(null)},G=Object(Y.d)(),V=Object(r.useCallback)((function(e,a,t,n){return G(Object($e.S)(e,a,t,n))}),[G]);Object(r.useEffect)((function(){"0"===U.get("code")?V("top","right",e("authSuccess"),"success"):U.get("msg")&&""!==U.get("msg")&&V("top","right",U.get("msg")+", "+U.get("err"),"warning")}),[M]);var J=function(){Ye.c.post("/admin/policy/list",{page:b,page_size:y,order_by:"id desc",conditions:"all"===F?{}:{type:F}}).then((function(e){o(e.data.items),d(e.data.statics),j(e.data.total)})).catch((function(e){V("top","right",e.message,"error")}))};Object(r.useEffect)((function(){J()}),[b,y,F]);var X=Boolean(L);return l.a.createElement("div",null,l.a.createElement(et,{open:_,onClose:function(){return z(!1)}}),l.a.createElement("div",{className:a.header},l.a.createElement(he.a,{color:"primary",onClick:function(){return z(!0)},variant:"contained"},e("newStoragePolicy")),l.a.createElement("div",{className:a.headerRight},l.a.createElement(ia.a,{style:{marginRight:8},value:F,onChange:function(e){return P(e.target.value)}},["all","local","remote","qiniu","upyun","oss","cos","onedrive","s3"].map((function(a){return l.a.createElement(ca.a,{key:a,value:a},e(a))}))),l.a.createElement(he.a,{color:"primary",onClick:function(){return J()},variant:"outlined"},e("refresh")))),l.a.createElement(ze.a,{square:!0,className:a.tableContainer},l.a.createElement(Ka.a,{className:a.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},tt.map((function(a){return l.a.createElement(ka.a,{key:a.id,align:a.align,style:{minWidth:a.minWidth}},e(a.label))})))),l.a.createElement(ja.a,null,i.map((function(a){return l.a.createElement(_a.a,{hover:!0,key:a.ID},l.a.createElement(ka.a,null,a.ID),l.a.createElement(ka.a,null,a.Name),l.a.createElement(ka.a,null,e(a.Type)),l.a.createElement(ka.a,{align:"right"},void 0!==u[a.ID]&&u[a.ID][0].toLocaleString()),l.a.createElement(ka.a,{align:"right"},void 0!==u[a.ID]&&Object(Va.p)(u[a.ID][1])),l.a.createElement(ka.a,{align:"right"},l.a.createElement(Ha.a,{title:e("delete")},l.a.createElement(f.a,{onClick:function(){return t=a.ID,void Ye.c.delete("/admin/policy/"+t).then((function(){J(),V("top","right",e("policyDeleted"),"success")})).catch((function(e){V("top","right",e.message,"error")}));var t},size:"small"},l.a.createElement(za.a,null))),l.a.createElement(Ha.a,{title:e("edit")},l.a.createElement(f.a,{onClick:function(e){B(a.ID),T(e.currentTarget)},size:"small"},l.a.createElement(Ga.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,100],component:"div",count:C,rowsPerPage:y,page:b-1,onChangePage:function(e,a){return h(a+1)},onChangeRowsPerPage:function(e){O(e.target.value),h(1)}})),l.a.createElement(Ma.a,{open:X,anchorEl:L,onClose:H,keepMounted:!0},l.a.createElement(ca.a,{onClick:function(e){H(),K.push("/admin/policy/edit/pro/"+q)}},e("editInProMode")),l.a.createElement(ca.a,{onClick:function(e){H(),K.push("/admin/policy/edit/guide/"+q)}},e("editInWizardMode"))))}var rt=t(7020),lt=t(8085),ct=t(8071),it=t(8070),ot=t(8086),mt=t(8089);function st(e){var a=e.onChange,t=e.value,c=e.required,i=e.label,o=Object(r.useState)(""),m=Object(n.a)(o,2),s=m[0],u=m[1],d=Object(r.useState)("https://"),p=Object(n.a)(d,2),E=p[0],b=p[1],h=Object(r.useState)(),v=Object(n.a)(h,2),f=v[0],g=v[1];return Object(r.useState)((function(){(t=t||"").startsWith("https://")?(u(t.replace("https://","")),b("https://")):""!==t&&(u(t.replace("http://","")),b("http://"))}),[t]),Object(r.useEffect)((function(){"http://"===E&&"https:"===window.location.protocol?g("\u60a8\u5f53\u524d\u7ad9\u70b9\u542f\u7528\u4e86 HTTPS \uff0c\u6b64\u5904\u9009\u62e9 HTTP \u53ef\u80fd\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u8fde\u63a5\u3002"):g("")}),[E]),l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},i),l.a.createElement(ra.a,{error:""!==f,value:s,onChange:function(e){u(e.target.value),a({target:{value:E+e.target.value}})},required:c,startAdornment:l.a.createElement(ga.a,{position:"start"},l.a.createElement(ia.a,{value:E,onChange:function(e){b(e.target.value),a({target:{value:e.target.value+s}})}},l.a.createElement(ca.a,{value:"http://"},"http://"),l.a.createElement(ca.a,{value:"https://"},"https://")))}),""!==f&&l.a.createElement(na.a,{error:""!==f},f))}var ut=[{value:"{randomkey16}",des:"16digitsRandomString",example:"N6IimT5XZP324ACK",fileOnly:!1},{value:"{randomkey8}",des:"8digitsRandomString",example:"gWz78q30",fileOnly:!1},{value:"{timestamp}",des:"secondTimestamp",example:"1582692933",fileOnly:!1},{value:"{timestamp_nano}",des:"nanoTimestamp",example:"1582692933231834600",fileOnly:!1},{value:"{uid}",des:"uid",example:"1",fileOnly:!1},{value:"{originname}",des:"originalFileName",example:"MyPico.mp4",fileOnly:!0},{value:"{ext}",des:"extension",example:".jpg",fileOnly:!0},{value:"{uuid}",des:"uuidV4",example:"31f0a770-659d-45bf-a5a9-166c06f33281",fileOnly:!0},{value:"{date}",des:"date",example:"20060102",fileOnly:!1},{value:"{datetime}",des:"dateAndTime",example:"20060102150405",fileOnly:!1},{value:"{year}",des:"year",example:"2006",fileOnly:!1},{value:"{month}",des:"month",example:"01",fileOnly:!1},{value:"{day}",des:"day",example:"02",fileOnly:!1},{value:"{hour}",des:"hour",example:"15",fileOnly:!1},{value:"{minute}",des:"minute",example:"04",fileOnly:!1},{value:"{second}",des:"second",example:"05",fileOnly:!1}];function dt(e){var a=e.isFile,t=e.open,n=e.onClose,r=(e.isSlave,Object(ne.a)("dashboard",{keyPrefix:"policy.magicVar"}).t),c=Object(ne.a)("common").t;return l.a.createElement(Ne.a,{open:t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},l.a.createElement(ke.a,{id:"alert-dialog-title"},r(a?"fileNameMagicVar":"pathMagicVar")),l.a.createElement(Ce.a,null,l.a.createElement(Ka.a,null,l.a.createElement(Ca.a,{size:"small","aria-label":"a dense table"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,null,l.a.createElement(ka.a,null,r("variable")),l.a.createElement(ka.a,null,r("description")),l.a.createElement(ka.a,null,r("example")))),l.a.createElement(ja.a,null,ut.map((function(e){if(!e.fileOnly||a)return l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},e.value),l.a.createElement(ka.a,null,r(e.des)),l.a.createElement(ka.a,null,e.example))})),!a&&l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},"{path}"),l.a.createElement(ka.a,null,r("userUploadPath")),l.a.createElement(ka.a,null,"/MyFile/Documents/")))))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:n,color:"primary"},c("close"))))}var pt=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"}}}})),Et=[{title:"storageBucket",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"corsSettingStep",optional:!0},{title:"callbackFunctionStep",optional:!0},{title:"finishStep",optional:!1}];function bt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=pt(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,2),g=f[0],y=f[1],O=Object(r.useState)(""),N=Object(n.a)(O,2),S=N[0],C=N[1],j=Object(r.useState)("false"),x=Object(n.a)(j,2),_=x[0],z=x[1],w=Object(r.useState)(e.policy?e.policy:{Type:"cos",Name:"",SecretKey:"",AccessKey:"",BaseURL:"",Server:"",IsPrivate:"true",DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",MaxSize:"0",OptionsSerialized:{file_type:"",placeholder_with_size:"false"}}),D=Object(n.a)(w,2),F=D[0],P=D[1],R=Object(r.useState)(e.policy?e.policy.ID:0),I=Object(n.a)(R,2),L=I[0],T=I[1],W=Object(r.useState)("ap-chengdu"),A=Object(n.a)(W,2),q=A[0],B=A[1],M=function(e){return function(a){P(Object(m.a)(Object(m.a)({},F),{},Object(s.a)({},e,a.target.value)))}},K=function(e){return function(a){P(Object(m.a)(Object(m.a)({},F),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},F.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},U=Object(Y.d)(),H=Object(r.useCallback)((function(e,a,t,n){return U(Object($e.S)(e,a,t,n))}),[U]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.policy?a("editCOSStoragePolicy"):a("addCOSStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},Et.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,g.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.wanSiteURLDes",components:[l.a.createElement("strong",{key:0})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createCOSBucketDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/cos5",target:"_blank"})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.cosBucketNameDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("qiniuBucketName")),l.a.createElement(ra.a,{inputProps:{pattern:"[a-z0-9-]+-[0-9]+",title:a("cosBucketFormatError")},required:!0,value:F.BucketName,onChange:M("BucketName")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.cosBucketTypeDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:F.IsPrivate,onChange:M("IsPrivate"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("cosPrivateRW")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("cosPublicRW")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.cosAccessDomainDes",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1})]})),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:F.Server,onChange:M("Server"),required:!0,label:a("accessDomain")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("cosCDNDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:_,onChange:function(e){z(e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))))),l.a.createElement(rt.a,{in:"true"===_},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"6")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.cosCDNDomainDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/cdn/access/guid",target:"_blank"})]})),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:F.BaseURL,onChange:M("BaseURL"),required:"true"===_,label:a("bucketCDNDomain")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(6,["true"===_]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.cosCredentialDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/cam/capi",target:"_blank"})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("secretId")),l.a.createElement(ra.a,{required:!0,inputProps:{pattern:"\\S+",title:a("shouldNotContainSpace")},value:F.AccessKey,onChange:M("AccessKey")}))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("secretKey")),l.a.createElement(ra.a,{required:!0,inputProps:{pattern:"\\S+",title:a("shouldNotContainSpace")},value:F.SecretKey,onChange:M("SecretKey")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(7,["true"===_]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicyFirst")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:F.Name,onChange:M("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContental,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return C("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:F.DirNameRule,onChange:M("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return C("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:F.AutoRename,onChange:M("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===F.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===F.AutoRename,value:F.FileNameRule,onChange:M("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:F.IsOriginLinkEnable,onChange:function(e){"true"!==F.IsPrivate||"true"!==e.target.value?M("IsOriginLinkEnable")(e):H("top","right",a("cannotEnableForPrivateBucket"),"warning")},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},F);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),"false"===_&&(n.BaseURL=F.Server),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.IsPrivate="true"===n.IsPrivate,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(t){H("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(4),T(t.data)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===F.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?P(Object(m.a)(Object(m.a)({},F),{},{MaxSize:"10485760"})):P(Object(m.a)(Object(m.a)({},F),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==F.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:F.MaxSize,onChange:M("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==F.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===F.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?P(Object(m.a)(Object(m.a)({},F),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},F.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):P(Object(m.a)(Object(m.a)({},F),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},F.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==F.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==F.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:F.OptionsSerialized.file_type,onChange:K("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==F.MaxSize,""!==F.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("createPlaceholderDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:F.OptionsSerialized.placeholder_with_size,onChange:K("placeholder_with_size"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("createPlaceholder")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notCreatePlaceholder")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("ossCORSDes")),l.a.createElement("div",{className:t.form},l.a.createElement(he.a,{disabled:b,color:"secondary",variant:"contained",className:t.button,onClick:function(){return h(!0),void Ye.c.post("/admin/policy/cors",{id:L}).then((function(){H("top","right",a("corsPolicyAdded"),"success"),d(5)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)}))},classes:{label:t.viewButtonLabel}},a("letCloudreveHelpMe"))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){d((function(e){return e+1})),y((function(e){var a=new Set(e.values());return a.add(u),a}))}},a("skip"))," ")),5===u&&l.a.createElement("form",{className:t.stepContent},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.cosCallbackDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/scf/index?rid=16",target:"_blank"})]}),l.a.createElement("br",null),l.a.createElement("br",null)),l.a.createElement(k.a,{variant:"body2"},a("cosCallbackCreate")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},a("cosBucketRegion")),l.a.createElement(ia.a,{value:q,onChange:function(e){return B(e.target.value)},required:!0},["ap-beijing","ap-chengdu","ap-guangzhou","ap-guangzhou-open","ap-hongkong","ap-mumbai","na-siliconvalley","na-toronto"].map((function(e){return l.a.createElement(ca.a,{key:e,value:e},a(e))}))))),l.a.createElement("div",{className:t.form},l.a.createElement(he.a,{disabled:b,color:"secondary",variant:"contained",className:t.button,onClick:function(){return h(!0),void Ye.c.post("/admin/policy/scf",{id:L,region:q}).then((function(){H("top","right",a("callbackFunctionAdded"),"success"),d(6)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)}))},classes:{label:t.viewButtonLabel}},a("letCloudreveHelpMe"))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){d((function(e){return e+1})),y((function(e){var a=new Set(e.values());return a.add(u),a}))}},a("skip"))," ")),6===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===S,isFile:!0,onClose:function(){return C("")}}),l.a.createElement(dt,{open:"path"===S,onClose:function(){return C("")}}))}var ht=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)}}})),vt=[{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"finishStep",optional:!1}];function ft(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=ht(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,1)[0],g=Object(r.useState)(""),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)("false"),C=Object(n.a)(S,2),j=C[0],x=C[1],_=Object(r.useState)(e.policy?e.policy:{Type:"local",Name:"",DirNameRule:"uploads/{uid}/{path}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",BaseURL:"",IsPrivate:"true",MaxSize:"0",OptionsSerialized:{file_type:"",chunk_size:25<<20}}),z=Object(n.a)(_,2),w=z[0],D=z[1],F=function(e){return function(a){D(Object(m.a)(Object(m.a)({},w),{},Object(s.a)({},e,a.target.value)))}},P=function(e){return function(a){D(Object(m.a)(Object(m.a)({},w),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},w.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},R=Object(Y.d)(),I=Object(r.useCallback)((function(e,a,t,n){return R(Object($e.S)(e,a,t,n))}),[R]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.policy?a("editLocalStoragePolicy"):a("addLocalStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},vt.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,f.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:a(e.title)},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),h(!0),Ye.c.post("/admin/policy/test/path",{path:w.DirNameRule}).then((function(){d(1)})).catch((function(e){I("top","right",e.message,"error")})).then((function(){h(!1)}))}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:w.DirNameRule,onChange:F("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:w.AutoRename,onChange:F("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===w.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===w.AutoRename,value:w.FileNameRule,onChange:F("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:w.IsOriginLinkEnable,onChange:F("IsOriginLinkEnable"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement(rt.a,{in:"true"===w.IsOriginLinkEnable},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("useCDN"),l.a.createElement("br",null),a("useCDNDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j,onChange:function(e){"false"===e.target.value&&D(Object(m.a)(Object(m.a)({},w),{},{BaseURL:""})),x(e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))))),l.a.createElement(rt.a,{in:"true"===j},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("cdnDomain")),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:w.BaseURL,onChange:F("BaseURL"),required:"true"===w.IsOriginLinkEnable&&"true"===j,label:a("cdnPrefix")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===w.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?D(Object(m.a)(Object(m.a)({},w),{},{MaxSize:"10485760"})):D(Object(m.a)(Object(m.a)({},w),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==w.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:w.MaxSize,onChange:F("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==w.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===w.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?D(Object(m.a)(Object(m.a)({},w),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},w.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):D(Object(m.a)(Object(m.a)({},w),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},w.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==w.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==w.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:w.OptionsSerialized.file_type,onChange:P("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==w.MaxSize,""!==w.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("chunkSizeLabel"),l.a.createElement("br",null),a("chunkSizeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:w.OptionsSerialized.chunk_size,onChange:P("chunk_size"),min:0,max:0x8000000000000000,label:a("chunkSize")})))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},w);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),"false"!==j&&"false"!==w.IsOriginLinkEnable||(n.BaseURL=""),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.IsPrivate="true"===n.IsPrivate,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(){I("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(4)})).catch((function(e){I("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicy")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:w.Name,onChange:F("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("finish")))),4===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===O,isFile:!0,onClose:function(){return N("")}}),l.a.createElement(dt,{open:"path"===O,onClose:function(){return N("")}}))}var gt=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"}}}})),yt=[{title:"applicationRegistration",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"grantAccess",optional:!1},{title:"finishStep",optional:!1}];function Ot(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=gt(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,1)[0],g=Object(r.useState)(""),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)(!(!e.policy||!e.policy.OptionsSerialized.od_proxy)&&""!==e.policy.OptionsSerialized.od_proxy),C=Object(n.a)(S,2),j=C[0],x=C[1],_=Object(r.useState)(!(!e.policy||!e.policy.OptionsSerialized.od_driver)&&""!==e.policy.OptionsSerialized.od_driver),z=Object(n.a)(_,2),w=z[0],D=z[1],F=Object(r.useState)(e.policy?e.policy:{Type:"onedrive",Name:"",BucketName:"",SecretKey:"",AccessKey:"",BaseURL:"",Server:"https://graph.microsoft.com/v1.0",IsPrivate:"true",DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",MaxSize:"0",OptionsSerialized:{file_type:"",od_redirect:"",od_proxy:"",od_driver:"",chunk_size:50<<20,placeholder_with_size:"false",tps_limit:"0",tps_limit_burst:"0"}}),P=Object(n.a)(F,2),R=P[0],I=P[1],L=Object(r.useState)(e.policy?e.policy.ID:0),T=Object(n.a)(L,2),W=T[0],A=T[1],q=Object(r.useState)(!1),B=Object(n.a)(q,2),M=B[0],K=B[1],U=function(e){return function(a){I(Object(m.a)(Object(m.a)({},R),{},Object(s.a)({},e,a.target.value)))}},H=function(e){return function(a){I(Object(m.a)(Object(m.a)({},R),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},R.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},G=Object(Y.d)(),V=Object(r.useCallback)((function(e,a,t,n){return G(Object($e.S)(e,a,t,n))}),[G]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:["siteURL"]}).then((function(e){e.data.siteURL.startsWith("https://")||K(!0),""===R.OptionsSerialized.od_redirect&&I(Object(m.a)(Object(m.a)({},R),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},R.OptionsSerialized),{},{od_redirect:new URL("/api/v3/callback/onedrive/auth",e.data.siteURL).toString()})}))})).catch((function(e){V("top","right",e.message,"error")}))}),[]);return l.a.createElement("div",null,l.a.createElement(pa,{open:M,onClose:function(){return K(!1)},title:a("warning"),msg:a("odHttpsWarning")}),l.a.createElement(k.a,{variant:"h6"},e.policy?a("editOdStoragePolicy"):a("addOdStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},yt.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,f.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.creatAadAppDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview",target:"_blank"}),l.a.createElement(Sa.a,{key:1,href:"https://portal.azure.cn/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview",target:"_blank"}),l.a.createElement("code",{key:2})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createAadAppDes2",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createAadAppDes3",values:{url:R.OptionsSerialized.od_redirect},components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2}),l.a.createElement("code",{key:3}),l.a.createElement("code",{key:4})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.aadAppIDDes",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("aadAppID")),l.a.createElement(ra.a,{required:!0,value:R.BucketName,onChange:U("BucketName")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.addAppSecretDes",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2}),l.a.createElement("code",{key:3})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("aadAppSecret")),l.a.createElement(ra.a,{required:!0,value:R.SecretKey,onChange:U("SecretKey")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"6")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("aadAccountCloudDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:R.Server,onChange:U("Server"),row:!0},l.a.createElement(ua.a,{value:"https://graph.microsoft.com/v1.0",control:l.a.createElement(lt.a,{color:"primary"}),label:a("multiTenant")}),l.a.createElement(ua.a,{value:"https://microsoftgraph.chinacloudapi.cn/v1.0",control:l.a.createElement(lt.a,{color:"primary"}),label:a("gallatin")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"7")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("sharePointDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:w.toString(),onChange:function(e){D("true"===e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("saveToSharePoint")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("saveToOneDrive")})))),l.a.createElement(rt.a,{in:w},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("spSiteURL")),l.a.createElement(ra.a,{placeholder:"https://example.sharepoint.com/sites/demo",value:R.OptionsSerialized.od_driver,onChange:H("od_driver"),required:w,label:a("spSiteURL")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"8")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("odReverseProxyURLDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j.toString(),onChange:function(e){x("true"===e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))),l.a.createElement(rt.a,{in:j},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(st,{value:R.OptionsSerialized.od_proxy,onChange:H("od_proxy"),required:j,label:a("odReverseProxyURL")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"9")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicyFirst")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:R.Name,onChange:U("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:R.DirNameRule,onChange:U("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:R.AutoRename,onChange:U("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===R.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===R.AutoRename,value:R.FileNameRule,onChange:U("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:R.IsOriginLinkEnable,onChange:function(e){U("IsOriginLinkEnable")(e)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},R);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),"https://graph.microsoft.com/v1.0"===n.Server?n.BaseURL="https://login.microsoftonline.com/common/oauth2/v2.0":n.BaseURL="https://login.chinacloudapi.cn/common/oauth2",j||(n.OptionsSerialized.od_proxy=""),w||(n.OptionsSerialized.od_driver=""),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.IsPrivate="true"===n.IsPrivate,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.tps_limit=parseFloat(n.OptionsSerialized.tps_limit),n.OptionsSerialized.tps_limit_burst=parseInt(n.OptionsSerialized.tps_limit_burst),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(t){V("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(4),A(t.data)})).catch((function(e){V("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===R.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?I(Object(m.a)(Object(m.a)({},R),{},{MaxSize:"10485760"})):I(Object(m.a)(Object(m.a)({},R),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==R.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:R.MaxSize,onChange:U("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==R.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===R.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?I(Object(m.a)(Object(m.a)({},R),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},R.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):I(Object(m.a)(Object(m.a)({},R),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},R.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==R.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==R.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:R.OptionsSerialized.file_type,onChange:H("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==R.MaxSize,""!==R.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("chunkSizeLabelOd"),l.a.createElement("br",null),a("chunkSizeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:R.OptionsSerialized.chunk_size,onChange:H("chunk_size"),min:0,max:0x8000000000000000,label:a("chunkSize")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(4,["0"!==R.MaxSize,""!==R.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("createPlaceholderDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:R.OptionsSerialized.placeholder_with_size,onChange:H("placeholder_with_size"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("createPlaceholder")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notCreatePlaceholder")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(5,["0"!==R.MaxSize,""!==R.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitOdTPSDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:0===parseFloat(R.OptionsSerialized.tps_limit)?"false":"true",onChange:function(e){"true"===e.target.value?I(Object(m.a)(Object(m.a)({},R),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},R.OptionsSerialized),{},{tps_limit:"5.0"})})):I(Object(m.a)(Object(m.a)({},R),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},R.OptionsSerialized),{},{tps_limit:"0"})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))),l.a.createElement(rt.a,{in:0!==parseFloat(R.OptionsSerialized.tps_limit)},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("tps")),l.a.createElement(ra.a,{type:"number",inputProps:{step:.1},required:!0,value:R.OptionsSerialized.tps_limit,onChange:H("tps_limit")}),l.a.createElement(na.a,null,a("tpsDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("tpsBurst")),l.a.createElement(ra.a,{type:"number",inputProps:{step:1},required:!0,value:R.OptionsSerialized.tps_limit_burst,onChange:H("tps_limit_burst")}),l.a.createElement(na.a,null,a("tpsBurstDes"))))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(4)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2"},a("odOauthDes")),l.a.createElement("div",{className:t.form},l.a.createElement(he.a,{disabled:b,color:"secondary",variant:"contained",className:t.button,onClick:function(){h(!0),Ye.c.get("/admin/policy/"+W+"/oauth").then((function(e){window.location.href=e.data})).catch((function(e){V("top","right",e.message,"error"),h(!1)}))},classes:{label:t.viewButtonLabel}},a("gotoAuthPage"))))),l.a.createElement("div",{className:t.stepFooter})),5===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===O,isFile:!0,onClose:function(){return N("")}}),l.a.createElement(dt,{open:"path"===O,onClose:function(){return N("")}}))}var Nt=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"}}}})),St=[{title:"storageBucket",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"corsSettingStep",optional:!0},{title:"finishStep",optional:!1}];function Ct(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=Nt(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,2),g=f[0],y=f[1],O=Object(r.useState)(""),N=Object(n.a)(O,2),S=N[0],C=N[1],j=Object(r.useState)("false"),x=Object(n.a)(j,2),_=x[0],z=x[1],w=Object(r.useState)(!(!e.policy||!e.policy.OptionsSerialized.server_side_endpoint)&&""!==e.policy.OptionsSerialized.server_side_endpoint),D=Object(n.a)(w,2),F=D[0],P=D[1],R=Object(r.useState)(e.policy?e.policy:{Type:"oss",Name:"",SecretKey:"",AccessKey:"",BaseURL:"",Server:"",IsPrivate:"true",DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",MaxSize:"0",OptionsSerialized:{file_type:"",server_side_endpoint:"",chunk_size:25<<20,placeholder_with_size:"false"}}),I=Object(n.a)(R,2),L=I[0],T=I[1],W=Object(r.useState)(e.policy?e.policy.ID:0),A=Object(n.a)(W,2),q=A[0],B=A[1],M=function(e){return function(a){T(Object(m.a)(Object(m.a)({},L),{},Object(s.a)({},e,a.target.value)))}},K=function(e){return function(a){T(Object(m.a)(Object(m.a)({},L),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},L.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},U=Object(Y.d)(),H=Object(r.useCallback)((function(e,a,t,n){return U(Object($e.S)(e,a,t,n))}),[U]),G=function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},L);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),"false"===_&&(n.BaseURL=""),F||(n.OptionsSerialized.server_side_endpoint=""),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.IsPrivate="true"===n.IsPrivate,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(t){H("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(4),B(t.data)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)};return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.policy?a("editOSSStoragePolicy"):a("addOSSStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},St.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,g.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.wanSiteURLDes",components:[l.a.createElement("strong",{key:0})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createOSSBucketDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://oss.console.aliyun.com/overview",target:"_blank"}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2}),l.a.createElement("code",{key:3})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.ossBucketNameDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("bucketName")),l.a.createElement(ra.a,{required:!0,value:L.BucketName,onChange:M("BucketName")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("bucketTypeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:L.IsPrivate,onChange:M("IsPrivate"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("privateBucket")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("publicReadBucket")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.ossEndpointDes",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("endpoint")),l.a.createElement(ra.a,{required:!0,value:L.Server,onChange:M("Server"),inputProps:{pattern:"(?:(?:(?<thld>[\\w\\-]*)(?:\\.))?(?<sld>[\\w\\-]*))\\.(?<tld>[\\w\\-]*)",title:a("endpointDomainOnly")}}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("ossLANEndpointDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:F.toString(),onChange:function(e){P("true"===e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))),l.a.createElement(rt.a,{in:F},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("intranetEndPoint")),l.a.createElement(ra.a,{required:F,value:L.OptionsSerialized.server_side_endpoint,onChange:K("server_side_endpoint"),inputProps:{pattern:"(?:(?:(?<thld>[\\w\\-]*)(?:\\.))?(?<sld>[\\w\\-]*))\\.(?<tld>[\\w\\-]*)",title:a("endpointDomainOnly")}})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"6")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("ossCDNDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:_,onChange:function(e){z(e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))))),l.a.createElement(rt.a,{in:"true"===_},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"7")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createOSSCDNDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://cdn.console.aliyun.com/domain/list",target:"_blank"})]})),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:L.BaseURL,onChange:M("BaseURL"),required:"true"===_,label:a("bucketCDNDomain")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(7,["true"===_]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.ossAKDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://usercenter.console.aliyun.com/#/manage/ak",target:"_blank"})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},"AccessKey ID"),l.a.createElement(ra.a,{required:!0,inputProps:{pattern:"\\S+",title:a("shouldNotContainSpace")},value:L.AccessKey,onChange:M("AccessKey")}))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},"Access Key Secret"),l.a.createElement(ra.a,{required:!0,inputProps:{pattern:"\\S+",title:a("shouldNotContainSpace")},value:L.SecretKey,onChange:M("SecretKey")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(8,["true"===_]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicyFirst")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:L.Name,onChange:M("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return C("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:L.DirNameRule,onChange:M("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return C("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:L.AutoRename,onChange:M("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===L.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===L.AutoRename,value:L.FileNameRule,onChange:M("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:L.IsOriginLinkEnable,onChange:function(e){"true"!==L.IsPrivate||"true"!==e.target.value?M("IsOriginLinkEnable")(e):H("top","right",a("cannotEnableForPrivateBucket"),"warning")},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:G},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===L.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?T(Object(m.a)(Object(m.a)({},L),{},{MaxSize:"10485760"})):T(Object(m.a)(Object(m.a)({},L),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==L.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:L.MaxSize,onChange:M("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==L.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===L.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?T(Object(m.a)(Object(m.a)({},L),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},L.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):T(Object(m.a)(Object(m.a)({},L),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},L.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==L.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==L.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:L.OptionsSerialized.file_type,onChange:K("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==L.MaxSize,""!==L.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("chunkSizeLabelOSS"),l.a.createElement("br",null),a("chunkSizeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:L.OptionsSerialized.chunk_size,onChange:K("chunk_size"),min:102400,max:5368709120,label:a("chunkSize")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(4,["0"!==L.MaxSize,""!==L.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("createPlaceholderDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:L.OptionsSerialized.placeholder_with_size,onChange:K("placeholder_with_size"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("createPlaceholder")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notCreatePlaceholder")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:G},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("ossCORSDes")),l.a.createElement("div",{className:t.form},l.a.createElement(he.a,{disabled:b,color:"secondary",variant:"contained",className:t.button,onClick:function(){return h(!0),void Ye.c.post("/admin/policy/cors",{id:q}).then((function(){H("top","right",a("corsPolicyAdded"),"success"),d(5)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)}))},classes:{label:t.viewButtonLabel}},a("letCloudreveHelpMe"))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){d((function(e){return e+1})),y((function(e){var a=new Set(e.values());return a.add(u),a}))}},a("skip"))," ")),5===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===S,isFile:!0,onClose:function(){return C("")}}),l.a.createElement(dt,{open:"path"===S,onClose:function(){return C("")}}))}var jt=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)}}})),kt=[{title:"storageBucket",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"finishStep",optional:!1}];function xt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=jt(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,1)[0],g=Object(r.useState)(""),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)(e.policy?e.policy:{Type:"qiniu",Name:"",SecretKey:"",AccessKey:"",BaseURL:"",IsPrivate:"true",DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",MaxSize:"0",OptionsSerialized:{file_type:"",mimetype:"",chunk_size:25<<20,placeholder_with_size:"false"}}),C=Object(n.a)(S,2),j=C[0],x=C[1],_=function(e){return function(a){x(Object(m.a)(Object(m.a)({},j),{},Object(s.a)({},e,a.target.value)))}},z=function(e){return function(a){x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},w=Object(Y.d)(),D=Object(r.useCallback)((function(e,a,t,n){return w(Object($e.S)(e,a,t,n))}),[w]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.policy?a("editQiniuStoragePolicy"):a("addQiniuStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},kt.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,f.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.wanSiteURLDes",components:[l.a.createElement("strong",{key:0})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createQiniuBucket",components:[l.a.createElement(Sa.a,{key:0,href:"https://portal.qiniu.com/create",target:"_blank"})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterQiniuBucket")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("qiniuBucketName")),l.a.createElement(ra.a,{required:!0,value:j.BucketName,onChange:_("BucketName")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("bucketTypeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j.IsPrivate,onChange:_("IsPrivate"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("privateBucket")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("publicBucket")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("bucketCDNDes")),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:j.BaseURL,onChange:_("BaseURL"),required:!0,label:a("bucketCDNDomain")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("qiniuCredentialDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("ak")),l.a.createElement(ra.a,{required:!0,value:j.AccessKey,onChange:_("AccessKey")}))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("sk")),l.a.createElement(ra.a,{required:!0,value:j.SecretKey,onChange:_("SecretKey")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:j.DirNameRule,onChange:_("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:j.AutoRename,onChange:_("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===j.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===j.AutoRename,value:j.FileNameRule,onChange:_("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j.IsOriginLinkEnable,onChange:function(e){"true"!==j.IsPrivate||"true"!==e.target.value?_("IsOriginLinkEnable")(e):D("top","right",a("cannotEnableForPrivateBucket"),"warning")},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(4)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===j.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?x(Object(m.a)(Object(m.a)({},j),{},{MaxSize:"10485760"})):x(Object(m.a)(Object(m.a)({},j),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==j.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:j.MaxSize,onChange:_("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==j.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===j.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==j.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==j.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:j.OptionsSerialized.file_type,onChange:z("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==j.MaxSize,""!==j.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitMimeType")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===j.OptionsSerialized.mimetype?"false":"true",onChange:function(e){"true"===e.target.value?x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},{mimetype:"image/*"})})):x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},{mimetype:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==j.OptionsSerialized.mimetype},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(4,["0"!==j.MaxSize,""!==j.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("mimeTypeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("mimeTypeList")),l.a.createElement(ra.a,{value:j.OptionsSerialized.mimetype,onChange:z("mimetype")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(4,["0"!==j.MaxSize,""!==j.OptionsSerialized.file_type,""!==j.OptionsSerialized.mimetype]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("chunkSizeLabelQiniu"),l.a.createElement("br",null),a("chunkSizeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:j.OptionsSerialized.chunk_size,onChange:z("chunk_size"),min:1<<20,max:1024<<20,label:a("chunkSize")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(5,["0"!==j.MaxSize,""!==j.OptionsSerialized.file_type,""!==j.OptionsSerialized.mimetype]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("createPlaceholderDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:j.OptionsSerialized.placeholder_with_size,onChange:z("placeholder_with_size"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("createPlaceholder")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notCreatePlaceholder")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},j);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.IsPrivate="true"===n.IsPrivate,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(){D("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(5)})).catch((function(e){D("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicy")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:j.Name,onChange:_("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(3)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("finish")))),5===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===O,isFile:!0,onClose:function(){return N("")}}),l.a.createElement(dt,{open:"path"===O,onClose:function(){return N("")}}))}var _t=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontSize:"14px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"},pre:{margin:"24px 0",padding:"12px 18px",overflow:"auto",direction:"ltr",borderRadius:"4px",backgroundColor:"#272c34",color:"#fff"}}}})),zt=[{title:"storageNode",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"finishStep",optional:!1}];function wt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=_t(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,1)[0],g=Object(r.useState)(""),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)("false"),C=Object(n.a)(S,2),j=C[0],x=C[1],_=Object(r.useState)(e.policy?e.policy:{Type:"remote",Name:"",Server:"https://example.com:5212",SecretKey:Object(Va.n)(64),DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",BaseURL:"",IsPrivate:"true",MaxSize:"0",OptionsSerialized:{file_type:"",chunk_size:25<<20}}),z=Object(n.a)(_,2),w=z[0],D=z[1],F=function(e){return function(a){D(Object(m.a)(Object(m.a)({},w),{},Object(s.a)({},e,a.target.value)))}},P=function(e){return function(a){D(Object(m.a)(Object(m.a)({},w),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},w.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},R=Object(Y.d)(),I=Object(r.useCallback)((function(e,a,t,n){return R(Object($e.S)(e,a,t,n))}),[R]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.policy?a("editRemoteStoragePolicy"):a("addRemoteStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},zt.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,f.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement(wa.a,{severity:"info",style:{marginBottom:10}},a("remoteDescription")),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("remoteCopyBinaryDescription")))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("remoteSecretDescription")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("remoteSecret")),l.a.createElement(ra.a,{required:!0,inputProps:{minlength:64},value:w.SecretKey,onChange:F("SecretKey")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("modifyRemoteConfig"),l.a.createElement("br",null),l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.addRemoteConfigDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("pre",null,"[System]",l.a.createElement("br",null),"Mode = slave",l.a.createElement("br",null),"Listen = :5212",l.a.createElement("br",null),l.a.createElement("br",null),"[Slave]",l.a.createElement("br",null),"Secret = ",w.SecretKey,l.a.createElement("br",null),l.a.createElement("br",null),"[CORS]",l.a.createElement("br",null),"AllowOrigins = *",l.a.createElement("br",null),"AllowMethods = OPTIONS,GET,POST",l.a.createElement("br",null),"AllowHeaders = *",l.a.createElement("br",null)),l.a.createElement(k.a,{variant:"body2"},a("remoteConfigDifference"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.remoteConfigDifference1",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2})]})),l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.remoteConfigDifference2",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1})]})),l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.remoteConfigDifference3",components:[l.a.createElement("code",{key:0})]})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("inputRemoteAddress"),l.a.createElement("br",null),a("inputRemoteAddressDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("remoteAddress")),l.a.createElement(ra.a,{fullWidth:!0,required:!0,type:"url",value:w.Server,onChange:F("Server")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("testCommunicationDes")),l.a.createElement("div",{className:t.form},l.a.createElement(he.a,{disabled:b,onClick:function(){return h(!0),void Ye.c.post("/admin/policy/test/slave",{server:w.Server,secret:w.SecretKey}).then((function(){I("top","right",a("communicationOK"),"success")})).catch((function(e){I("top","right",e.message,"error")})).then((function(){h(!1)}))},variant:"outlined",color:"primary"},a("testCommunication"))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:w.DirNameRule,onChange:F("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},"\u662f\u5426\u9700\u8981\u5bf9\u5b58\u50a8\u7684\u7269\u7406\u6587\u4ef6\u8fdb\u884c\u91cd\u547d\u540d\uff1f\u6b64\u5904\u7684\u91cd\u547d\u540d\u4e0d\u4f1a\u5f71\u54cd\u6700\u7ec8\u5448\u73b0\u7ed9\u7528\u6237\u7684 \u6587\u4ef6\u540d\u3002\u6587\u4ef6\u540d\u4e5f\u53ef\u4f7f\u7528\u9b54\u6cd5\u53d8\u91cf\uff0c \u53ef\u7528\u9b54\u6cd5\u53d8\u91cf\u53ef\u53c2\u8003"," ",l.a.createElement(Sa.a,{color:"secondary",onClick:function(e){e.preventDefault(),N("file")}},"\u6587\u4ef6\u540d\u9b54\u6cd5\u53d8\u91cf\u5217\u8868")," ","\u3002"),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:w.AutoRename,onChange:F("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===w.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===w.AutoRename,value:w.FileNameRule,onChange:F("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:w.IsOriginLinkEnable,onChange:F("IsOriginLinkEnable"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement(rt.a,{in:"true"===w.IsOriginLinkEnable},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("useCDN"),l.a.createElement("br",null),a("useCDNDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j,onChange:function(e){"false"===e.target.value&&D(Object(m.a)(Object(m.a)({},w),{},{BaseURL:""})),x(e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))))),l.a.createElement(rt.a,{in:"true"===j},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("cdnDomain")),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:w.BaseURL,onChange:F("BaseURL"),required:"true"===w.IsOriginLinkEnable&&"true"===j,label:a("cdnPrefix")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(4)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===w.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?D(Object(m.a)(Object(m.a)({},w),{},{MaxSize:"10485760"})):D(Object(m.a)(Object(m.a)({},w),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==w.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:w.MaxSize,onChange:F("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==w.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===w.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?D(Object(m.a)(Object(m.a)({},w),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},w.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):D(Object(m.a)(Object(m.a)({},w),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},w.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==w.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==w.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:w.OptionsSerialized.file_type,onChange:P("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==w.MaxSize,""!==w.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("chunkSizeLabel"),l.a.createElement("br",null),a("chunkSizeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:w.OptionsSerialized.chunk_size,onChange:P("chunk_size"),min:0,max:0x8000000000000000,label:a("chunkSize")})))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},w);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),"false"!==j&&"false"!==w.IsOriginLinkEnable||(n.BaseURL=""),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.IsPrivate="true"===n.IsPrivate,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(){I("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(5)})).catch((function(e){I("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicy")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:w.Name,onChange:F("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(3)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("finish")))),5===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===O,isFile:!0,isSlave:!0,onClose:function(){return N("")}}),l.a.createElement(dt,{open:"path"===O,isSlave:!0,onClose:function(){return N("")}}))}var Dt=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)}}})),Ft=[{title:"storageBucket",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"finishStep",optional:!1}];function Pt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=Dt(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=l.a.useState(new Set),f=Object(n.a)(v,1)[0],g=Object(r.useState)(""),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)(e.policy?e.policy:{Type:"upyun",Name:"",SecretKey:"",AccessKey:"",BaseURL:"",IsPrivate:"false",DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",MaxSize:"0",OptionsSerialized:{file_type:"",token:""}}),C=Object(n.a)(S,2),j=C[0],x=C[1],_=function(e){return function(a){x(Object(m.a)(Object(m.a)({},j),{},Object(s.a)({},e,a.target.value)))}},z=function(e){return function(a){x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},w=Object(Y.d)(),D=Object(r.useCallback)((function(e,a,t,n){return w(Object($e.S)(e,a,t,n))}),[w]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.policy?a("editUpyunStoragePolicy"):a("addUpyunStoragePolicy")),l.a.createElement(mt.a,{activeStep:u},Ft.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},"\u53ef\u9009")),n=t,f.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.wanSiteURLDes",components:[l.a.createElement("strong",{key:0})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.createUpyunBucketDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.upyun.com/services/create/file/",target:"_blank"})]})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("storageServiceNameDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("storageServiceName")),l.a.createElement(ra.a,{required:!0,value:j.BucketName,onChange:_("BucketName")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("operatorNameDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("operatorName")),l.a.createElement(ra.a,{required:!0,value:j.AccessKey,onChange:_("AccessKey")}))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("operatorPassword")),l.a.createElement(ra.a,{required:!0,value:j.SecretKey,onChange:_("SecretKey")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("upyunCDNDes")),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:j.BaseURL,onChange:_("BaseURL"),required:!0,label:a("bucketCDNDomain")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("upyunOptionalDes"),l.a.createElement("br",null),a("upyunTokenDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j.IsPrivate,onChange:_("IsPrivate"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("tokenEnabled")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("tokenDisabled")})))))),l.a.createElement(rt.a,{in:"true"===j.IsPrivate},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"6")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("upyunTokenSecretDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("upyunTokenSecret")),l.a.createElement(ra.a,{value:j.OptionsSerialized.token,onChange:z("token"),required:"true"===j.IsPrivate})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:j.DirNameRule,onChange:_("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return N("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:j.AutoRename,onChange:_("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===j.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===j.AutoRename,value:j.FileNameRule,onChange:_("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:j.IsOriginLinkEnable,onChange:function(e){"true"!==j.IsPrivate||"true"!==e.target.value?_("IsOriginLinkEnable")(e):D("top","right",a("cannotEnableForTokenProtectedBucket"),"warning")},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(4)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===j.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?x(Object(m.a)(Object(m.a)({},j),{},{MaxSize:"10485760"})):x(Object(m.a)(Object(m.a)({},j),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==j.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:j.MaxSize,onChange:_("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==j.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===j.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):x(Object(m.a)(Object(m.a)({},j),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},j.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==j.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==j.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:j.OptionsSerialized.file_type,onChange:z("file_type")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},j);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.IsPrivate="true"===n.IsPrivate,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(){D("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(5)})).catch((function(e){D("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicy")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:j.Name,onChange:_("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(3)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("finish")))),5===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===O,isFile:!0,onClose:function(){return N("")}}),l.a.createElement(dt,{open:"path"===O,onClose:function(){return N("")}}))}var Rt=t(8087),It=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"},pre:{margin:"24px 0",padding:"12px 18px",overflow:"auto",direction:"ltr",borderRadius:"4px",backgroundColor:"#272c34",color:"#fff"}}}})),Lt=[{title:"storageBucket",optional:!1},{title:"storagePathStep",optional:!1},{title:"sourceLinkStep",optional:!1},{title:"uploadSettingStep",optional:!1},{title:"corsSettingStep",optional:!0},{title:"finishStep",optional:!1}],Tt={"us-east-2":"US East (Ohio)","us-east-1":"US East (N. Virginia)","us-west-1":"US West (N. California)","us-west-2":"US West (Oregon)","af-south-1":"Africa (Cape Town)","ap-east-1":"Asia Pacific (Hong Kong)","ap-south-1":"Asia Pacific (Mumbai)","ap-northeast-3":"Asia Pacific (Osaka-Local)","ap-northeast-2":"Asia Pacific (Seoul)","ap-southeast-1":"Asia Pacific (Singapore)","ap-southeast-2":"Asia Pacific (Sydney)","ap-northeast-1":"Asia Pacific (Tokyo)","ca-central-1":"Canada (Central)","cn-north-1":"China (Beijing)","cn-northwest-1":"China (Ningxia)","eu-central-1":"Europe (Frankfurt)","eu-west-1":"Europe (Ireland)","eu-west-2":"Europe (London)","eu-south-1":"Europe (Milan)","eu-west-3":"Europe (Paris)","eu-north-1":"Europe (Stockholm)","me-south-1":"Middle East (Bahrain)","sa-east-1":"South America (S\xe3o Paulo)"};function Wt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=It(),c=Object(Z.g)(),i=Object(r.useState)(0),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(!1),E=Object(n.a)(p,2),b=E[0],h=E[1],v=Object(r.useState)(!0),f=Object(n.a)(v,2),g=f[0],y=f[1],O=l.a.useState(new Set),N=Object(n.a)(O,2),S=N[0],C=N[1],j=Object(r.useState)(""),x=Object(n.a)(j,2),_=x[0],z=x[1],w=Object(r.useState)("false"),D=Object(n.a)(w,2),F=D[0],P=D[1],R=Object(r.useState)(e.policy?e.policy:{Type:"s3",Name:"",SecretKey:"",AccessKey:"",BaseURL:"",Server:"",IsPrivate:"true",DirNameRule:"uploads/{year}/{month}/{day}",AutoRename:"true",FileNameRule:"{randomkey8}_{originname}",IsOriginLinkEnable:"false",MaxSize:"0",OptionsSerialized:{file_type:"",region:"us-east-2",chunk_size:25<<20,placeholder_with_size:"false"}}),I=Object(n.a)(R,2),L=I[0],T=I[1],W=Object(r.useState)(e.policy?e.policy.ID:0),A=Object(n.a)(W,2),q=A[0],B=A[1],M=function(e){return function(a){T(Object(m.a)(Object(m.a)({},L),{},Object(s.a)({},e,a.target.value)))}},K=function(e){return function(a){T(Object(m.a)(Object(m.a)({},L),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},L.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},U=Object(Y.d)(),H=Object(r.useCallback)((function(e,a,t,n){return U(Object($e.S)(e,a,t,n))}),[U]),G=function(t){t.preventDefault(),h(!0);var n=Object(m.a)({},L);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),"false"===F&&(n.BaseURL=""),n.AutoRename="true"===n.AutoRename,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.IsPrivate="true"===n.IsPrivate,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(t){H("top","right",e.policy?a("policySaved"):a("policyAdded"),"success"),d(4),B(t.data)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)})),h(!1)};return l.a.createElement("div",null,l.a.createElement(pa,{open:g,onClose:function(){return y(!1)},title:a("warning"),msg:a("s3SelfHostWarning")}),l.a.createElement(k.a,{variant:"h6"},e.policy?a("editS3StoragePolicy"):a("addS3StoragePolicy")),l.a.createElement(mt.a,{activeStep:u},Lt.map((function(e,t){var n,r={},c={};return e.optional&&(c.optional=l.a.createElement(k.a,{variant:"caption"},a("optional"))),n=t,S.has(n)&&(r.completed=!1),l.a.createElement(it.a,Object.assign({key:e.title},r),l.a.createElement(ot.a,c,a(e.title)))}))),0===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(1)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.s3BucketDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("bucketName")),l.a.createElement(ra.a,{required:!0,value:L.BucketName,onChange:M("BucketName")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("bucketTypeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:L.IsPrivate,onChange:M("IsPrivate"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("publicAccessDisabled")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("publicAccessEnabled")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.s3EndpointDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("endpoint")),l.a.createElement(ra.a,{value:L.Server,onChange:M("Server")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"4")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("selectRegionDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(Rt.a,{options:Object.keys(Tt),freeSolo:!0,value:L.OptionsSerialized.region,onInputChange:function(e,a){return K("region")({target:{value:a}})},renderOption:function(e){return l.a.createElement(l.a.Fragment,null,Tt[e])},renderInput:function(e){return l.a.createElement(ha.a,Object.assign({style:{width:"100%"}},e))}}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"5")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("useCDN")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:F,onChange:function(e){P(e.target.value)},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("use")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notUse")})))))),l.a.createElement(rt.a,{in:"true"===F},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"6")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("bucketCDNDomain")),l.a.createElement("div",{className:t.form},l.a.createElement(st,{value:L.BaseURL,onChange:M("BaseURL"),required:"true"===F,label:a("bucketCDNDomain")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(6,["true"===F]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterAccessCredentials")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("accessKey")),l.a.createElement(ra.a,{required:!0,inputProps:{pattern:"\\S+",title:a("shouldNotContainSpace")},value:L.AccessKey,onChange:M("AccessKey")}))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("secretKey")),l.a.createElement(ra.a,{required:!0,inputProps:{pattern:"\\S+",title:a("shouldNotContainSpace")},value:L.SecretKey,onChange:M("SecretKey")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(7,["true"===F]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameThePolicyFirst")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("policyName")),l.a.createElement(ra.a,{required:!0,value:L.Name,onChange:M("Name")}))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),1===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(2)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.pathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return z("path")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("pathOfFolderToStoreFiles")),l.a.createElement(ra.a,{required:!0,value:L.DirNameRule,onChange:M("DirNameRule")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.filePathMagicVarDes",components:[l.a.createElement(Sa.a,{key:0,color:"secondary",href:"javascript:void()",onClick:function(){return z("file")}})]})),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:L.AutoRename,onChange:M("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("autoRenameStoredFile")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("keepOriginalFileName")})))),l.a.createElement(rt.a,{in:"true"===L.AutoRename},l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("renameRule")),l.a.createElement(ra.a,{required:"true"===L.AutoRename,value:L.FileNameRule,onChange:M("FileNameRule")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(0)}},a("back")),l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),2===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:function(e){e.preventDefault(),d(3)}},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enableGettingPermanentSourceLink"),l.a.createElement("br",null),a("enableGettingPermanentSourceLinkDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:L.IsOriginLinkEnable,onChange:function(e){"true"!==L.IsPrivate||"true"!==e.target.value?M("IsOriginLinkEnable")(e):H("top","right",a("cannotEnableForPrivateBucket"),"warning")},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("allowed")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("forbidden")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(1)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),3===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:G},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"1")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileSize")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:"0"===L.MaxSize?"false":"true",onChange:function(e){"true"===e.target.value?T(Object(m.a)(Object(m.a)({},L),{},{MaxSize:"10485760"})):T(Object(m.a)(Object(m.a)({},L),{},{MaxSize:"0"}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:"0"!==L.MaxSize},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterSizeLimit")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:L.MaxSize,onChange:M("MaxSize"),min:0,max:0x8000000000000000,label:a("maxSizeOfSingleFile")}))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==L.MaxSize?"3":"2")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("limitFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:""===L.OptionsSerialized.file_type?"false":"true",onChange:function(e){"true"===e.target.value?T(Object(m.a)(Object(m.a)({},L),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},L.OptionsSerialized),{},{file_type:"jpg,png,mp4,zip,rar"})})):T(Object(m.a)(Object(m.a)({},L),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},L.OptionsSerialized),{},{file_type:""})}))},row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("limit")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notLimit")})))))),l.a.createElement(rt.a,{in:""!==L.OptionsSerialized.file_type},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},"0"!==L.MaxSize?"4":"3")),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("enterFileExt")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("extList")),l.a.createElement(ra.a,{value:L.OptionsSerialized.file_type,onChange:K("file_type")})))))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(3,["0"!==L.MaxSize,""!==L.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("chunkSizeLabelS3"),l.a.createElement("br",null),a("chunkSizeDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ya,{value:L.OptionsSerialized.chunk_size,onChange:K("chunk_size"),min:5<<20,max:53687091200,label:a("chunkSize")})))),l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer},l.a.createElement("div",{className:t.stepNumber},Object(Va.i)(4,["0"!==L.MaxSize,""!==L.OptionsSerialized.file_type]))),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("createPlaceholderDes")),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{"aria-label":"gender",name:"gender1",value:L.OptionsSerialized.placeholder_with_size,onChange:K("placeholder_with_size"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("createPlaceholder")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("notCreatePlaceholder")})))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){return d(2)}},a("back"))," ",l.a.createElement(he.a,{disabled:b,type:"submit",variant:"contained",color:"primary"},a("next")))),4===u&&l.a.createElement("form",{className:t.stepContent,onSubmit:G},l.a.createElement("div",{className:t.subStepContainer},l.a.createElement("div",{className:t.stepNumberContainer}),l.a.createElement("div",{className:t.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("ossCORSDes")),l.a.createElement("div",{className:t.form},l.a.createElement(he.a,{disabled:b,color:"secondary",variant:"contained",className:t.button,onClick:function(){return h(!0),void Ye.c.post("/admin/policy/cors",{id:q}).then((function(){H("top","right",a("corsPolicyAdded"),"success"),d(5)})).catch((function(e){H("top","right",e.message,"error")})).then((function(){h(!1)}))},classes:{label:t.viewButtonLabel}},a("letCloudreveHelpMe"))))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"default",className:t.button,onClick:function(){d((function(e){return e+1})),C((function(e){var a=new Set(e.values());return a.add(u),a}))}},a("skip"))," ")),5===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,e.policy?a("policySaved"):a("policyAdded")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("furtherActions"))),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return c.push("/admin/policy")}},a("backToList")))),l.a.createElement(dt,{open:"file"===_,isFile:!0,onClose:function(){return z("")}}),l.a.createElement(dt,{open:"path"===_,onClose:function(){return z("")}}))}var At=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)}}}));function qt(){var e=At(),a=Object(Z.i)().type;return l.a.createElement("div",null,l.a.createElement(ze.a,{square:!0,className:e.content},"local"===a&&l.a.createElement(ft,null),"remote"===a&&l.a.createElement(wt,null),"qiniu"===a&&l.a.createElement(xt,null),"oss"===a&&l.a.createElement(Ct,null),"upyun"===a&&l.a.createElement(Pt,null),"cos"===a&&l.a.createElement(bt,null),"onedrive"===a&&l.a.createElement(Ot,null),"s3"===a&&l.a.createElement(Wt,null)))}function Bt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"policy"}).t,t=Object(r.useState)(!1),c=Object(n.a)(t,2)[1],i=Object(r.useState)(e.policy),o=Object(n.a)(i,2),u=o[0],d=o[1],p=function(e){return function(a){d(Object(m.a)(Object(m.a)({},u),{},Object(s.a)({},e,a.target.value)))}},E=function(e){return function(a){d(Object(m.a)(Object(m.a)({},u),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},u.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}},b=Object(Y.d)(),h=Object(r.useCallback)((function(e,a,t,n){return b(Object($e.S)(e,a,t,n))}),[b]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},a("editPolicy")),l.a.createElement(Ka.a,null,l.a.createElement("form",{onSubmit:function(t){t.preventDefault(),c(!0);var n=Object(m.a)({},u);n.OptionsSerialized=Object(m.a)({},n.OptionsSerialized),n.AutoRename="true"===n.AutoRename,n.IsPrivate="true"===n.IsPrivate,n.IsOriginLinkEnable="true"===n.IsOriginLinkEnable,n.MaxSize=parseInt(n.MaxSize),n.OptionsSerialized.chunk_size=parseInt(n.OptionsSerialized.chunk_size),n.OptionsSerialized.tps_limit=parseFloat(n.OptionsSerialized.tps_limit),n.OptionsSerialized.tps_limit_burst=parseInt(n.OptionsSerialized.tps_limit_burst),n.OptionsSerialized.placeholder_with_size="true"===n.OptionsSerialized.placeholder_with_size,n.OptionsSerialized.file_type=n.OptionsSerialized.file_type.split(","),1===n.OptionsSerialized.file_type.length&&""===n.OptionsSerialized.file_type[0]&&(n.OptionsSerialized.file_type=[]),Ye.c.post("/admin/policy",{policy:n}).then((function(){h("top","right",e.policy?a("policySaved"):a("policyAdded"),"success")})).catch((function(e){h("top","right",e.message,"error")})).then((function(){c(!1)})),c(!1)}},l.a.createElement(Ca.a,{"aria-label":"simple table"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,null,l.a.createElement(ka.a,null,a("setting")),l.a.createElement(ka.a,null,a("value")),l.a.createElement(ka.a,null,a("description")))),l.a.createElement(ja.a,null,l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("id")),l.a.createElement(ka.a,null,u.ID),l.a.createElement(ka.a,null,a("policyID"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("type")),l.a.createElement(ka.a,null,u.Type),l.a.createElement(ka.a,null,a("policyType"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("name")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{required:!0,value:u.Name,onChange:p("Name")}))),l.a.createElement(ka.a,null,a("policyName"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("server")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{value:u.Server,onChange:p("Server")}))),l.a.createElement(ka.a,null,"\u5b58\u50a8\u7aef Endpoint")),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("bucketName")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{value:u.BucketName,onChange:p("BucketName")}))),l.a.createElement(ka.a,null,a("bucketID"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("privateBucket")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ct.a,{required:!0,value:u.IsPrivate,onChange:p("IsPrivate"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("yes")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("no")})))),l.a.createElement(ka.a,null,a("privateBucketDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("resourceRootURL")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{value:u.BaseURL,onChange:p("BaseURL")}))),l.a.createElement(ka.a,null,a("resourceRootURLDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("accessKey")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,rowsMax:10,value:u.AccessKey,onChange:p("AccessKey")}))),l.a.createElement(ka.a,null,a("akDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("secretKey")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,rowsMax:10,value:u.SecretKey,onChange:p("SecretKey")}))),l.a.createElement(ka.a,null,a("secretKey"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("maxSizeBytes")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{type:"number",inputProps:{min:0,step:1},value:u.MaxSize,onChange:p("MaxSize")}))),l.a.createElement(ka.a,null,a("maxSizeBytesDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("autoRename")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ct.a,{required:!0,value:u.AutoRename,onChange:p("AutoRename"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("yes")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("no")})))),l.a.createElement(ka.a,null,a("autoRenameDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("storagePath")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.DirNameRule,onChange:p("DirNameRule")}))),l.a.createElement(ka.a,null,a("storagePathDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("fileName")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.FileNameRule,onChange:p("FileNameRule")}))),l.a.createElement(ka.a,null,a("fileNameDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("allowGetSourceLink")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ct.a,{required:!0,value:u.IsOriginLinkEnable,onChange:p("IsOriginLinkEnable"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("yes")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("no")})))),l.a.createElement(ka.a,null,a("allowGetSourceLinkDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("upyunToken")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.token,onChange:E("token")}))),l.a.createElement(ka.a,null,a("upyunOnly"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("allowedFileExtension")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.file_type,onChange:E("file_type")}))),l.a.createElement(ka.a,null,a("emptyIsNoLimit"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("allowedMimetype")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.mimetype,onChange:E("mimetype")}))),l.a.createElement(ka.a,null,a("qiniuOnly"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("odRedirectURL")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.od_redirect,onChange:E("od_redirect")}))),l.a.createElement(ka.a,null,a("noModificationNeeded"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("odReverseProxy")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.od_proxy,onChange:E("od_proxy")}))),l.a.createElement(ka.a,null,a("odOnly"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("odDriverID")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.od_driver,onChange:E("od_driver")}))),l.a.createElement(ka.a,null,a("odDriverIDDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("s3Region")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.region,onChange:E("region")}))),l.a.createElement(ka.a,null,a("s3Only"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("lanEndpoint")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{multiline:!0,value:u.OptionsSerialized.server_side_endpoint,onChange:E("server_side_endpoint")}))),l.a.createElement(ka.a,null,a("ossOnly"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("chunkSizeBytes")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{type:"number",inputProps:{min:0,step:1},value:u.OptionsSerialized.chunk_size,onChange:E("chunk_size")}))),l.a.createElement(ka.a,null,a("chunkSizeBytesDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("placeHolderWithSize")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ct.a,{required:!0,value:u.OptionsSerialized.placeholder_with_size,onChange:E("placeholder_with_size"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("yes")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("no")})))),l.a.createElement(ka.a,null,a("placeHolderWithSizeDes"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("tps")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{type:"number",inputProps:{step:.1},value:u.OptionsSerialized.tps_limit,onChange:E("tps_limit")}))),l.a.createElement(ka.a,null,a("odOnly"))),l.a.createElement(_a.a,null,l.a.createElement(ka.a,{component:"th",scope:"row"},a("tpsBurst")),l.a.createElement(ka.a,null,l.a.createElement(ta.a,null,l.a.createElement(ra.a,{type:"number",inputProps:{step:1},value:u.OptionsSerialized.tps_limit_burst,onChange:E("tps_limit_burst")}))),l.a.createElement(ka.a,null,a("odOnly"))))),l.a.createElement(he.a,{type:"submit",color:"primary",variant:"contained",style:{margin:8}},a("saveChanges")))))}var Mt=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)}}}));function Kt(){var e=Mt(),a=Object(r.useState)(""),t=Object(n.a)(a,2),c=t[0],i=t[1],o=Object(r.useState)({}),m=Object(n.a)(o,2),s=m[0],u=m[1],d=Object(Z.i)(),p=d.mode,E=d.id,b=Object(Y.d)(),h=Object(r.useCallback)((function(e,a,t,n){return b(Object($e.S)(e,a,t,n))}),[b]);return Object(r.useEffect)((function(){i(""),Ye.c.get("/admin/policy/"+E).then((function(e){e.data.IsOriginLinkEnable=e.data.IsOriginLinkEnable?"true":"false",e.data.AutoRename=e.data.AutoRename?"true":"false",e.data.MaxSize=e.data.MaxSize.toString(),e.data.OptionsSerialized.chunk_size=e.data.OptionsSerialized.chunk_size?e.data.OptionsSerialized.chunk_size.toString():0,e.data.IsPrivate=e.data.IsPrivate?"true":"false",e.data.OptionsSerialized.placeholder_with_size=e.data.OptionsSerialized.placeholder_with_size?"true":"false",e.data.OptionsSerialized.file_type=e.data.OptionsSerialized.file_type?e.data.OptionsSerialized.file_type.join(","):"",e.data.OptionsSerialized.tps_limit=e.data.OptionsSerialized.tps_limit?e.data.OptionsSerialized.tps_limit.toString():0,e.data.OptionsSerialized.tps_limit_burst=e.data.OptionsSerialized.tps_limit_burst?e.data.OptionsSerialized.tps_limit_burst.toString():0,u(e.data),i(e.data.Type)})).catch((function(e){h("top","right",e.message,"error")}))}),[E]),l.a.createElement("div",null,l.a.createElement(ze.a,{square:!0,className:e.content},"guide"===p&&l.a.createElement(l.a.Fragment,null,"local"===c&&l.a.createElement(ft,{policy:s}),"remote"===c&&l.a.createElement(wt,{policy:s}),"qiniu"===c&&l.a.createElement(xt,{policy:s}),"oss"===c&&l.a.createElement(Ct,{policy:s}),"upyun"===c&&l.a.createElement(Pt,{policy:s}),"cos"===c&&l.a.createElement(bt,{policy:s}),"onedrive"===c&&l.a.createElement(Ot,{policy:s}),"s3"===c&&l.a.createElement(Wt,{policy:s})),"pro"===p&&""!==c&&l.a.createElement(Bt,{policy:s})))}var Ut=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},headerRight:{}}})),Ht=[{id:"#",minWidth:50},{id:"name",minWidth:170},{id:"type",label:"\u5b58\u50a8\u7b56\u7565",minWidth:170},{id:"count",minWidth:50,align:"right"},{id:"size",minWidth:100,align:"right"},{id:"action",minWidth:170,align:"right"}];function Gt(){var e=Object(ne.a)("dashboard",{keyPrefix:"group"}).t,a=Object(ne.a)("dashboard").t,t=Ut(),c=Object(r.useState)([]),i=Object(n.a)(c,2),o=i[0],m=i[1],s=Object(r.useState)([]),u=Object(n.a)(s,2),d=u[0],p=u[1],E=Object(r.useState)(1),b=Object(n.a)(E,2),h=b[0],v=b[1],g=Object(r.useState)(10),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)(0),C=Object(n.a)(S,2),j=C[0],k=C[1],x=l.a.useState({}),_=Object(n.a)(x,2),z=_[0],w=_[1],D=Object(Z.h)(),F=Object(Z.g)(),P=new URLSearchParams(Object(Z.h)().search),R=Object(Y.d)(),I=Object(r.useCallback)((function(e,a,t,n){return R(Object($e.S)(e,a,t,n))}),[R]),L=function(){Ye.c.post("/admin/group/list",{page:h,page_size:O,order_by:"id desc"}).then((function(e){m(e.data.items),p(e.data.statics),k(e.data.total),w(e.data.policies)})).catch((function(e){I("top","right",e.message,"error")}))};Object(r.useEffect)((function(){"0"===P.get("code")?I("top","right","\u6388\u6743\u6210\u529f","success"):P.get("msg")&&""!==P.get("msg")&&I("top","right",P.get("msg")+", "+P.get("err"),"warning")}),[D]),Object(r.useEffect)((function(){L()}),[h,O]);return l.a.createElement("div",null,l.a.createElement("div",{className:t.header},l.a.createElement(he.a,{color:"primary",onClick:function(){return F.push("/admin/group/add")},variant:"contained"},e("new")),l.a.createElement("div",{className:t.headerRight},l.a.createElement(he.a,{color:"primary",onClick:function(){return L()},variant:"outlined"},a("policy.refresh")))),l.a.createElement(ze.a,{square:!0,className:t.tableContainer},l.a.createElement(Ka.a,{className:t.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},Ht.map((function(a){return l.a.createElement(ka.a,{key:a.id,align:a.align,style:{minWidth:a.minWidth}},e(a.id))})))),l.a.createElement(ja.a,null,o.map((function(t){return l.a.createElement(_a.a,{hover:!0,key:t.ID},l.a.createElement(ka.a,null,t.ID),l.a.createElement(ka.a,null,t.Name),l.a.createElement(ka.a,null,null!==t.PolicyList&&t.PolicyList.map((function(e,a){var n="";return z[e]&&(n+=z[e].Name),a!==t.PolicyList.length-1&&(n+=" / "),n}))),l.a.createElement(ka.a,{align:"right"},void 0!==d[t.ID]&&d[t.ID].toLocaleString()),l.a.createElement(ka.a,{align:"right"},void 0!==d[t.ID]&&Object(Va.p)(t.MaxStorage)),l.a.createElement(ka.a,{align:"right"},l.a.createElement(Ha.a,{title:a("policy.edit")},l.a.createElement(f.a,{onClick:function(){return F.push("/admin/group/edit/"+t.ID)},size:"small"},l.a.createElement(Ga.a,null))),l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{onClick:function(){return a=t.ID,void Ye.c.delete("/admin/group/"+a).then((function(){L(),I("top","right",e("deleted"),"success")})).catch((function(e){I("top","right",e.message,"error")}));var a},size:"small"},l.a.createElement(za.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,100],component:"div",count:j,rowsPerPage:O,page:h-1,onChangePage:function(e,a){return v(a+1)},onChangeRowsPerPage:function(e){N(e.target.value),v(1)}})))}var Vt=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function Jt(e){var a=Object(ne.a)("dashboard",{keyPrefix:"group"}).t,t=Object(ne.a)("dashboard").t,c=Vt(),i=Object(r.useState)(!1),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(e.group?e.group:{ID:0,Name:"",MaxStorage:"1073741824",ShareEnabled:"true",WebDAVEnabled:"true",SpeedLimit:"0",PolicyList:1,OptionsSerialized:{share_download:"true",aria2_options:"{}",compress_size:"0",decompress_size:"0",source_batch:"0",aria2_batch:"1"}}),E=Object(n.a)(p,2),b=E[0],h=E[1],v=Object(r.useState)({}),f=Object(n.a)(v,2),g=f[0],y=f[1],O=Object(Z.g)(),N=Object(Y.d)(),S=Object(r.useCallback)((function(e,a,t,n){return N(Object($e.S)(e,a,t,n))}),[N]);Object(r.useEffect)((function(){Ye.c.post("/admin/policy/list",{page:1,page_size:1e4,order_by:"id asc",conditions:{}}).then((function(e){var a={};e.data.items.forEach((function(e){a[e.ID]=e.Name})),y(a)})).catch((function(e){S("top","right",e.message,"error")}))}),[]);var C=function(e){return function(a){h(Object(m.a)(Object(m.a)({},b),{},Object(s.a)({},e,a.target.value)))}},j=function(e){return function(a){var t=a.target.checked?"true":"false";h(Object(m.a)(Object(m.a)({},b),{},Object(s.a)({},e,t)))}},x=function(e){return function(a){var t=a.target.checked?"true":"false";h(Object(m.a)(Object(m.a)({},b),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},b.OptionsSerialized),{},Object(s.a)({},e,t))}))}},_=function(e){return function(a){h(Object(m.a)(Object(m.a)({},b),{},{OptionsSerialized:Object(m.a)(Object(m.a)({},b.OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}};return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(t){t.preventDefault();var n=Object(m.a)(Object(m.a)({},b),{},{OptionsSerialized:Object(m.a)({},b.OptionsSerialized)});["ShareEnabled","WebDAVEnabled"].forEach((function(e){n[e]="true"===n[e]})),["archive_download","archive_task","one_time_download","share_download","aria2"].forEach((function(e){void 0!==n.OptionsSerialized[e]&&(n.OptionsSerialized[e]="true"===n.OptionsSerialized[e])})),["MaxStorage","SpeedLimit"].forEach((function(e){n[e]=parseInt(n[e])})),["compress_size","decompress_size","source_batch","aria2_batch"].forEach((function(e){void 0!==n.OptionsSerialized[e]&&(n.OptionsSerialized[e]=parseInt(n.OptionsSerialized[e]))})),n.PolicyList=[parseInt(n.PolicyList)];try{n.OptionsSerialized.aria2_options=JSON.parse(n.OptionsSerialized.aria2_options)}catch(t){return void S("top","right",a("aria2FormatError"),"warning")}d(!0),Ye.c.post("/admin/group",{group:n}).then((function(){O.push("/admin/group"),S("top","right",e.group?a("saved"):a("added"),"success")})).catch((function(e){S("top","right",e.message,"error")})).then((function(){d(!1)}))}},l.a.createElement("div",{className:c.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},0===b.ID&&a("new"),0!==b.ID&&a("editGroup",{name:b.Name})),l.a.createElement("div",{className:c.formContainer},3!==b.ID&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("nameOfGroup")),l.a.createElement(ra.a,{value:b.Name,onChange:C("Name"),required:!0}),l.a.createElement(na.a,{id:"component-helper-text"},a("nameOfGroupDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("storagePolicy")),l.a.createElement(ia.a,{labelId:"demo-mutiple-chip-label",id:"demo-mutiple-chip",value:b.PolicyList,onChange:C("PolicyList"),input:l.a.createElement(ra.a,{id:"select-multiple-chip"})},Object.keys(g).map((function(e){return l.a.createElement(ca.a,{key:e,value:e},g[e])}))),l.a.createElement(na.a,{id:"component-helper-text"},a("storageDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ya,{value:b.MaxStorage,onChange:C("MaxStorage"),min:0,max:0x8000000000000000,label:a("initialStorageQuota"),required:!0})),l.a.createElement(na.a,{id:"component-helper-text"},a("initialStorageQuotaDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ya,{value:b.SpeedLimit,onChange:C("SpeedLimit"),min:0,max:0x8000000000000000,label:a("downloadSpeedLimit"),suffix:"/s",required:!0})),l.a.createElement(na.a,{id:"component-helper-text"},a("downloadSpeedLimitDes"))),3!==b.ID&&l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("bathSourceLinkLimit")),l.a.createElement(ra.a,{multiline:!0,type:"number",inputProps:{min:1,step:1},value:b.OptionsSerialized.source_batch,onChange:_("source_batch")}),l.a.createElement(na.a,{id:"component-helper-text"},a("bathSourceLinkLimitDes")))),3!==b.ID&&l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.ShareEnabled,onChange:j("ShareEnabled")}),label:a("allowCreateShareLink")}),l.a.createElement(na.a,{id:"component-helper-text"},a("allowCreateShareLinkDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.OptionsSerialized.share_download,onChange:x("share_download")}),label:a("allowDownloadShare")}),l.a.createElement(na.a,{id:"component-helper-text"},a("allowDownloadShareDes")))),3!==b.ID&&l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.WebDAVEnabled,onChange:j("WebDAVEnabled")}),label:a("allowWabDAV")}),l.a.createElement(na.a,{id:"component-helper-text"},a("allowWabDAVDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.OptionsSerialized.one_time_download,onChange:x("one_time_download")}),label:a("disableMultipleDownload")}),l.a.createElement(na.a,{id:"component-helper-text"},a("disableMultipleDownloadDes")))),3!==b.ID&&l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.OptionsSerialized.aria2,onChange:x("aria2")}),label:a("allowRemoteDownload")}),l.a.createElement(na.a,{id:"component-helper-text"},a("allowRemoteDownloadDes")))),l.a.createElement(rt.a,{in:"true"===b.OptionsSerialized.aria2},l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("aria2Options")),l.a.createElement(ra.a,{multiline:!0,value:b.OptionsSerialized.aria2_options,onChange:_("aria2_options")}),l.a.createElement(na.a,{id:"component-helper-text"},a("aria2OptionsDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("aria2BatchSize")),l.a.createElement(ra.a,{multiline:!0,type:"number",inputProps:{min:1,step:1},value:b.OptionsSerialized.aria2_batch,onChange:_("aria2_batch")}),l.a.createElement(na.a,{id:"component-helper-text"},a("aria2BatchSizeDes"))))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.OptionsSerialized.archive_download,onChange:x("archive_download")}),label:a("serverSideBatchDownload")}),l.a.createElement(na.a,{id:"component-helper-text"},a("serverSideBatchDownloadDes")))),3!==b.ID&&l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"true"===b.OptionsSerialized.archive_task,onChange:x("archive_task")}),label:a("compressTask")}),l.a.createElement(na.a,{id:"component-helper-text"},a("compressTaskDes")))),l.a.createElement(rt.a,{in:"true"===b.OptionsSerialized.archive_task},l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ya,{value:b.OptionsSerialized.compress_size,onChange:_("compress_size"),min:0,max:0x8000000000000000,label:a("compressSize")})),l.a.createElement(na.a,{id:"component-helper-text"},a("compressSizeDes"))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ya,{value:b.OptionsSerialized.decompress_size,onChange:_("decompress_size"),min:0,max:0x8000000000000000,label:a("decompressSize")})),l.a.createElement(na.a,{id:"component-helper-text"},a("decompressSizeDes")))))),l.a.createElement("div",{className:c.root},l.a.createElement(he.a,{disabled:u,type:"submit",variant:"contained",color:"primary"},t("settings.save")))))}function Xt(){var e=Object(ne.a)("dashboard",{keyPrefix:"group"}).t,a=Object(r.useState)({}),t=Object(n.a)(a,2),c=t[0],i=t[1],o=Object(Z.i)().id,m=Object(Y.d)(),s=Object(r.useCallback)((function(e,a,t,n){return m(Object($e.S)(e,a,t,n))}),[m]);return Object(r.useEffect)((function(){i({}),Ye.c.get("/admin/group/"+o).then((function(a){if(["ShareEnabled","WebDAVEnabled"].forEach((function(e){a.data[e]=a.data[e]?"true":"false"})),["archive_download","archive_task","one_time_download","share_download","aria2"].forEach((function(e){void 0!==a.data.OptionsSerialized[e]&&(a.data.OptionsSerialized[e]=a.data.OptionsSerialized[e]?"true":"false")})),["MaxStorage","SpeedLimit"].forEach((function(e){a.data[e]=a.data[e].toString()})),["compress_size","decompress_size","source_batch","aria2_batch"].forEach((function(e){void 0!==a.data.OptionsSerialized[e]&&(a.data.OptionsSerialized[e]=a.data.OptionsSerialized[e].toString())})),a.data.PolicyList=a.data.PolicyList[0],void 0===a.data.OptionsSerialized.aria2_options)a.data.OptionsSerialized.aria2_options="{}";else try{a.data.OptionsSerialized.aria2_options=JSON.stringify(a.data.OptionsSerialized.aria2_options)}catch(t){return void s("top","right",e("aria2FormatError"),"warning")}i(a.data)})).catch((function(e){s("top","right",e.message,"error")}))}),[o]),l.a.createElement("div",null,void 0!==c.ID&&l.a.createElement(Jt,{group:c}))}var Qt=t(7091),$t=t(7154),Yt=t(7160),Zt=t(8072),en=t(8073);function an(e){var a=e.setFilter,t=e.setSearch,c=e.open,i=e.onClose,o=Object(ne.a)("dashboard",{keyPrefix:"user"}).t,u=Object(ne.a)("common").t,d=Object(r.useState)({group_id:"all",status:"all"}),p=Object(n.a)(d,2),E=p[0],b=p[1],h=Object(r.useState)([]),v=Object(n.a)(h,2),f=v[0],g=v[1],y=Object(r.useState)(""),O=Object(n.a)(y,2),N=O[0],S=O[1],C=Object(Y.d)(),j=Object(r.useCallback)((function(e,a,t,n){return C(Object($e.S)(e,a,t,n))}),[C]),k=function(e){return function(a){b(Object(m.a)(Object(m.a)({},E),{},Object(s.a)({},e,a.target.value)))}};Object(r.useEffect)((function(){Ye.c.get("/admin/groups").then((function(e){g(e.data)})).catch((function(e){j("top","right",e.message,"error")}))}),[]);return l.a.createElement(Ne.a,{open:c,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"xs"},l.a.createElement(ke.a,{id:"alert-dialog-title"},o("filterCondition")),l.a.createElement(Ce.a,null,l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{id:"demo-simple-select-label"},o("group")),l.a.createElement(ia.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:E.group_id,onChange:k("group_id")},l.a.createElement(ca.a,{value:"all"},o("all")),f.map((function(e){return 3===e.ID?null:l.a.createElement(ca.a,{key:e.ID,value:e.ID.toString()},e.Name)})))),l.a.createElement(ta.a,{fullWidth:!0,style:{marginTop:16}},l.a.createElement(la.a,{id:"demo-simple-select-label"},o("userStatus")),l.a.createElement(ia.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:E.status,onChange:k("status")},l.a.createElement(ca.a,{value:"all"},o("all")),l.a.createElement(ca.a,{value:"0"},o("active")),l.a.createElement(ca.a,{value:"1"},o("notActivated")),l.a.createElement(ca.a,{value:"2"},o("banned")),l.a.createElement(ca.a,{value:"3"},o("bannedBySys")))),l.a.createElement(ta.a,{fullWidth:!0,style:{marginTop:16}},l.a.createElement(ha.a,{value:N,onChange:function(e){return S(e.target.value)},id:"standard-basic",label:o("searchNickUserName")}))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:i,color:"default"},u("cancel")),l.a.createElement(he.a,{onClick:function(){var e={};Object.keys(E).forEach((function(a){"all"!==E[a]&&(e[a]=E[a])})),a(e),t(""!==N?{nick:N,email:N}:{}),i()},color:"primary"},o("apply"))))}var tn=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},headerRight:{},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(S.i)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function nn(){var e=Object(ne.a)("dashboard",{keyPrefix:"user"}).t,a=Object(ne.a)("dashboard").t,t=tn(),c=Object(r.useState)([]),i=Object(n.a)(c,2),o=i[0],s=i[1],u=Object(r.useState)(1),d=Object(n.a)(u,2),p=d[0],E=d[1],b=Object(r.useState)(10),h=Object(n.a)(b,2),v=h[0],g=h[1],y=Object(r.useState)(0),O=Object(n.a)(y,2),N=O[0],S=O[1],x=Object(r.useState)({}),_=Object(n.a)(x,2),z=_[0],w=_[1],D=Object(r.useState)({}),F=Object(n.a)(D,2),P=F[0],R=F[1],I=Object(r.useState)(["id","desc"]),L=Object(n.a)(I,2),T=L[0],W=L[1],A=Object(r.useState)(!1),q=Object(n.a)(A,2),B=q[0],M=q[1],K=Object(r.useState)([]),U=Object(n.a)(K,2),H=U[0],G=U[1],V=Object(r.useState)(!1),J=Object(n.a)(V,2),X=J[0],Q=J[1],$=Object(Z.g)(),ee=Object(C.a)(),ae=Object(Y.d)(),te=Object(r.useCallback)((function(e,a,t,n){return ae(Object($e.S)(e,a,t,n))}),[ae]),re=function(){Ye.c.post("/admin/user/list",{page:p,page_size:v,order_by:T.join(" "),conditions:z,searches:P}).then((function(e){s(e.data.items),S(e.data.total),G([])})).catch((function(e){te("top","right",e.message,"error")}))};Object(r.useEffect)((function(){re()}),[p,v,T,z,P]);var le=function(e){return-1!==H.indexOf(e)};return l.a.createElement("div",null,l.a.createElement(an,{filter:z,open:B,onClose:function(){return M(!1)},setSearch:R,setFilter:w}),l.a.createElement("div",{className:t.header},l.a.createElement(he.a,{style:{alignSelf:"center"},color:"primary",onClick:function(){return $.push("/admin/user/add")},variant:"contained"},e("new")),l.a.createElement("div",{className:t.headerRight},l.a.createElement(Ha.a,{title:e("filter")},l.a.createElement(f.a,{style:{marginRight:8},onClick:function(){return M(!0)}},l.a.createElement(Qt.a,{color:"secondary",variant:"dot",invisible:0===Object.keys(P).length&&0===Object.keys(z).length},l.a.createElement(Zt.a,null)))),l.a.createElement(he.a,{color:"primary",onClick:function(){return re()},variant:"outlined"},a("policy.refresh")))),l.a.createElement(ze.a,{square:!0,className:t.tableContainer},H.length>0&&l.a.createElement(j.a,{className:t.highlight},l.a.createElement(k.a,{style:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1"},e("selectedObject",{num:H.length})),l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{onClick:function(){Q(!0),Ye.c.post("/admin/user/delete",{id:H}).then((function(){re(),te("top","right",e("deleted"),"success")})).catch((function(e){te("top","right",e.message,"error")})).then((function(){Q(!1)}))},disabled:X,"aria-label":"delete"},l.a.createElement(za.a,null)))),l.a.createElement(Ka.a,{className:t.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{indeterminate:H.length>0&&H.length<o.length,checked:o.length>0&&H.length===o.length,onChange:function(e){if(e.target.checked){var a=o.map((function(e){return e.ID}));G(a)}else G([])},inputProps:{"aria-label":"select all desserts"}})),l.a.createElement(ka.a,{style:{minWidth:59}},l.a.createElement(Yt.a,{active:"id"===T[0],direction:T[1],onClick:function(){return W(["id","asc"===T[1]?"desc":"asc"])}},a("node.#"),"id"===T[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===T[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:120}},l.a.createElement(Yt.a,{active:"nick"===T[0],direction:T[1],onClick:function(){return W(["nick","asc"===T[1]?"desc":"asc"])}},e("nick"),"nick"===T[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===T[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:170}},l.a.createElement(Yt.a,{active:"email"===T[0],direction:T[1],onClick:function(){return W(["email","asc"===T[1]?"desc":"asc"])}},e("email"),"email"===T[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===T[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:70}},e("group")),l.a.createElement(ka.a,{style:{minWidth:50}},e("status")),l.a.createElement(ka.a,{align:"right",style:{minWidth:80}},l.a.createElement(Yt.a,{active:"storage"===T[0],direction:T[1],onClick:function(){return W(["storage","asc"===T[1]?"desc":"asc"])}},e("usedStorage"),"storage"===T[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===T[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:100}},a("policy.actions")))),l.a.createElement(ja.a,null,o.map((function(t){return l.a.createElement(_a.a,{hover:!0,key:t.ID,role:"checkbox",selected:le(t.ID)},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{onClick:function(e){return function(e,a){var t=H.indexOf(a),n=[];-1===t?n=n.concat(H,a):0===t?n=n.concat(H.slice(1)):t===H.length-1?n=n.concat(H.slice(0,-1)):t>0&&(n=n.concat(H.slice(0,t),H.slice(t+1))),G(n)}(0,t.ID)},checked:le(t.ID)})),l.a.createElement(ka.a,null,t.ID),l.a.createElement(ka.a,null,t.Nick),l.a.createElement(ka.a,null,t.Email),l.a.createElement(ka.a,null,l.a.createElement(Sa.a,{href:"/admin/group/edit/"+t.Group.ID},t.Group.Name)),l.a.createElement(ka.a,null,0===t.Status&&l.a.createElement(k.a,{style:{color:ee.palette.success.main},variant:"body2"},e("active")),1===t.Status&&l.a.createElement(k.a,{color:"textSecondary",variant:"body2"},e("notActivated")),2===t.Status&&l.a.createElement(k.a,{color:"error",variant:"body2"},e("banned")),3===t.Status&&l.a.createElement(k.a,{color:"error",variant:"body2"},e("bannedBySys"))),l.a.createElement(ka.a,{align:"right"},Object(Va.p)(t.Storage)),l.a.createElement(ka.a,null,l.a.createElement(Ha.a,{title:a("node.edit")},l.a.createElement(f.a,{onClick:function(){return $.push("/admin/user/edit/"+t.ID)},size:"small"},l.a.createElement(Ga.a,null))),l.a.createElement(Ha.a,{title:e("toggleBan")},l.a.createElement(f.a,{disabled:X,onClick:function(){return e=t.ID,Q(!0),void Ye.c.patch("/admin/user/ban/"+e).then((function(a){s(o.map((function(t){return t.ID===e?Object(m.a)(Object(m.a)({},t),{},{Status:a.data}):t})))})).catch((function(e){te("top","right",e.message,"error")})).then((function(){Q(!1)}));var e},size:"small"},l.a.createElement(en.a,null))),l.a.createElement(Ha.a,{title:a("node.delete")},l.a.createElement(f.a,{disabled:X,onClick:function(){return e=t.ID,Q(!0),void Ye.c.post("/admin/user/delete",{id:[e]}).then((function(){re(),te("top","right","\u7528\u6237\u5df2\u5220\u9664","success")})).catch((function(e){te("top","right",e.message,"error")})).then((function(){Q(!1)}));var e},size:"small"},l.a.createElement(za.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,100],component:"div",count:N,rowsPerPage:v,page:p-1,onChangePage:function(e,a){return E(a+1)},onChangeRowsPerPage:function(e){g(e.target.value),E(1)}})))}var rn=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function ln(e){var a=Object(ne.a)("dashboard",{keyPrefix:"user"}).t,t=Object(ne.a)("dashboard").t,c=rn(),i=Object(r.useState)(!1),o=Object(n.a)(i,2),u=o[0],d=o[1],p=Object(r.useState)(e.user?e.user:{ID:0,Email:"",Nick:"",Password:"",Status:"0",GroupID:"2"}),E=Object(n.a)(p,2),b=E[0],h=E[1],v=Object(r.useState)([]),f=Object(n.a)(v,2),g=f[0],y=f[1],O=Object(Z.g)(),N=Object(Y.d)(),S=Object(r.useCallback)((function(e,a,t,n){return N(Object($e.S)(e,a,t,n))}),[N]);Object(r.useEffect)((function(){Ye.c.get("/admin/groups").then((function(e){y(e.data)})).catch((function(e){S("top","right",e.message,"error")}))}),[]);var C=function(e){return function(a){h(Object(m.a)(Object(m.a)({},b),{},Object(s.a)({},e,a.target.value)))}};return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(t){t.preventDefault();var n=Object(m.a)({},b);["Status","GroupID","Score"].forEach((function(e){n[e]=parseInt(n[e])})),d(!0),Ye.c.post("/admin/user",{user:n,password:n.Password}).then((function(){O.push("/admin/user"),S("top","right",e.user?a("saved"):a("added"),"success")})).catch((function(e){S("top","right",e.message,"error")})).then((function(){d(!1)}))}},l.a.createElement("div",{className:c.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},0===b.ID&&a("new"),0!==b.ID&&a("editUser",{nick:b.Nick})),l.a.createElement("div",{className:c.formContainer},l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("email")),l.a.createElement(ra.a,{value:b.Email,type:"email",onChange:C("Email"),required:!0}))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("nick")),l.a.createElement(ra.a,{value:b.Nick,onChange:C("Nick"),required:!0}))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("password")),l.a.createElement(ra.a,{type:"password",value:b.Password,onChange:C("Password"),required:0===b.ID}),l.a.createElement(na.a,{id:"component-helper-text"},0!==b.ID&&a("passwordDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("group")),l.a.createElement(ia.a,{value:b.GroupID,onChange:C("GroupID"),required:!0},g.map((function(e){return 3===e.ID?null:l.a.createElement(ca.a,{key:e.ID,value:e.ID.toString()},e.Name)}))),l.a.createElement(na.a,{id:"component-helper-text"},a("groupDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("status")),l.a.createElement(ia.a,{value:b.Status,onChange:C("Status"),required:!0},l.a.createElement(ca.a,{value:"0"},a("active")),l.a.createElement(ca.a,{value:"1"},a("notActivated")),l.a.createElement(ca.a,{value:"2"},a("banned")),l.a.createElement(ca.a,{value:"3"},a("bannedBySys"))))))),l.a.createElement("div",{className:c.root},l.a.createElement(he.a,{disabled:u,type:"submit",variant:"contained",color:"primary"},t("settings.save")))))}function cn(){var e=Object(r.useState)({}),a=Object(n.a)(e,2),t=a[0],c=a[1],i=Object(Z.i)().id,o=Object(Y.d)(),m=Object(r.useCallback)((function(e,a,t,n){return o(Object($e.S)(e,a,t,n))}),[o]);return Object(r.useEffect)((function(){c({}),Ye.c.get("/admin/user/"+i).then((function(e){["Status","GroupID"].forEach((function(a){e.data[a]=e.data[a].toString()})),c(e.data)})).catch((function(e){m("top","right",e.message,"error")}))}),[i]),l.a.createElement("div",null,void 0!==t.ID&&l.a.createElement(ln,{user:t}))}var on=t(8074);function mn(e){var a=e.setFilter,t=e.setSearch,c=e.open,i=e.onClose,o=Object(ne.a)("dashboard",{keyPrefix:"file"}).t,u=Object(ne.a)("dashboard").t,d=Object(ne.a)("common").t,p=Object(r.useState)({policy_id:"all",user_id:""}),E=Object(n.a)(p,2),b=E[0],h=E[1],v=Object(r.useState)([]),f=Object(n.a)(v,2),g=f[0],y=f[1],O=Object(r.useState)(""),N=Object(n.a)(O,2),S=N[0],C=N[1],j=Object(Y.d)(),k=Object(r.useCallback)((function(e,a,t,n){return j(Object($e.S)(e,a,t,n))}),[j]),x=function(e){return function(a){h(Object(m.a)(Object(m.a)({},b),{},Object(s.a)({},e,a.target.value)))}};Object(r.useEffect)((function(){Ye.c.post("/admin/policy/list",{page:1,page_size:1e4,order_by:"id asc",conditions:{}}).then((function(e){y(e.data.items)})).catch((function(e){k("top","right",e.message,"error")}))}),[]);return l.a.createElement(Ne.a,{open:c,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"xs"},l.a.createElement(ke.a,{id:"alert-dialog-title"},u("user.filterCondition")),l.a.createElement(Ce.a,null,l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{id:"demo-simple-select-label"},o("storagePolicy")),l.a.createElement(ia.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:b.policy_id,onChange:x("policy_id")},l.a.createElement(ca.a,{value:"all"},u("user.all")),g.map((function(e){return l.a.createElement(ca.a,{key:e.ID,value:e.ID.toString()},e.Name)})))),l.a.createElement(ta.a,{fullWidth:!0,style:{marginTop:16}},l.a.createElement(ha.a,{value:b.user_id,onChange:x("user_id"),id:"standard-basic",label:o("uploaderID")})),l.a.createElement(ta.a,{fullWidth:!0,style:{marginTop:16}},l.a.createElement(ha.a,{value:S,onChange:function(e){return C(e.target.value)},id:"standard-basic",label:o("searchFileName")}))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:i,color:"default"},d("cancel")),l.a.createElement(he.a,{onClick:function(){var e={};Object.keys(b).forEach((function(a){"all"!==b[a]&&""!==b[a]&&(e[a]=b[a])})),a(e),t(""!==S?{name:S}:{}),i()},color:"primary"},u("user.apply"))))}var sn=t(53),un=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},headerRight:{},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(S.i)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},disabledBadge:{marginLeft:e.spacing(1),height:18}}}));function dn(){var e=Object(ne.a)("dashboard",{keyPrefix:"file"}).t,a=Object(ne.a)("dashboard").t,t=un(),c=Object(r.useState)([]),i=Object(n.a)(c,2),o=i[0],m=i[1],s=Object(r.useState)(1),u=Object(n.a)(s,2),d=u[0],p=u[1],E=Object(r.useState)(10),b=Object(n.a)(E,2),h=b[0],v=b[1],g=Object(r.useState)(0),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)({}),C=Object(n.a)(S,2),x=C[0],_=C[1],z=Object(r.useState)({}),w=Object(n.a)(z,2),D=w[0],F=w[1],P=Object(r.useState)({}),R=Object(n.a)(P,2),I=R[0],L=R[1],T=Object(r.useState)(["id","desc"]),W=Object(n.a)(T,2),A=W[0],q=W[1],B=Object(r.useState)(!1),M=Object(n.a)(B,2),K=M[0],U=M[1],H=Object(r.useState)([]),G=Object(n.a)(H,2),V=G[0],J=G[1],X=Object(r.useState)(!1),Q=Object(n.a)(X,2),$=Q[0],ee=Q[1],ae=Object(Z.g)(),te=Object(Y.d)(),re=Object(r.useCallback)((function(e,a,t,n){return te(Object($e.S)(e,a,t,n))}),[te]),le=function(){Ye.c.post("/admin/file/list",{page:d,page_size:h,order_by:A.join(" "),conditions:x,searches:I}).then((function(e){m(e.data.items),N(e.data.total),J([]),F(e.data.users)})).catch((function(e){re("top","right",e.message,"error")}))};Object(r.useEffect)((function(){le()}),[d,h,A,x,I]);var ce=function(a){return function(){ee(!0),Ye.c.post("/admin/file/delete",{id:V,force:a}).then((function(){le(),re("top","right",e("deleteAsync"),"success")})).catch((function(e){re("top","right",e.message,"error")})).then((function(){ee(!1)}))}},ie=function(e){return-1!==V.indexOf(e)};return l.a.createElement("div",null,l.a.createElement(mn,{filter:x,open:K,onClose:function(){return U(!1)},setSearch:L,setFilter:_}),l.a.createElement("div",{className:t.header},l.a.createElement(he.a,{color:"primary",onClick:function(){return ae.push("/admin/file/import")},variant:"contained",style:{alignSelf:"center"}},e("import")),l.a.createElement("div",{className:t.headerRight},l.a.createElement(Ha.a,{title:a("user.filter")},l.a.createElement(f.a,{style:{marginRight:8},onClick:function(){return U(!0)}},l.a.createElement(Qt.a,{color:"secondary",variant:"dot",invisible:0===Object.keys(I).length&&0===Object.keys(x).length},l.a.createElement(Zt.a,null)))),l.a.createElement(he.a,{color:"primary",onClick:function(){return le()},variant:"outlined"},a("policy.refresh")))),l.a.createElement(ze.a,{square:!0,className:t.tableContainer},V.length>0&&l.a.createElement(j.a,{className:t.highlight},l.a.createElement(k.a,{style:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1"},a("user.selectedObjects",{num:V.length})),l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{onClick:ce(!1),disabled:$,"aria-label":"delete"},l.a.createElement(za.a,null))),l.a.createElement(Ha.a,{title:e("forceDelete")},l.a.createElement(f.a,{onClick:ce(!0),disabled:$,"aria-label":"delete"},l.a.createElement(on.a,null)))),l.a.createElement(Ka.a,{className:t.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{indeterminate:V.length>0&&V.length<o.length,checked:o.length>0&&V.length===o.length,onChange:function(e){if(e.target.checked){var a=o.map((function(e){return e.ID}));J(a)}else J([])},inputProps:{"aria-label":"select all desserts"}})),l.a.createElement(ka.a,{style:{minWidth:59}},l.a.createElement(Yt.a,{active:"id"===A[0],direction:A[1],onClick:function(){return q(["id","asc"===A[1]?"desc":"asc"])}},"#","id"===A[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===A[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:250}},l.a.createElement(Yt.a,{active:"name"===A[0],direction:A[1],onClick:function(){return q(["name","asc"===A[1]?"desc":"asc"])}},e("name"),"name"===A[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===A[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{align:"right",style:{minWidth:70}},l.a.createElement(Yt.a,{active:"size"===A[0],direction:A[1],onClick:function(){return q(["size","asc"===A[1]?"desc":"asc"])}},e("size"),"size"===A[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===A[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:120}},e("uploader")),l.a.createElement(ka.a,{style:{minWidth:150}},e("createdAt")),l.a.createElement(ka.a,{style:{minWidth:100}},a("policy.actions")))),l.a.createElement(ja.a,null,o.map((function(n){return l.a.createElement(_a.a,{hover:!0,key:n.ID,role:"checkbox",selected:ie(n.ID)},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{onClick:function(e){return function(e,a){var t=V.indexOf(a),n=[];-1===t?n=n.concat(V,a):0===t?n=n.concat(V.slice(1)):t===V.length-1?n=n.concat(V.slice(0,-1)):t>0&&(n=n.concat(V.slice(0,t),V.slice(t+1))),J(n)}(0,n.ID)},checked:ie(n.ID)})),l.a.createElement(ka.a,null,n.ID),l.a.createElement(ka.a,null,l.a.createElement(Sa.a,{target:"_blank",color:"inherit",href:"/api/v3/admin/file/preview/"+n.ID},n.Name,n.UploadSessionID&&l.a.createElement(ve.a,{className:t.disabledBadge,size:"small",label:e("uploading")}))),l.a.createElement(ka.a,{align:"right"},Object(Va.p)(n.Size)),l.a.createElement(ka.a,null,l.a.createElement(Sa.a,{href:"/admin/user/edit/"+n.UserID},D[n.UserID]?D[n.UserID].Nick:e("unknownUploader"))),l.a.createElement(ka.a,null,Object(sn.a)(n.CreatedAt,"YYYY-MM-DD H:mm:ss")),l.a.createElement(ka.a,null,l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{disabled:$,onClick:function(){return a=n.ID,ee(!0),void Ye.c.post("/admin/file/delete",{id:[a]}).then((function(){le(),re("top","right",e("deleteAsync"),"success")})).catch((function(e){re("top","right",e.message,"error")})).then((function(){ee(!1)}));var a},size:"small"},l.a.createElement(za.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,50,100],component:"div",count:O,rowsPerPage:h,page:d-1,onChangePage:function(e,a){return p(a+1)},onChangeRowsPerPage:function(e){v(e.target.value),p(1)}})))}function pn(e){var a=e.setFilter,t=e.setSearch,c=e.open,i=e.onClose,o=Object(ne.a)("dashboard",{keyPrefix:"share"}).t,u=Object(ne.a)("dashboard").t,d=Object(ne.a)("common").t,p=Object(r.useState)({is_dir:"all",user_id:""}),E=Object(n.a)(p,2),b=E[0],h=E[1],v=Object(r.useState)(""),f=Object(n.a)(v,2),g=f[0],y=f[1],O=function(e){return function(a){h(Object(m.a)(Object(m.a)({},b),{},Object(s.a)({},e,a.target.value)))}};return l.a.createElement(Ne.a,{open:c,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"xs"},l.a.createElement(ke.a,{id:"alert-dialog-title"},u("user.filterCondition")),l.a.createElement(Ce.a,null,l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{id:"demo-simple-select-label"},o("srcType")),l.a.createElement(ia.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:b.is_dir,onChange:O("is_dir")},l.a.createElement(ca.a,{value:"all"},u("user.all")),l.a.createElement(ca.a,{value:"1"},o("folder")),l.a.createElement(ca.a,{value:"0"},o("file")))),l.a.createElement(ta.a,{fullWidth:!0,style:{marginTop:16}},l.a.createElement(ha.a,{value:b.user_id,onChange:O("user_id"),id:"standard-basic",label:u("file.uploaderID")})),l.a.createElement(ta.a,{fullWidth:!0,style:{marginTop:16}},l.a.createElement(ha.a,{value:g,onChange:function(e){return y(e.target.value)},id:"standard-basic",label:u("file.searchFileName")}))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:i,color:"default"},d("cancel")),l.a.createElement(he.a,{onClick:function(){var e={};Object.keys(b).forEach((function(a){"all"!==b[a]&&""!==b[a]&&(e[a]=b[a])})),a(e),t(""!==g?{source_name:g}:{}),i()},color:"primary"},d("ok"))))}var En=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},headerRight:{},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(S.i)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function bn(){var e=Object(ne.a)("dashboard",{keyPrefix:"share"}).t,a=Object(ne.a)("dashboard").t,t=En(),c=Object(r.useState)([]),i=Object(n.a)(c,2),o=i[0],m=i[1],s=Object(r.useState)(1),u=Object(n.a)(s,2),d=u[0],p=u[1],E=Object(r.useState)(10),b=Object(n.a)(E,2),h=b[0],v=b[1],g=Object(r.useState)(0),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)({}),C=Object(n.a)(S,2),x=C[0],_=C[1],z=Object(r.useState)({}),w=Object(n.a)(z,2),D=w[0],F=w[1],P=Object(r.useState)({}),R=Object(n.a)(P,2),I=R[0],L=R[1],T=Object(r.useState)({}),W=Object(n.a)(T,2),A=W[0],q=W[1],B=Object(r.useState)(["id","desc"]),M=Object(n.a)(B,2),K=M[0],U=M[1],H=Object(r.useState)(!1),G=Object(n.a)(H,2),V=G[0],J=G[1],X=Object(r.useState)([]),Q=Object(n.a)(X,2),$=Q[0],Z=Q[1],ee=Object(r.useState)(!1),ae=Object(n.a)(ee,2),te=ae[0],re=ae[1],le=Object(Y.d)(),ce=Object(r.useCallback)((function(e,a,t,n){return le(Object($e.S)(e,a,t,n))}),[le]),ie=function(){Ye.c.post("/admin/share/list",{page:d,page_size:h,order_by:K.join(" "),conditions:x,searches:A}).then((function(e){F(e.data.users),L(e.data.ids),m(e.data.items),N(e.data.total),Z([])})).catch((function(e){ce("top","right",e.message,"error")}))};Object(r.useEffect)((function(){ie()}),[d,h,K,x,A]);var oe=function(e){return-1!==$.indexOf(e)};return l.a.createElement("div",null,l.a.createElement(pn,{filter:x,open:V,onClose:function(){return J(!1)},setSearch:q,setFilter:_}),l.a.createElement("div",{className:t.header},l.a.createElement("div",{className:t.headerRight},l.a.createElement(Ha.a,{title:a("user.filter")},l.a.createElement(f.a,{style:{marginRight:8},onClick:function(){return J(!0)}},l.a.createElement(Qt.a,{color:"secondary",variant:"dot",invisible:0===Object.keys(A).length&&0===Object.keys(x).length},l.a.createElement(Zt.a,null)))),l.a.createElement(he.a,{color:"primary",onClick:function(){return ie()},variant:"outlined"},a("policy.refresh")))),l.a.createElement(ze.a,{square:!0,className:t.tableContainer},$.length>0&&l.a.createElement(j.a,{className:t.highlight},l.a.createElement(k.a,{style:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1"},a("user.selectedObjects",{num:$.length})),l.a.createElement(Ha.a,{title:a("node.delete")},l.a.createElement(f.a,{onClick:function(){re(!0),Ye.c.post("/admin/share/delete",{id:$}).then((function(){ie(),ce("top","right",e("deleted"),"success")})).catch((function(e){ce("top","right",e.message,"error")})).then((function(){re(!1)}))},disabled:te,"aria-label":"delete"},l.a.createElement(za.a,null)))),l.a.createElement(Ka.a,{className:t.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{indeterminate:$.length>0&&$.length<o.length,checked:o.length>0&&$.length===o.length,onChange:function(e){if(e.target.checked){var a=o.map((function(e){return e.ID}));Z(a)}else Z([])},inputProps:{"aria-label":"select all desserts"}})),l.a.createElement(ka.a,{style:{minWidth:10}},l.a.createElement(Yt.a,{active:"id"===K[0],direction:K[1],onClick:function(){return U(["id","asc"===K[1]?"desc":"asc"])}},"#","id"===K[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===K[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:200}},l.a.createElement(Yt.a,{active:"source_name"===K[0],direction:K[1],onClick:function(){return U(["source_name","asc"===K[1]?"desc":"asc"])}},e("objectName"),"source_name"===K[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===K[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:70}},a("policy.type")),l.a.createElement(ka.a,{style:{minWidth:100},align:"right"},l.a.createElement(Yt.a,{active:"views"===K[0],direction:K[1],onClick:function(){return U(["views","asc"===K[1]?"desc":"asc"])}},e("views"),"views"===K[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===K[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:100},align:"right"},l.a.createElement(Yt.a,{active:"downloads"===K[0],direction:K[1],onClick:function(){return U(["downloads","asc"===K[1]?"desc":"asc"])}},e("downloads"),"downloads"===K[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===K[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:120}},e("autoExpire")),l.a.createElement(ka.a,{style:{minWidth:120}},e("owner")),l.a.createElement(ka.a,{style:{minWidth:150}},e("createdAt")),l.a.createElement(ka.a,{style:{minWidth:100}},a("policy.actions")))),l.a.createElement(ja.a,null,o.map((function(t){return l.a.createElement(_a.a,{hover:!0,key:t.ID,role:"checkbox",selected:oe(t.ID)},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{onClick:function(e){return function(e,a){var t=$.indexOf(a),n=[];-1===t?n=n.concat($,a):0===t?n=n.concat($.slice(1)):t===$.length-1?n=n.concat($.slice(0,-1)):t>0&&(n=n.concat($.slice(0,t),$.slice(t+1))),Z(n)}(0,t.ID)},checked:oe(t.ID)})),l.a.createElement(ka.a,null,t.ID),l.a.createElement(ka.a,{style:{wordBreak:"break-all"}},l.a.createElement(Sa.a,{target:"_blank",color:"inherit",href:"/s/"+I[t.ID]+(""===t.Password?"":"?password="+t.Password)},t.SourceName)),l.a.createElement(ka.a,null,""===t.Password?e("public"):e("private")),l.a.createElement(ka.a,{align:"right"},t.Views),l.a.createElement(ka.a,{align:"right"},t.Downloads),l.a.createElement(ka.a,null,t.RemainDownloads>-1&&e("afterNDownloads",{num:t.RemainDownloads}),-1===t.RemainDownloads&&e("none")),l.a.createElement(ka.a,null,l.a.createElement(Sa.a,{href:"/admin/user/edit/"+t.UserID},D[t.UserID]?D[t.UserID].Nick:a("file.unknownUploader"))),l.a.createElement(ka.a,null,Object(sn.a)(t.CreatedAt)),l.a.createElement(ka.a,null,l.a.createElement(Ha.a,{title:a("node.delete")},l.a.createElement(f.a,{disabled:te,onClick:function(){return a=t.ID,re(!0),void Ye.c.post("/admin/share/delete",{id:[a]}).then((function(){ie(),ce("top","right",e("deleted"),"success")})).catch((function(e){ce("top","right",e.message,"error")})).then((function(){re(!1)}));var a},size:"small"},l.a.createElement(za.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,50,100],component:"div",count:O,rowsPerPage:h,page:d-1,onChangePage:function(e,a){return p(a+1)},onChangeRowsPerPage:function(e){v(e.target.value),p(1)}})))}var hn=t(47),vn=Object(c.a)((function(e){return{}}));function fn(e){var a=Object(ne.a)("dashboard",{keyPrefix:"task"}).t,t=Object(ne.a)("common").t;vn();return l.a.createElement(Ne.a,{open:e.open,onClose:e.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},l.a.createElement(ke.a,{id:"alert-dialog-title"},a("howToConfigAria2")),l.a.createElement(Ce.a,null,l.a.createElement(je.a,{id:"alert-dialog-description"},a("aria2Des"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"task.masterAria2Des",components:[l.a.createElement(Sa.a,{component:hn.a,to:"/admin/node/edit/1",key:0})]})),l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"task.slaveAria2Des",components:[l.a.createElement(Sa.a,{component:hn.a,to:"/admin/node/add",key:0})]}))),l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"task.editGroupDes",components:[l.a.createElement(Sa.a,{component:hn.a,to:"/admin/group",key:0})]}))),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:e.onClose,color:"primary",autoFocus:!0},t("close"))))}var gn=t(7773),yn=t.n(gn),On=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},headerRight:{},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(S.i)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function Nn(){var e=Object(ne.a)("dashboard",{keyPrefix:"task"}).t,a=Object(ne.a)("dashboard").t,t=On(),c=Object(r.useState)([]),i=Object(n.a)(c,2),o=i[0],m=i[1],s=Object(r.useState)(1),u=Object(n.a)(s,2),d=u[0],p=u[1],E=Object(r.useState)(10),b=Object(n.a)(E,2),h=b[0],v=b[1],g=Object(r.useState)(0),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)({}),C=Object(n.a)(S,2),x=C[0],_=C[1],z=Object(r.useState)({}),w=Object(n.a)(z,2),D=w[0],F=w[1],P=Object(r.useState)({}),R=Object(n.a)(P,2),I=R[0],L=R[1],T=Object(r.useState)(["id","desc"]),W=Object(n.a)(T,2),A=W[0],q=W[1],B=Object(r.useState)(!1),M=Object(n.a)(B,2),K=M[0],U=M[1],H=Object(r.useState)([]),G=Object(n.a)(H,2),V=G[0],J=G[1],X=Object(r.useState)(!1),Q=Object(n.a)(X,2),$=Q[0],Z=Q[1],ee=Object(r.useState)(!1),ae=Object(n.a)(ee,2),te=ae[0],re=ae[1],le=Object(Y.d)(),ce=Object(r.useCallback)((function(e,a,t,n){return le(Object($e.S)(e,a,t,n))}),[le]),ie=function(){Ye.c.post("/admin/download/list",{page:d,page_size:h,order_by:A.join(" "),conditions:x,searches:I}).then((function(e){F(e.data.users),m(e.data.items),N(e.data.total),J([])})).catch((function(e){ce("top","right",e.message,"error")}))};Object(r.useEffect)((function(){ie()}),[d,h,A,x,I]);var oe=function(e){return-1!==V.indexOf(e)};return l.a.createElement("div",null,l.a.createElement(fn,{open:te,onClose:function(){return re(!1)}}),l.a.createElement(pn,{filter:x,open:K,onClose:function(){return U(!1)},setSearch:L,setFilter:_}),l.a.createElement("div",{className:t.header},l.a.createElement(he.a,{color:"primary",onClick:function(){return ie()},variant:"outlined"},a("policy.refresh")),l.a.createElement("div",{className:t.headerRight},l.a.createElement(he.a,{color:"primary",onClick:function(){return re(!0)}},l.a.createElement(yn.a,null)," ","  ",e("howToConfigAria2")))),l.a.createElement(ze.a,{square:!0,className:t.tableContainer},V.length>0&&l.a.createElement(j.a,{className:t.highlight},l.a.createElement(k.a,{style:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1"},a("user.selectedObjects",{num:V.length})),l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{onClick:function(){Z(!0),Ye.c.post("/admin/download/delete",{id:V}).then((function(){ie(),ce("top","right",e("taskDeleted"),"success")})).catch((function(e){ce("top","right",e.message,"error")})).then((function(){Z(!1)}))},disabled:$,"aria-label":"delete"},l.a.createElement(za.a,null)))),l.a.createElement(Ka.a,{className:t.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{indeterminate:V.length>0&&V.length<o.length,checked:o.length>0&&V.length===o.length,onChange:function(e){if(e.target.checked){var a=o.map((function(e){return e.ID}));J(a)}else J([])},inputProps:{"aria-label":"select all desserts"}})),l.a.createElement(ka.a,{style:{minWidth:10}},l.a.createElement(Yt.a,{active:"id"===A[0],direction:A[1],onClick:function(){return q(["id","asc"===A[1]?"desc":"asc"])}},"#","id"===A[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===A[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:130}},e("srcURL")),l.a.createElement(ka.a,{style:{minWidth:90}},a("user.status")),l.a.createElement(ka.a,{style:{minWidth:90}},e("node")),l.a.createElement(ka.a,{style:{minWidth:150},align:"right"},l.a.createElement(Yt.a,{active:"total_size"===A[0],direction:A[1],onClick:function(){return q(["total_size","asc"===A[1]?"desc":"asc"])}},a("file.size"),"total_size"===A[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===A[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:100}},e("createdBy")),l.a.createElement(ka.a,{style:{minWidth:150}},a("file.createdAt")),l.a.createElement(ka.a,{style:{minWidth:80}},a("policy.actions")))),l.a.createElement(ja.a,null,o.map((function(t){return l.a.createElement(_a.a,{hover:!0,key:t.ID,role:"checkbox",selected:oe(t.ID)},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{onClick:function(e){return function(e,a){var t=V.indexOf(a),n=[];-1===t?n=n.concat(V,a):0===t?n=n.concat(V.slice(1)):t===V.length-1?n=n.concat(V.slice(0,-1)):t>0&&(n=n.concat(V.slice(0,t),V.slice(t+1))),J(n)}(0,t.ID)},checked:oe(t.ID)})),l.a.createElement(ka.a,null,t.ID),l.a.createElement(ka.a,{style:{wordBreak:"break-all"}},t.Source),l.a.createElement(ka.a,null,0===t.Status&&e("ready"),1===t.Status&&e("downloading"),2===t.Status&&e("paused"),3===t.Status&&e("error"),4===t.Status&&e("finished"),5===t.Status&&e("canceled"),6===t.Status&&e("unknown"),7===t.Status&&e("seeding")),l.a.createElement(ka.a,null,t.NodeID<=1&&l.a.createElement(Sa.a,{component:hn.a,to:"/admin/node/edit/1"},a("node.master")),t.NodeID>1&&l.a.createElement(Sa.a,{component:hn.a,to:"/admin/node/edit/"+t.NodeID},a("node.slave"),"#",t.NodeID)),l.a.createElement(ka.a,{align:"right"},Object(Va.p)(t.TotalSize)),l.a.createElement(ka.a,null,l.a.createElement(Sa.a,{href:"/admin/user/edit/"+t.UserID},D[t.UserID]?D[t.UserID].Nick:a("file.unknownUploader"))),l.a.createElement(ka.a,null,Object(sn.a)(t.CreatedAt)),l.a.createElement(ka.a,null,l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{disabled:$,onClick:function(){return a=t.ID,Z(!0),void Ye.c.post("/admin/download/delete",{id:[a]}).then((function(){ie(),ce("top","right",e("taskDeleted"),"success")})).catch((function(e){ce("top","right",e.message,"error")})).then((function(){Z(!1)}));var a},size:"small"},l.a.createElement(za.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,50,100],component:"div",count:O,rowsPerPage:h,page:d-1,onChangePage:function(e,a){return p(a+1)},onChangeRowsPerPage:function(e){v(e.target.value),p(1)}})))}var Sn=t(48),Cn=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},headerRight:{},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(S.i)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function jn(){var e=Object(ne.a)("dashboard",{keyPrefix:"task"}).t,a=Object(ne.a)("dashboard").t,t=Cn(),c=Object(r.useState)([]),i=Object(n.a)(c,2),o=i[0],m=i[1],s=Object(r.useState)(1),u=Object(n.a)(s,2),d=u[0],p=u[1],E=Object(r.useState)(10),b=Object(n.a)(E,2),h=b[0],v=b[1],g=Object(r.useState)(0),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)({}),C=Object(n.a)(S,2),x=C[0],_=C[1],z=Object(r.useState)({}),w=Object(n.a)(z,2),D=w[0],F=w[1],P=Object(r.useState)({}),R=Object(n.a)(P,2),I=R[0],L=R[1],T=Object(r.useState)(["id","desc"]),W=Object(n.a)(T,2),A=W[0],q=W[1],B=Object(r.useState)(!1),M=Object(n.a)(B,2),K=M[0],U=M[1],H=Object(r.useState)([]),G=Object(n.a)(H,2),V=G[0],J=G[1],X=Object(r.useState)(!1),Q=Object(n.a)(X,2),$=Q[0],Z=Q[1],ee=Object(Y.d)(),ae=Object(r.useCallback)((function(e,a,t,n){return ee(Object($e.S)(e,a,t,n))}),[ee]),te=function(){Ye.c.post("/admin/task/list",{page:d,page_size:h,order_by:A.join(" "),conditions:x,searches:I}).then((function(e){F(e.data.users),m(e.data.items),N(e.data.total),J([])})).catch((function(e){ae("top","right",e.message,"error")}))};Object(r.useEffect)((function(){te()}),[d,h,A,x,I]);var re=function(e){return-1!==V.indexOf(e)};return l.a.createElement("div",null,l.a.createElement(pn,{filter:x,open:K,onClose:function(){return U(!1)},setSearch:L,setFilter:_}),l.a.createElement("div",{className:t.header},l.a.createElement("div",{className:t.headerRight},l.a.createElement(he.a,{color:"primary",onClick:function(){return te()},variant:"outlined"},a("policy.refresh")))),l.a.createElement(ze.a,{square:!0,className:t.tableContainer},V.length>0&&l.a.createElement(j.a,{className:t.highlight},l.a.createElement(k.a,{style:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1"},a("user.selectedObjects",{num:V.length})),l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{onClick:function(){Z(!0),Ye.c.post("/admin/task/delete",{id:V}).then((function(){te(),ae("top","right",e("taskDeleted"),"success")})).catch((function(e){ae("top","right",e.message,"error")})).then((function(){Z(!1)}))},disabled:$,"aria-label":"delete"},l.a.createElement(za.a,null)))),l.a.createElement(Ka.a,{className:t.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{indeterminate:V.length>0&&V.length<o.length,checked:o.length>0&&V.length===o.length,onChange:function(e){if(e.target.checked){var a=o.map((function(e){return e.ID}));J(a)}else J([])},inputProps:{"aria-label":"select all desserts"}})),l.a.createElement(ka.a,{style:{minWidth:10}},l.a.createElement(Yt.a,{active:"id"===A[0],direction:A[1],onClick:function(){return q(["id","asc"===A[1]?"desc":"asc"])}},"#","id"===A[0]?l.a.createElement("span",{className:t.visuallyHidden},"desc"===A[1]?"sorted descending":"sorted ascending"):null)),l.a.createElement(ka.a,{style:{minWidth:130}},a("policy.type")),l.a.createElement(ka.a,{style:{minWidth:90}},a("user.status")),l.a.createElement(ka.a,{style:{minWidth:90}},e("lastProgress")),l.a.createElement(ka.a,{style:{minWidth:150}},e("errorMsg")),l.a.createElement(ka.a,{style:{minWidth:100}},e("createdBy")),l.a.createElement(ka.a,{style:{minWidth:150}},a("file.createdAt")),l.a.createElement(ka.a,{style:{minWidth:80}},a("policy.actions")))),l.a.createElement(ja.a,null,o.map((function(n){return l.a.createElement(_a.a,{hover:!0,key:n.ID,role:"checkbox",selected:re(n.ID)},l.a.createElement(ka.a,{padding:"checkbox"},l.a.createElement($t.a,{onClick:function(e){return function(e,a){var t=V.indexOf(a),n=[];-1===t?n=n.concat(V,a):0===t?n=n.concat(V.slice(1)):t===V.length-1?n=n.concat(V.slice(0,-1)):t>0&&(n=n.concat(V.slice(0,t),V.slice(t+1))),J(n)}(0,n.ID)},checked:re(n.ID)})),l.a.createElement(ka.a,null,n.ID),l.a.createElement(ka.a,{style:{wordBreak:"break-all"}},Object(Sn.f)(n.Type)),l.a.createElement(ka.a,null,Object(Sn.e)(n.Status)),l.a.createElement(ka.a,null,Object(Sn.d)(n.Type,n.Progress)),l.a.createElement(ka.a,{className:t.noWrap},function(a){if(""===a)return"-";try{return JSON.parse(a).msg}catch(t){return e("unknown")}}(n.Error)),l.a.createElement(ka.a,null,l.a.createElement(Sa.a,{href:"/admin/user/edit/"+n.UserID},D[n.UserID]?D[n.UserID].Nick:e("unknown"))),l.a.createElement(ka.a,null,Object(sn.a)(n.CreatedAt)),l.a.createElement(ka.a,null,l.a.createElement(Ha.a,{title:a("policy.delete")},l.a.createElement(f.a,{disabled:$,onClick:function(){return a=n.ID,Z(!0),void Ye.c.post("/admin/task/delete",{id:[a]}).then((function(){te(),ae("top","right",e("taskDeleted"),"success")})).catch((function(e){ae("top","right",e.message,"error")})).then((function(){Z(!1)}));var a},size:"small"},l.a.createElement(za.a,null)))))}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,50,100],component:"div",count:O,rowsPerPage:h,page:d-1,onChangePage:function(e,a){return p(a+1)},onChangeRowsPerPage:function(e){v(e.target.value),p(1)}})))}var kn=t(272),xn=t(460),_n=t(91),zn=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),userSelect:{width:400,borderRadius:0}}}));function wn(){var e=Object(ne.a)("dashboard",{keyPrefix:"file"}).t,a=Object(ne.a)("common").t,t=zn(),c=Object(r.useState)(!1),i=Object(n.a)(c,2),o=i[0],u=i[1],d=Object(r.useState)({policy:1,userInput:"",src:"",dst:"",recursive:!0}),p=Object(n.a)(d,2),E=p[0],b=p[1],h=Object(r.useState)(null),v=Object(n.a)(h,2),f=v[0],g=v[1],y=Object(r.useState)({}),O=Object(n.a)(y,2),N=O[0],S=O[1],C=Object(r.useState)([]),j=Object(n.a)(C,2),x=j[0],_=j[1],z=Object(r.useState)(null),w=Object(n.a)(z,2),D=w[0],F=w[1],P=Object(r.useState)(!1),R=Object(n.a)(P,2),I=R[0],L=R[1],T=Object(r.useState)(!1),W=Object(n.a)(T,2),A=W[0],q=W[1],B=function(e){return function(a){b(Object(m.a)(Object(m.a)({},E),{},Object(s.a)({},e,a.target.value)))}},M=Object(Z.g)(),K=Object(Y.d)(),U=Object(r.useCallback)((function(e,a,t,n){return K(Object($e.S)(e,a,t,n))}),[K]),H=function(e,a){var t=Object(r.useState)(e),l=Object(n.a)(t,2),c=l[0],i=l[1];return Object(r.useEffect)((function(){var t=setTimeout((function(){i(e)}),a);return function(){clearTimeout(t)}}),[e]),c}(E.userInput,500);Object(r.useEffect)((function(){""!==H&&Ye.c.post("/admin/user/list",{page:1,page_size:1e4,order_by:"id asc",searches:{nick:H,email:H}}).then((function(e){_(e.data.items)})).catch((function(e){U("top","right",e.message,"error")}))}),[H]),Object(r.useEffect)((function(){Ye.c.post("/admin/policy/list",{page:1,page_size:1e4,order_by:"id asc",conditions:{}}).then((function(e){var a={};e.data.items.forEach((function(e){a[e.ID]=e})),S(a)})).catch((function(e){U("top","right",e.message,"error")}))}),[]);var G,V=function(e){return function(a){var t="/"===a.path?a.path+a.name:a.path+"/"+a.name;e("//"===t?"/":t)}},J=function(a){if(a){if(!N[E.policy]||"local"===N[E.policy].Type||"remote"===N[E.policy].Type)return void U("top","right",e("manuallyPathOnly"),"warning");L(!0)}else{if(null===D)return void U("top","right",e("selectTargetUser"),"warning");q(!0)}};return l.a.createElement("div",null,l.a.createElement(Ne.a,{open:I,onClose:function(){return L(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(ke.a,{id:"form-dialog-title"},e("selectFolder")),l.a.createElement(_n.a,{presentPath:"/",api:"/admin/file/folders/policy/"+E.policy,selected:[],onSelect:V((function(e){return b(Object(m.a)(Object(m.a)({},E),{},{src:e}))}))}),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:function(){return L(!1)},color:"primary"},a("ok")))),l.a.createElement(Ne.a,{open:A,onClose:function(){return q(!1)},"aria-labelledby":"form-dialog-title"},l.a.createElement(ke.a,{id:"form-dialog-title"},e("selectFolder")),l.a.createElement(_n.a,{presentPath:"/",api:"/admin/file/folders/user/"+(null===D?0:D.ID),selected:[],onSelect:V((function(e){return b(Object(m.a)(Object(m.a)({},E),{},{dst:e}))}))}),l.a.createElement(Se.a,null,l.a.createElement(he.a,{onClick:function(){return q(!1)},color:"primary"},a("ok")))),l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),null!==D?(u(!0),Ye.c.post("/admin/task/import",{uid:D.ID,policy_id:parseInt(E.policy),src:E.src,dst:E.dst,recursive:E.recursive}).then((function(){u(!1),M.push("/admin/file"),U("top","right",e("importTaskCreated"),"success")})).catch((function(e){u(!1),U("top","right",e.message,"error")}))):U("top","right",e("selectTargetUser"),"warning")}},l.a.createElement("div",{className:t.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("importExternalFolder")),l.a.createElement("div",{className:t.formContainer},l.a.createElement("div",{className:t.form},l.a.createElement(wa.a,{severity:"info"},e("importExternalFolderDes"))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("storagePolicy")),l.a.createElement(ia.a,{labelId:"demo-mutiple-chip-label",id:"demo-mutiple-chip",value:E.policy,onChange:B("policy"),input:l.a.createElement(ra.a,{id:"select-multiple-chip"})},Object.keys(N).map((function(e){return l.a.createElement(ca.a,{key:e,value:e},N[e].Name)}))),l.a.createElement(na.a,{id:"component-helper-text"},e("storagePolicyDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("targetUser")),l.a.createElement(ra.a,{value:E.userInput,onChange:function(e){B("userInput")(e),g(e.currentTarget)},startAdornment:null!==D&&l.a.createElement(ga.a,{position:"start"},l.a.createElement(ve.a,{size:"small",onDelete:function(){F(null)},label:D.Nick})),disabled:null!==D}),l.a.createElement(xn.a,{open:""!==E.userInput&&x.length>0,anchorEl:f,placement:"bottom",transition:!0},(function(e){var a=e.TransitionProps;return l.a.createElement(kn.a,Object.assign({},a,{timeout:350}),l.a.createElement(ze.a,{className:t.userSelect},x.map((function(e){return l.a.createElement(ca.a,{key:e.Email,onClick:function(){return function(e){b(Object(m.a)(Object(m.a)({},E),{},{userInput:""})),F(e)}(e)}},e.Nick," ","<"+e.Email+">")}))))})),l.a.createElement(na.a,{id:"component-helper-text"},e("targetUserDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("srcFolderPath")),l.a.createElement(ra.a,{value:E.src,onChange:function(e){B("src")(e),g(e.currentTarget)},required:!0,endAdornment:l.a.createElement(he.a,{onClick:function(){return J(!0)}},e("select"))}),l.a.createElement(na.a,{id:"component-helper-text"},e("selectSrcDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("dstFolderPath")),l.a.createElement(ra.a,{value:E.dst,onChange:function(e){B("dst")(e),g(e.currentTarget)},required:!0,endAdornment:l.a.createElement(he.a,{onClick:function(){return J(!1)}},e("select"))}),l.a.createElement(na.a,{id:"component-helper-text"},e("dstFolderPathDes")))),l.a.createElement("div",{className:t.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:E.recursive,onChange:(G="recursive",function(e){b(Object(m.a)(Object(m.a)({},E),{},Object(s.a)({},G,e.target.checked)))})}),label:e("recursivelyImport")}),l.a.createElement(na.a,{id:"component-helper-text"},e("recursivelyImportDes")))))),l.a.createElement("div",{className:t.root},l.a.createElement(he.a,{disabled:o,type:"submit",variant:"contained",color:"primary"},e("createImportTask")))))}var Dn=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),form:{maxWidth:400,marginTop:20,marginBottom:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"})}}));function Fn(){var e=Object(ne.a)("dashboard",{keyPrefix:"settings"}).t,a=Dn(),t=Object(r.useState)(!1),c=Object(n.a)(t,2),i=c[0],o=c[1],u=Object(r.useState)({captcha_type:"normal",captcha_height:"1",captcha_width:"1",captcha_mode:"3",captcha_CaptchaLen:"6",captcha_ComplexOfNoiseText:"0",captcha_ComplexOfNoiseDot:"0",captcha_IsShowHollowLine:"0",captcha_IsShowNoiseDot:"0",captcha_IsShowNoiseText:"0",captcha_IsShowSlimeLine:"0",captcha_IsShowSineLine:"0",captcha_ReCaptchaKey:"",captcha_ReCaptchaSecret:"",captcha_TCaptcha_CaptchaAppId:"",captcha_TCaptcha_AppSecretKey:"",captcha_TCaptcha_SecretId:"",captcha_TCaptcha_SecretKey:""}),d=Object(n.a)(u,2),p=d[0],E=d[1],b=function(e){return function(a){E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},e,a.target.value)))}},h=Object(Y.d)(),v=Object(r.useCallback)((function(e,a,t,n){return h(Object($e.S)(e,a,t,n))}),[h]);Object(r.useEffect)((function(){Ye.c.post("/admin/setting",{keys:Object.keys(p)}).then((function(e){E(e.data)})).catch((function(e){v("top","right",e.message,"error")}))}),[]);return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:function(a){a.preventDefault(),o(!0);var t=[];Object.keys(p).forEach((function(e){t.push({key:e,value:p[e]})})),Ye.c.patch("/admin/setting",{options:t}).then((function(){v("top","right",e("saved"),"success")})).catch((function(e){v("top","right",e.message,"error")})).then((function(){o(!1)}))}},l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("captcha")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("captchaType")),l.a.createElement(ia.a,{value:p.captcha_type,onChange:b("captcha_type"),required:!0},l.a.createElement(ca.a,{value:"normal"},e("plainCaptcha")),l.a.createElement(ca.a,{value:"recaptcha"},e("reCaptchaV2")),l.a.createElement(ca.a,{value:"tcaptcha"},e("tencentCloudCaptcha"))),l.a.createElement(na.a,{id:"component-helper-text"},e("captchaProvider")))))),"normal"===p.captcha_type&&l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("plainCaptchaTitle")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("captchaWidth")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.captcha_width,onChange:b("captcha_width"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("captchaHeight")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.captcha_height,onChange:b("captcha_height"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("captchaLength")),l.a.createElement(ra.a,{type:"number",inputProps:{min:1,step:1},value:p.captcha_CaptchaLen,onChange:b("captcha_CaptchaLen"),required:!0}))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,null,l.a.createElement(la.a,{htmlFor:"component-helper"},e("captchaMode")),l.a.createElement(ia.a,{value:p.captcha_mode,onChange:b("captcha_mode"),required:!0},l.a.createElement(ca.a,{value:"0"},e("captchaModeNumber")),l.a.createElement(ca.a,{value:"1"},e("captchaModeLetter")),l.a.createElement(ca.a,{value:"2"},e("captchaModeMath")),l.a.createElement(ca.a,{value:"3"},e("captchaModeNumberLetter"))),l.a.createElement(na.a,{id:"component-helper-text"},e("captchaElement")))),[{name:"complexOfNoiseText",field:"captcha_ComplexOfNoiseText"},{name:"complexOfNoiseDot",field:"captcha_ComplexOfNoiseDot"},{name:"showHollowLine",field:"captcha_IsShowHollowLine"},{name:"showNoiseDot",field:"captcha_IsShowNoiseDot"},{name:"showNoiseText",field:"captcha_IsShowNoiseText"},{name:"showSlimeLine",field:"captcha_IsShowSlimeLine"},{name:"showSineLine",field:"captcha_IsShowSineLine"}].map((function(t){return l.a.createElement("div",{key:t.name,className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ua.a,{control:l.a.createElement(da.a,{checked:"1"===p[t.field],onChange:(n=t.field,function(e){var a=e.target.checked?"1":"0";E(Object(m.a)(Object(m.a)({},p),{},Object(s.a)({},n,a)))})}),label:e(t.name)})));var n})))),"recaptcha"===p.captcha_type&&l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("reCaptchaV2")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("siteKey")),l.a.createElement(ra.a,{required:!0,value:p.captcha_ReCaptchaKey,onChange:b("captcha_ReCaptchaKey")}),l.a.createElement(na.a,{id:"component-helper-text"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"settings.siteKeyDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://www.google.com/recaptcha/admin/create",target:"_blank"})]})))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("siteSecret")),l.a.createElement(ra.a,{required:!0,value:p.captcha_ReCaptchaSecret,onChange:b("captcha_ReCaptchaSecret")}),l.a.createElement(na.a,{id:"component-helper-text"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"settings.siteSecretDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://www.google.com/recaptcha/admin/create",target:"_blank"})]}))))))),"tcaptcha"===p.captcha_type&&l.a.createElement("div",{className:a.root},l.a.createElement(k.a,{variant:"h6",gutterBottom:!0},e("tencentCloudCaptcha")),l.a.createElement("div",{className:a.formContainer},l.a.createElement("div",{className:a.form},l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("secretID")),l.a.createElement(ra.a,{required:!0,value:p.captcha_TCaptcha_SecretId,onChange:b("captcha_TCaptcha_SecretId")}),l.a.createElement(na.a,{id:"component-helper-text"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"settings.siteSecretDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/capi",target:"_blank"})]})))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("secretKey")),l.a.createElement(ra.a,{required:!0,value:p.captcha_TCaptcha_SecretKey,onChange:b("captcha_TCaptcha_SecretKey")}),l.a.createElement(na.a,{id:"component-helper-text"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"settings.secretKeyDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/capi",target:"_blank"})]})))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("tCaptchaAppID")),l.a.createElement(ra.a,{required:!0,value:p.captcha_TCaptcha_CaptchaAppId,onChange:b("captcha_TCaptcha_CaptchaAppId")}),l.a.createElement(na.a,{id:"component-helper-text"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"settings.tCaptchaAppIDDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/captcha/graphical",target:"_blank"})]})))),l.a.createElement("div",{className:a.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},e("tCaptchaSecretKey")),l.a.createElement(ra.a,{required:!0,value:p.captcha_TCaptcha_AppSecretKey,onChange:b("captcha_TCaptcha_AppSecretKey")}),l.a.createElement(na.a,{id:"component-helper-text"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"settings.tCaptchaSecretKeyDes",components:[l.a.createElement(Sa.a,{key:0,href:"https://console.cloud.tencent.com/captcha/graphical",target:"_blank"})]}))))))),l.a.createElement("div",{className:a.root},l.a.createElement(he.a,{disabled:i,type:"submit",variant:"contained",color:"primary"},e("save")))))}var Pn=t(8076),Rn=t(8077),In=t(8078),Ln=t(8079),Tn=t(31),Wn=t.n(Tn),An=t(8075),qn=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)},container:{overflowX:"auto"},tableContainer:{marginTop:16},header:{display:"flex",justifyContent:"space-between"},disabledBadge:{marginLeft:e.spacing(1),height:18},disabledCell:{color:e.palette.text.disabled},verticalAlign:{verticalAlign:"middle",display:"inline-block"}}})),Bn=[{id:"#",minWidth:50},{id:"name",minWidth:170},{id:"status",minWidth:50},{id:"features",minWidth:170},{id:"action",minWidth:170}],Mn=[{field:"Aria2Enabled",name:"remoteDownload"}];function Kn(){var e=Object(ne.a)("dashboard",{keyPrefix:"node"}).t,a=qn(),t=Object(r.useState)([]),c=Object(n.a)(t,2),i=c[0],o=c[1],m=Object(r.useState)({}),u=Object(n.a)(m,2),d=u[0],p=u[1],E=Object(r.useState)(!1),b=Object(n.a)(E,2),h=b[0],v=b[1],g=Object(r.useState)(1),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useState)(10),C=Object(n.a)(S,2),j=C[0],k=C[1],x=Object(r.useState)(0),_=Object(n.a)(x,2),z=_[0],w=_[1],D=Object(Z.g)(),F=Object(Y.d)(),P=Object(r.useCallback)((function(e,a,t,n){return F(Object($e.S)(e,a,t,n))}),[F]),R=function(){Ye.c.post("/admin/node/list",{page:O,page_size:j,order_by:"id desc"}).then((function(e){o(e.data.items),w(e.data.total),p(e.data.active)})).catch((function(e){P("top","right",e.message,"error")}))};Object(r.useEffect)((function(){R()}),[O,j]);return l.a.createElement("div",null,l.a.createElement("div",{className:a.header},l.a.createElement(he.a,{color:"primary",onClick:function(){return D.push("/admin/node/add")},variant:"contained"},e("addNewNode")),l.a.createElement("div",{className:a.headerRight},l.a.createElement(he.a,{color:"primary",onClick:function(){return R()},variant:"outlined"},e("refresh")))),l.a.createElement(ze.a,{square:!0,className:a.tableContainer},l.a.createElement(Ka.a,{className:a.container},l.a.createElement(Ca.a,{"aria-label":"sticky table",size:"small"},l.a.createElement(xa.a,null,l.a.createElement(_a.a,{style:{height:52}},Bn.map((function(a){return l.a.createElement(ka.a,{key:a.id,align:a.align,style:{minWidth:a.minWidthclassNames}},e(a.id))})))),l.a.createElement(ja.a,null,i.map((function(t){return l.a.createElement(_a.a,{hover:!0,key:t.ID},l.a.createElement(ka.a,null,t.ID),l.a.createElement(ka.a,{className:Wn()(Object(s.a)({},a.disabledCell,1===t.Status))},t.Name,function(t){if(1===t)return l.a.createElement(ve.a,{className:a.disabledBadge,size:"small",label:e("disabled")})}(t.Status)),l.a.createElement(ka.a,null,d[t.ID]?l.a.createElement(An.a,{color:"success.main",fontSize:"small"},l.a.createElement(Pn.a,{className:a.verticalAlign,fontSize:"small"})," ",l.a.createElement("span",{className:a.verticalAlign},e("online"))):l.a.createElement(An.a,{color:"error.main",fontSize:"small"},l.a.createElement(Rn.a,{className:a.verticalAlign,fontSize:"small"})," ",l.a.createElement("span",{className:a.verticalAlign},e("offline")))),l.a.createElement(ka.a,null,(n=t,Mn.map((function(t){if(n[t.field])return l.a.createElement(ve.a,{className:a.disabledBadge,size:"small",color:"primary",label:e(t.name)})})))),l.a.createElement(ka.a,{align:"right"},l.a.createElement(Ha.a,{title:1===t.Status?e("enableNode"):e("disableNode")},l.a.createElement(f.a,{disabled:h,onClick:function(){return a=t.ID,n=1-t.Status,v(!0),void Ye.c.patch("/admin/node/enable/"+a+"/"+n).then((function(a){R(),P("top","right",e(1===n?"nodeDisabled":"nodeEnabled"),"success")})).catch((function(e){P("top","right",e.message,"error")})).then((function(){v(!1)}));var a,n},size:"small"},1===t.Status&&l.a.createElement(In.a,null),1!==t.Status&&l.a.createElement(Ln.a,null))),l.a.createElement(Ha.a,{title:e("edit")},l.a.createElement(f.a,{disabled:h,onClick:function(){return D.push("/admin/node/edit/"+t.ID)},size:"small"},l.a.createElement(Ga.a,null))),l.a.createElement(Ha.a,{title:e("delete")},l.a.createElement(f.a,{onClick:function(){return a=t.ID,v(!0),void Ye.c.delete("/admin/node/"+a).then((function(){R(),P("top","right",e("nodeDeleted"),"success")})).catch((function(e){P("top","right",e.message,"error")})).then((function(){v(!1)}));var a},disabled:h,size:"small"},l.a.createElement(za.a,null)))));var n}))))),l.a.createElement(Ua.a,{rowsPerPageOptions:[10,25,100],component:"div",count:z,rowsPerPage:j,page:O-1,onChangePage:function(e,a){return N(a+1)},onChangeRowsPerPage:function(e){k(e.target.value),N(1)}})))}var Un=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"},pre:{margin:"24px 0",padding:"12px 18px",overflow:"auto",direction:"ltr",borderRadius:"4px",backgroundColor:"#272c34",color:"#fff",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace'}}}}));function Hn(e){var a=Object(ne.a)("dashboard",{keyPrefix:"node"}).t,t=Object(ne.a)("dashboard").t,c=Un(),i=Object(Y.d)(),o=Object(r.useState)(!1),m=Object(n.a)(o,2),s=m[0],u=m[1],d=Object(r.useCallback)((function(e,a,t,n){return i(Object($e.S)(e,a,t,n))}),[i]);return l.a.createElement("form",{className:c.stepContent,onSubmit:function(a){a.preventDefault(),e.onSubmit(a)}},l.a.createElement(wa.a,{severity:"info",style:{marginBottom:10}},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"node.slaveNodeDes",components:[l.a.createElement(An.a,{key:0,fontWeight:"fontWeightBold"})]})),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"1")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},t("policy.remoteCopyBinaryDescription")))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"2")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},t("policy.remoteSecretDescription")),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},t("policy.remoteSecret")),l.a.createElement(ra.a,{required:!0,inputProps:{minlength:64},value:e.node.SlaveKey,onChange:e.handleTextChange("SlaveKey")}))))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"3")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},t("policy.modifyRemoteConfig"),l.a.createElement("br",null),l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.addRemoteConfigDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("pre",null,"[System]",l.a.createElement("br",null),"Mode = slave",l.a.createElement("br",null),"Listen = :5212",l.a.createElement("br",null),l.a.createElement("br",null),"[Slave]",l.a.createElement("br",null),"Secret = ",e.node.SlaveKey,l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"node.overwriteDes",components:[l.a.createElement("br",{key:0}),l.a.createElement("br",{key:1})]}),l.a.createElement("br",null),"[OptionOverwrite]",l.a.createElement("br",null),"; ",a("workerNumDes"),l.a.createElement("br",null),"max_worker_num = 50",l.a.createElement("br",null),"; ",a("parallelTransferDes"),l.a.createElement("br",null),"max_parallel_transfer = 10",l.a.createElement("br",null),"; ",a("chunkRetriesDes"),l.a.createElement("br",null),"chunk_retries = 10"),l.a.createElement(k.a,{variant:"body2"},t("policy.remoteConfigDifference"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.remoteConfigDifference1",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2})]})),l.a.createElement("li",null,l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"policy.remoteConfigDifference2",components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1})]}))),a("multipleMasterDes")))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"4")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},t("policy.inputRemoteAddress"),l.a.createElement("br",null),t("policy.inputRemoteAddressDes")),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},t("policy.remoteAddress")),l.a.createElement(ra.a,{fullWidth:!0,required:!0,type:"url",value:e.node.Server,onChange:e.handleTextChange("Server")}))))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"5")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},t("policy.testCommunicationDes")),l.a.createElement("div",{className:c.form},l.a.createElement(he.a,{disabled:s,variant:"outlined",onClick:function(){return u(!0),void Ye.c.post("/admin/policy/test/slave",{server:e.node.Server,secret:e.node.SlaveKey}).then((function(){d("top","right",t("policy.communicationOK"),"success")})).catch((function(e){d("top","right",e.message,"error")})).then((function(){u(!1)}))},color:"primary"},t("policy.testCommunication"))))),l.a.createElement("div",{className:c.stepFooter},l.a.createElement(he.a,{disabled:s||e.loading,type:"submit",variant:"contained",color:"primary"},t("policy.next"))))}var Gn=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"},pre:{margin:"24px 0",padding:"12px 18px",overflow:"auto",direction:"ltr",borderRadius:"4px",backgroundColor:"#272c34",color:"#fff",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace'}}}}));function Vn(e){var a=Object(ne.a)("dashboard",{keyPrefix:"node"}).t,t=Object(ne.a)("dashboard").t,c=Gn(),i=Object(Y.d)(),o=Object(r.useState)(!1),m=Object(n.a)(o,2),s=m[0],u=m[1],d=Object(r.useCallback)((function(e,a,t,n){return i(Object($e.S)(e,a,t,n))}),[i]),p=0===e.node.Type?a("slave"):a("master");return l.a.createElement("form",{className:c.stepContent,onSubmit:function(a){a.preventDefault(),e.onSubmit(a)}},l.a.createElement(wa.a,{severity:"info",style:{marginBottom:10}},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"node.aria2Des",values:{mode:p},components:[l.a.createElement(Sa.a,{href:"https://aria2.github.io/",target:"_blank",key:0}),l.a.createElement(An.a,{component:"span",fontWeight:"fontWeightBold",key:1}),l.a.createElement(Sa.a,{href:a("aria2DocURL"),target:"_blank",key:2})]}))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"1")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},0===e.node.Type?a("slaveTakeOverRemoteDownload"):a("masterTakeOverRemoteDownload"),l.a.createElement("br",null),0===e.node.Type?a("routeTaskSlave"):a("routeTaskMaster")),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{required:!0,component:"fieldset"},l.a.createElement(ct.a,{required:!0,value:e.node.Aria2Enabled,onChange:e.handleTextChange("Aria2Enabled"),row:!0},l.a.createElement(ua.a,{value:"true",control:l.a.createElement(lt.a,{color:"primary"}),label:a("enable")}),l.a.createElement(ua.a,{value:"false",control:l.a.createElement(lt.a,{color:"primary"}),label:a("disable")})))))),l.a.createElement(rt.a,{in:"true"===e.node.Aria2Enabled},l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"2")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("aria2ConfigDes",{target:0===e.node.Type?a("slaveNodeTarget"):a("masterNodeTarget")})),l.a.createElement("pre",null,"# ",a("enableRPCComment"),l.a.createElement("br",null),"enable-rpc=true",l.a.createElement("br",null),"# ",a("rpcPortComment"),l.a.createElement("br",null),"rpc-listen-port=6800",l.a.createElement("br",null),"# ",a("rpcSecretComment"),l.a.createElement("br",null),"rpc-secret=",e.node.Aria2OptionsSerialized.token,l.a.createElement("br",null)),l.a.createElement(wa.a,{severity:"info",style:{marginBottom:10}},l.a.createElement(k.a,{variant:"body2"},a("rpcConfigDes"))))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"3")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"node.rpcServerDes",values:{mode:p},components:[l.a.createElement("code",{key:0}),l.a.createElement("code",{key:1}),l.a.createElement("code",{key:2})]})),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("rpcServer")),l.a.createElement(ra.a,{required:!0,type:"url",value:e.node.Aria2OptionsSerialized.server,onChange:e.handleOptionChange("server")}),l.a.createElement(na.a,{id:"component-helper-text"},a("rpcServerHelpDes")))))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"4")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"node.rpcTokenDes",components:[l.a.createElement("code",{key:0})]})),l.a.createElement("div",{className:c.form},l.a.createElement(ra.a,{value:e.node.Aria2OptionsSerialized.token,onChange:e.handleOptionChange("token")})))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"5")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},l.a.createElement(Ze.a,{ns:"dashboard",i18nKey:"node.aria2PathDes",components:[l.a.createElement("strong",{key:0})]})),l.a.createElement("div",{className:c.form},l.a.createElement(ra.a,{value:e.node.Aria2OptionsSerialized.temp_path,onChange:e.handleOptionChange("temp_path")})))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"5")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("aria2SettingDes")),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("refreshInterval")),l.a.createElement(ra.a,{type:"number",inputProps:{step:1,min:1},required:!0,value:e.node.Aria2OptionsSerialized.interval,onChange:e.handleOptionChange("interval")}),l.a.createElement(na.a,{id:"component-helper-text"},a("refreshIntervalDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("rpcTimeout")),l.a.createElement(ra.a,{type:"number",inputProps:{step:1,min:1},required:!0,value:e.node.Aria2OptionsSerialized.timeout,onChange:e.handleOptionChange("timeout")}),l.a.createElement(na.a,{id:"component-helper-text"},a("rpcTimeoutDes")))),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("globalOptions")),l.a.createElement(ra.a,{multiline:!0,required:!0,value:e.node.Aria2OptionsSerialized.options,onChange:e.handleOptionChange("options")}),l.a.createElement(na.a,{id:"component-helper-text"},a("globalOptionsDes")))))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"6")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("testAria2Des",{mode:p}),0===e.node.Type&&a("testAria2DesSlaveAddition")),l.a.createElement("div",{className:c.form},l.a.createElement(he.a,{disabled:s,variant:"outlined",onClick:function(){return u(!0),void Ye.c.post("/admin/node/aria2/test",{type:e.node.Type,server:e.node.Server,secret:e.node.SlaveKey,rpc:e.node.Aria2OptionsSerialized.server,token:e.node.Aria2OptionsSerialized.token}).then((function(e){d("top","right",a("ariaSuccess",{version:e.data}),"success")})).catch((function(e){d("top","right",e.message,"error")})).then((function(){u(!1)}))},color:"primary"},a("testAria2")))))),l.a.createElement("div",{className:c.stepFooter},0!==e.activeStep&&l.a.createElement(he.a,{color:"default",className:c.button,onClick:e.onBack},t("policy.back")),l.a.createElement(he.a,{disabled:s||e.loading,type:"submit",variant:"contained",color:"primary",onClick:e.onSubmit},t("policy.next"))))}var Jn=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"},pre:{margin:"24px 0",padding:"12px 18px",overflow:"auto",direction:"ltr",borderRadius:"4px",backgroundColor:"#272c34",color:"#fff",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace'}}}}));function Xn(e){var a=Object(ne.a)("dashboard",{keyPrefix:"node"}).t,t=Object(ne.a)("dashboard").t,c=Jn(),i=Object(Y.d)(),o=Object(r.useState)(!1),m=Object(n.a)(o,2),s=m[0];m[1],Object(r.useCallback)((function(e,a,t,n){return i(Object($e.S)(e,a,t,n))}),[i]);return l.a.createElement("form",{className:c.stepContent,onSubmit:function(a){a.preventDefault(),e.onSubmit(a)}},l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"1")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("nameNode")),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(ra.a,{required:!0,value:e.node.Name,onChange:e.handleTextChange("Name")}))))),l.a.createElement("div",{className:c.subStepContainer},l.a.createElement("div",{className:c.stepNumberContainer},l.a.createElement("div",{className:c.stepNumber},"2")),l.a.createElement("div",{className:c.subStepContent},l.a.createElement(k.a,{variant:"body2"},a("loadBalancerRankDes")),l.a.createElement("div",{className:c.form},l.a.createElement(ta.a,{fullWidth:!0},l.a.createElement(la.a,{htmlFor:"component-helper"},a("loadBalancerRank")),l.a.createElement(ra.a,{type:"number",required:!0,inputProps:{step:1,min:0},value:e.node.Rank,onChange:e.handleTextChange("Rank")}))))),l.a.createElement("div",{className:c.stepFooter},l.a.createElement(he.a,{disabled:s||e.loading,type:"submit",variant:"contained",color:"primary"},t("policy.next"))))}var Qn=Object(c.a)((function(e){return{stepContent:{padding:"16px 32px 16px 32px"},form:{maxWidth:400,marginTop:20},formContainer:Object(s.a)({},e.breakpoints.up("md"),{padding:"0px 24px 0 24px"}),subStepContainer:{display:"flex",marginBottom:20,padding:10,transition:e.transitions.create("background-color",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),"&:focus-within":{backgroundColor:e.palette.background.default}},stepNumber:{width:20,height:20,backgroundColor:Object(S.i)(e.palette.secondary.light,.2),color:e.palette.secondary.contrastText,textAlign:"center",borderRadius:" 50%"},stepNumberContainer:{marginRight:10},stepFooter:{marginTop:32},button:{marginRight:e.spacing(1)},viewButtonLabel:{textTransform:"none"},"@global":{code:{color:"rgba(0, 0, 0, 0.87)",display:"inline-block",padding:"2px 6px",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace',borderRadius:"2px",backgroundColor:"rgba(255,229,100,0.1)"},pre:{margin:"24px 0",padding:"12px 18px",overflow:"auto",direction:"ltr",borderRadius:"4px",backgroundColor:"#272c34",color:"#fff",fontFamily:' Consolas, "Liberation Mono", Menlo, Courier, monospace'}}}}));function $n(e){var a=Object(ne.a)("dashboard",{keyPrefix:"node"}).t,t=Qn(),n=Object(Z.g)();return l.a.createElement("form",{className:t.stepContent},l.a.createElement(k.a,null,a("nodeSaved")),l.a.createElement(k.a,{variant:"body2",color:"textSecondary"},a("nodeSavedFutureAction")),l.a.createElement("div",{className:t.stepFooter},l.a.createElement(he.a,{color:"primary",className:t.button,onClick:function(){return n.push("/admin/node")}},a("backToNodeList"))))}var Yn=[{slaveOnly:!0,title:"communication",optional:!1,component:function(e){return l.a.createElement(Hn,e)}},{slaveOnly:!1,title:"remoteDownload",optional:!1,component:function(e){return l.a.createElement(Vn,e)}},{slaveOnly:!1,title:"otherSettings",optional:!1,component:function(e){return l.a.createElement(Xn,e)}},{slaveOnly:!1,title:"finish",optional:!1,component:function(e){return l.a.createElement($n,e)}}];function Zn(e){var a=Object(ne.a)("dashboard",{keyPrefix:"node"}).t,t=Object(ne.a)("dashboard").t,c=Object(r.useState)(0),i=Object(n.a)(c,2),o=i[0],u=i[1],d=l.a.useState(new Set),p=Object(n.a)(d,2),E=p[0],b=(p[1],Object(r.useState)(!1)),h=Object(n.a)(b,2),v=h[0],f=h[1],g=Object(r.useState)(e.node?e.node:{Status:1,Type:0,Aria2Enabled:"false",Server:"https://example.com:5212",SlaveKey:Object(Va.n)(64),MasterKey:Object(Va.n)(64),Rank:"0",Aria2OptionsSerialized:{token:Object(Va.n)(32),options:"{}",interval:"10",timeout:"10"}}),y=Object(n.a)(g,2),O=y[0],N=y[1],S=Object(r.useMemo)((function(){return Yn.filter((function(e){return!(e.slaveOnly&&1===O.Type)}))}),[O.Type]),C=Object(Y.d)(),j=Object(r.useCallback)((function(e,a,t,n){return C(Object($e.S)(e,a,t,n))}),[C]);return l.a.createElement("div",null,l.a.createElement(k.a,{variant:"h6"},e.node?a("editNode"):a("addNode")),l.a.createElement(mt.a,{activeStep:o},S.map((function(e,n){var r,c={},i={};if(e.optional&&(i.optional=l.a.createElement(k.a,{variant:"caption"},t("policy.optional"))),r=n,E.has(r)&&(c.completed=!1),!e.slaveOnly||1!==O.Type)return l.a.createElement(it.a,Object.assign({key:e.title},c),l.a.createElement(ot.a,i,a(e.title)))}))),S[o].component({onSubmit:function(t){return function(){if(e.node||o+1===Yn.length-1){f(!0);var t=Object(m.a)({},O);t.Aria2OptionsSerialized=Object(m.a)({},O.Aria2OptionsSerialized),t.Rank=parseInt(t.Rank),t.Aria2OptionsSerialized.interval=parseInt(t.Aria2OptionsSerialized.interval),t.Aria2OptionsSerialized.timeout=parseInt(t.Aria2OptionsSerialized.timeout),t.Aria2Enabled="true"===t.Aria2Enabled,Ye.c.post("/admin/node",{node:t}).then((function(){j("top","right",e.node?a("nodeSavedNow"):a("nodeAdded"),"success"),u(o+1),f(!1)})).catch((function(e){j("top","right",e.message,"error")})).then((function(){f(!1)}))}else u(o+1)}()},node:O,loading:v,onBack:function(e){return u(o-1)},handleTextChange:function(e){return function(a){N(Object(m.a)(Object(m.a)({},O),{},Object(s.a)({},e,a.target.value)))}},activeStep:o,handleOptionChange:function(e){return function(a){N(Object(m.a)(Object(m.a)({},O),{},{Aria2OptionsSerialized:Object(m.a)(Object(m.a)({},O.Aria2OptionsSerialized),{},Object(s.a)({},e,a.target.value))}))}}}))}var er=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)}}}));function ar(){var e=er();return l.a.createElement("div",null,l.a.createElement(ze.a,{square:!0,className:e.content},l.a.createElement(Zn,null)))}var tr=Object(c.a)((function(e){var a;return{root:(a={},Object(s.a)(a,e.breakpoints.up("md"),{marginLeft:100}),Object(s.a)(a,"marginBottom",40),a),content:{padding:e.spacing(2)}}}));function nr(){var e=tr(),a=Object(Z.i)().id,t=Object(r.useState)(null),c=Object(n.a)(t,2),i=c[0],o=c[1],m=Object(Y.d)(),s=Object(r.useCallback)((function(e,a,t,n){return m(Object($e.S)(e,a,t,n))}),[m]);return Object(r.useEffect)((function(){Ye.c.get("/admin/node/"+a).then((function(e){e.data.Rank=e.data.Rank.toString(),e.data.Aria2OptionsSerialized.interval=e.data.Aria2OptionsSerialized.interval.toString(),e.data.Aria2OptionsSerialized.timeout=e.data.Aria2OptionsSerialized.timeout.toString(),e.data.Aria2Enabled=e.data.Aria2Enabled?"true":"false",o(e.data)})).catch((function(e){s("top","right",e.message,"error")}))}),[a]),l.a.createElement("div",null,l.a.createElement(ze.a,{square:!0,className:e.content},i&&l.a.createElement(Zn,{node:i})))}t.d(a,"default",(function(){return cr}));var rr=Object(c.a)((function(e){return{root:{display:"flex"},content:{flexGrow:1,padding:0,minWidth:0},toolbar:e.mixins.toolbar}})),lr=pe()({palette:{background:{}},overrides:{MuiButton:{root:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}}}},Ee.zhCN);function cr(){var e=rr(),a=Object(Z.g)(),t=Object(r.useState)(!1),c=Object(n.a)(t,2),m=c[0],s=c[1];return Object(r.useEffect)((function(){var e=se.a.GetUser();if(e&&e.group)return 1!==e.group.id?void a.push("/home"):void s(!0);a.push("/login")}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement(ue.a,{theme:lr},l.a.createElement("div",{className:e.root},l.a.createElement(i.a,null),l.a.createElement(o.a,null),m&&l.a.createElement(me,{content:function(e){return l.a.createElement(Z.d,null,l.a.createElement(Z.b,{path:"".concat(e,"/home"),exact:!0},l.a.createElement(aa,null)),l.a.createElement(Z.b,{path:"".concat(e,"/basic")},l.a.createElement(ma,null)),l.a.createElement(Z.b,{path:"".concat(e,"/access")},l.a.createElement(ba,null)),l.a.createElement(Z.b,{path:"".concat(e,"/mail")},l.a.createElement(fa,null)),l.a.createElement(Z.b,{path:"".concat(e,"/upload")},l.a.createElement(Na,null)),l.a.createElement(Z.b,{path:"".concat(e,"/theme")},l.a.createElement(Aa,null)),l.a.createElement(Z.b,{path:"".concat(e,"/image")},l.a.createElement(Ba,null)),l.a.createElement(Z.b,{path:"".concat(e,"/captcha")},l.a.createElement(Fn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/policy"),exact:!0},l.a.createElement(nt,null)),l.a.createElement(Z.b,{path:"".concat(e,"/policy/add/:type"),exact:!0},l.a.createElement(qt,null)),l.a.createElement(Z.b,{path:"".concat(e,"/policy/edit/:mode/:id"),exact:!0},l.a.createElement(Kt,null)),l.a.createElement(Z.b,{path:"".concat(e,"/group"),exact:!0},l.a.createElement(Gt,null)),l.a.createElement(Z.b,{path:"".concat(e,"/group/add"),exact:!0},l.a.createElement(Jt,null)),l.a.createElement(Z.b,{path:"".concat(e,"/group/edit/:id"),exact:!0},l.a.createElement(Xt,null)),l.a.createElement(Z.b,{path:"".concat(e,"/user"),exact:!0},l.a.createElement(nn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/user/add"),exact:!0},l.a.createElement(ln,null)),l.a.createElement(Z.b,{path:"".concat(e,"/user/edit/:id"),exact:!0},l.a.createElement(cn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/file"),exact:!0},l.a.createElement(dn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/file/import"),exact:!0},l.a.createElement(wn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/share"),exact:!0},l.a.createElement(bn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/download"),exact:!0},l.a.createElement(Nn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/task"),exact:!0},l.a.createElement(jn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/node"),exact:!0},l.a.createElement(Kn,null)),l.a.createElement(Z.b,{path:"".concat(e,"/node/add"),exact:!0},l.a.createElement(ar,null)),l.a.createElement(Z.b,{path:"".concat(e,"/node/edit/:id"),exact:!0},l.a.createElement(nr,null)))}}))))}}}]);
//# sourceMappingURL=11.c88dc692.chunk.js.map